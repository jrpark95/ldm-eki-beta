////****************************************************************************
//
// PROGRAM: ADAMO-DOSE_FLEXPART
//
// PURPOSE : Dose assessment from FLEXPART result
//
// DATE : 17 FEB 2016 (modified 26 FEB 2018)
//
// developed by FNC Technology
//
// please contact to yubjoo@fnctech.com or kkm0117@fmctech.com
//
//****************************************************************************

#include <netcdf.h>
#include <string.h>
#include <cstdlib>
#include <iostream>
#include <fstream>
#include <sstream>
#include <cmath>
#include <dirent.h>
#include <iomanip>
#include <time.h>
#include <sys/time.h>
#include <unistd.h>
#include <float.h>


void readdcf();
void readconfig();
void dosecalc();
int julday(int year, int month, int date);
double get_wall_time();
double get_cpu_time();
void check(int status);
void readinput();
bool DirectoryExists(const char* dirName);
float get_max(float a, float b, float c, float d, float e);
float get_max1(float a, float b, float c, float d, float e, float f);

using namespace std;

#define		nx		861
#define		ny		1011
#define		nz		8
#define		nspec	31

int  iyear, imonth, iday, ihour, timestep, opt_layer, opt_avemax, model, fihour, flexmodel, utime, sfonoff;
char cindir[200], coutdir[200], clogdir[200], ctempdir1[200], ctempdir2[200], ctempdir3[200], tempy[5], tempm[3], tempd[3], temph[3], templogdir[200];
string title, tmodel, topt_layer, topt_avemax, tcpath, smpath, empath,emmpath, tflexmodel, tutime, dumstr, tsfonoff;
string exeroot, dataroot;

float br[6]; //1:adult, 2 : 15y, 3 : 10y, ...
float exCLD[nspec][2], exGRD[nspec][2], dexGRD[nspec][2]; //93 : nuclide, 2 : eff.dose(1) & thyroid dose(2)
float inINH_A[nspec][2], inINH_15y[nspec][2], inINH_10y[nspec][2];
float inINH_5y[nspec][2], inINH_1y[nspec][2], inINH_3m[nspec][2]; //93 : nuclide, 2 : eff.dose(1) & thyroid dose(2)
float inING_A[nspec][2], inING_15y[nspec][2], inING_10y[nspec][2], inING_5y[nspec][2], inING_1y[nspec][2], inING_3m[nspec][2];
float inINGd_A[nspec][2], inINGd_15y[nspec][2], inINGd_10y[nspec][2], inINGd_5y[nspec][2], inINGd_1y[nspec][2], inINGd_3m[nspec][2];
float ingq[6][9]; //adult, 15y, 10y, 5y, 1y, 3m, 9: crop, kimchi, leafy, fruit, milk, beef, pork, chicken, pasture
float htoctime[9]; // 9: crop, kimchi, leafy, fruit, milk, beef, pork, chicken, pasture
float gperiod[9]; // 9: crop, kimchi, leafy, fruit, milk, beef, pork, chicken, pasture
float frate[4]; // 4: cattle(1), pig(2), chinken(3), sheep(4)
float prod[9]; // 9: crop, kimchi, leafy, fruit, milk, beef, pork, chicken, pasture
float shieldingf[4][3]; // 4: cloudshine, inhalation, skin, groundshine, 3: normal, sheltering, evacuation
float tf_a[93][4], tf_p[93][4]; // 93:nuclinde, 4: milk, beef, pork, chicken or crop, kimchi, leafy, fruit
float tfd_a[93][4], tfd_p[93][4]; // 93:nuclinde, 4: milk, beef, pork, chicken or crop, kimchi, leafy, fruit
float IERNetsf[2];
float temppcon, tempdcon;
float temppconr, tempdconr;
float temppcona, tempdcona, tempcal;
int sday[4], fday[4], incday;

double dconstant[nspec], ddconstant[nspec], dcheck; //decay constants for parent nuclides and their
double value[nspec];
float kk;

float conc[nspec][nz][ny][nx];
float drydep[nspec][ny][nx], wetdep[nspec][ny][nx];
//float accdrydep[nspec][ny][nx], accwetdep[nspec][ny][nx];
float dryf[nspec][ny][nx], drypf[nspec][ny][nx], wetf[nspec][ny][nx], wetpf[nspec][ny][nx];

float lon[nx], lat[ny];
float partup[nspec];
double tempgcon, tempgcond, tempfact;
float kcon;

float** effdose_C;
float** effdose_G;
float** effdose_E;
float** thydose_C;
float** thydose_G;
float*** effdose_I;
float*** effdose_T;
float*** thydose_I;
float*** thydose_T;
float** effdose_Tmax;
float** thydose_Tmax;
float*** effdose_F;
float*** thydose_F;
float*** ieffdose_F;
float*** ithydose_F;

float** ieffdose_C;
float** ieffdose_G;
float** ieffdose_E;
float** ithydose_C;
float** ithydose_G;
float*** ieffdose_I;
float*** ieffdose_T;
float*** ithydose_I;
float*** ithydose_T;
float** ieffdose_Tmax;
float** ithydose_Tmax;

float** iieffdose_C;
float** iieffdose_G;
float** iieffdose_E;
float** iithydose_C;
float** iithydose_G;
float*** iieffdose_I;
float*** iieffdose_T;
float*** iithydose_I;
float*** iithydose_T;
float** iieffdose_Tmax;
float** iithydose_Tmax;

float*** effdose_G_P;
float*** effdose_G_D;
float*** thydose_G_P;
float*** thydose_G_D;
float*** G_D_P;
float*** G_D_D;
float*** G_W_P;
float*** G_W_D;

void memalloc()
{
	effdose_C = (float**)malloc(sizeof(float*)* ny);
	effdose_G = (float**)malloc(sizeof(float*)* ny);
	effdose_E = (float**)malloc(sizeof(float*)* ny);
	thydose_C = (float**)malloc(sizeof(float*)* ny);
	thydose_G = (float**)malloc(sizeof(float*)* ny);
	effdose_I = (float***)malloc(sizeof(float**)* ny);
	effdose_T = (float***)malloc(sizeof(float**)* ny);
	thydose_I = (float***)malloc(sizeof(float**)* ny);
	thydose_T = (float***)malloc(sizeof(float**)* ny);
	effdose_Tmax = (float**)malloc(sizeof(float*)* ny);
	thydose_Tmax = (float**)malloc(sizeof(float*)* ny);
	effdose_F = (float***)malloc(sizeof(float**)* ny);
	thydose_F = (float***)malloc(sizeof(float**)* ny);
	ieffdose_F = (float***)malloc(sizeof(float**)* ny);
	ithydose_F = (float***)malloc(sizeof(float**)* ny);

	ieffdose_C = (float**)malloc(sizeof(float*)* ny);
	ieffdose_G = (float**)malloc(sizeof(float*)* ny);
	ieffdose_E = (float**)malloc(sizeof(float*)* ny);
	ithydose_C = (float**)malloc(sizeof(float*)* ny);
	ithydose_G = (float**)malloc(sizeof(float*)* ny);
	ieffdose_I = (float***)malloc(sizeof(float**)* ny);
	ieffdose_T = (float***)malloc(sizeof(float**)* ny);
	ithydose_I = (float***)malloc(sizeof(float**)* ny);
	ithydose_T = (float***)malloc(sizeof(float**)* ny);
	ieffdose_Tmax = (float**)malloc(sizeof(float*)* ny);
	ithydose_Tmax = (float**)malloc(sizeof(float*)* ny);

	iieffdose_C = (float**)malloc(sizeof(float*)* ny);
	iieffdose_G = (float**)malloc(sizeof(float*)* ny);
	iieffdose_E = (float**)malloc(sizeof(float*)* ny);
	iithydose_C = (float**)malloc(sizeof(float*)* ny);
	iithydose_G = (float**)malloc(sizeof(float*)* ny);
	iieffdose_I = (float***)malloc(sizeof(float**)* ny);
	iieffdose_T = (float***)malloc(sizeof(float**)* ny);
	iithydose_I = (float***)malloc(sizeof(float**)* ny);
	iithydose_T = (float***)malloc(sizeof(float**)* ny);
	iieffdose_Tmax = (float**)malloc(sizeof(float*)* ny);
	iithydose_Tmax = (float**)malloc(sizeof(float*)* ny);

	effdose_G_P = (float***)malloc(sizeof(float**)* ny);
	effdose_G_D = (float***)malloc(sizeof(float**)* ny);
	thydose_G_P = (float***)malloc(sizeof(float**)* ny);
	thydose_G_D = (float***)malloc(sizeof(float**)* ny);
	G_D_P = (float***)malloc(sizeof(float**)* ny);
	G_D_D = (float***)malloc(sizeof(float**)* ny);
	G_W_P = (float***)malloc(sizeof(float**)* ny);
	G_W_D = (float***)malloc(sizeof(float**)* ny);

	for (int i = 0; i < ny; i++)
	{
		effdose_C[i] = (float*)malloc(sizeof(float)* nx);
		effdose_G[i] = (float*)malloc(sizeof(float)* nx);
		effdose_E[i] = (float*)malloc(sizeof(float)* nx);
		thydose_C[i] = (float*)malloc(sizeof(float)* nx);
		thydose_G[i] = (float*)malloc(sizeof(float)* nx);
		effdose_I[i] = (float**)malloc(sizeof(float*)* nx);
		effdose_T[i] = (float**)malloc(sizeof(float*)* nx);
		thydose_I[i] = (float**)malloc(sizeof(float*)* nx);
		thydose_T[i] = (float**)malloc(sizeof(float*)* nx);
		effdose_Tmax[i] = (float*)malloc(sizeof(float)* nx);
		thydose_Tmax[i] = (float*)malloc(sizeof(float)* nx);
		effdose_F[i] = (float**)malloc(sizeof(float*)* nx);
		thydose_F[i] = (float**)malloc(sizeof(float*)* nx);
		ieffdose_F[i] = (float**)malloc(sizeof(float*)* nx);
		ithydose_F[i] = (float**)malloc(sizeof(float*)* nx);

		ieffdose_C[i] = (float*)malloc(sizeof(float)* nx);
		ieffdose_G[i] = (float*)malloc(sizeof(float)* nx);
		ieffdose_E[i] = (float*)malloc(sizeof(float)* nx);
		ithydose_C[i] = (float*)malloc(sizeof(float)* nx);
		ithydose_G[i] = (float*)malloc(sizeof(float)* nx);
		ieffdose_I[i] = (float**)malloc(sizeof(float*)* nx);
		ieffdose_T[i] = (float**)malloc(sizeof(float*)* nx);
		ithydose_I[i] = (float**)malloc(sizeof(float*)* nx);
		ithydose_T[i] = (float**)malloc(sizeof(float*)* nx);
		ieffdose_Tmax[i] = (float*)malloc(sizeof(float)* nx);
		ithydose_Tmax[i] = (float*)malloc(sizeof(float)* nx);

		iieffdose_C[i] = (float*)malloc(sizeof(float)* nx);
		iieffdose_G[i] = (float*)malloc(sizeof(float)* nx);
		iieffdose_E[i] = (float*)malloc(sizeof(float)* nx);
		iithydose_C[i] = (float*)malloc(sizeof(float)* nx);
		iithydose_G[i] = (float*)malloc(sizeof(float)* nx);
		iieffdose_I[i] = (float**)malloc(sizeof(float*)* nx);
		iieffdose_T[i] = (float**)malloc(sizeof(float*)* nx);
		iithydose_I[i] = (float**)malloc(sizeof(float*)* nx);
		iithydose_T[i] = (float**)malloc(sizeof(float*)* nx);
		iieffdose_Tmax[i] = (float*)malloc(sizeof(float)* nx);
		iithydose_Tmax[i] = (float*)malloc(sizeof(float)* nx);

		effdose_G_P[i] = (float**)malloc(sizeof(float*)* nx);
		effdose_G_D[i] = (float**)malloc(sizeof(float*)* nx);
		thydose_G_P[i] = (float**)malloc(sizeof(float*)* nx);
		thydose_G_D[i] = (float**)malloc(sizeof(float*)* nx);
		G_D_P[i] = (float**)malloc(sizeof(float*)* nx);
		G_D_D[i] = (float**)malloc(sizeof(float*)* nx);
		G_W_P[i] = (float**)malloc(sizeof(float*)* nx);
		G_W_D[i] = (float**)malloc(sizeof(float*)* nx);
		for (int j = 0; j < nx; j++)
		{
			effdose_I[i][j] = (float*)malloc(sizeof(float)* 6);
			effdose_T[i][j] = (float*)malloc(sizeof(float)* 6);
			thydose_I[i][j] = (float*)malloc(sizeof(float)* 6);
			thydose_T[i][j] = (float*)malloc(sizeof(float)* 6);
			ieffdose_I[i][j] = (float*)malloc(sizeof(float)* 6);
			ieffdose_T[i][j] = (float*)malloc(sizeof(float)* 6);
			ithydose_I[i][j] = (float*)malloc(sizeof(float)* 6);
			ithydose_T[i][j] = (float*)malloc(sizeof(float)* 6);
			effdose_F[i][j] = (float*)malloc(sizeof(float)* 6);
			thydose_F[i][j] = (float*)malloc(sizeof(float)* 6);
			ieffdose_F[i][j] = (float*)malloc(sizeof(float)* 6);
			ithydose_F[i][j] = (float*)malloc(sizeof(float)* 6);

			iieffdose_I[i][j] = (float*)malloc(sizeof(float)* 6);
			iieffdose_T[i][j] = (float*)malloc(sizeof(float)* 6);
			iithydose_I[i][j] = (float*)malloc(sizeof(float)* 6);
			iithydose_T[i][j] = (float*)malloc(sizeof(float)* 6);

			effdose_G_P[i][j] = (float*)malloc(sizeof(float)* nspec);
			effdose_G_D[i][j] = (float*)malloc(sizeof(float)* nspec);
			thydose_G_P[i][j] = (float*)malloc(sizeof(float)* nspec);
			thydose_G_D[i][j] = (float*)malloc(sizeof(float)* nspec);
			G_D_P[i][j] = (float*)malloc(sizeof(float)* nspec);
			G_D_D[i][j] = (float*)malloc(sizeof(float)* nspec);
			G_W_P[i][j] = (float*)malloc(sizeof(float)* nspec);
			G_W_D[i][j] = (float*)malloc(sizeof(float)* nspec);
		}
	}
}

void memfree()
{
	free(effdose_C);
	free(effdose_G);
	free(effdose_E);
	free(thydose_C);
	free(thydose_G);
	free(effdose_I);
	free(effdose_T);
	free(thydose_I);
	free(thydose_T);
	free(effdose_Tmax);
	free(thydose_Tmax);
	free(effdose_F);
	free(thydose_F);
	free(ieffdose_F);
	free(ithydose_F);

	free(ieffdose_C);
	free(ieffdose_G);
	free(ieffdose_E);
	free(ithydose_C);
	free(ithydose_G);
	free(ieffdose_I);
	free(ieffdose_T);
	free(ithydose_I);
	free(ithydose_T);
	free(ieffdose_Tmax);
	free(ithydose_Tmax);

	free(iieffdose_C);
	free(iieffdose_G);
	free(iieffdose_E);
	free(iithydose_C);
	free(iithydose_G);
	free(iieffdose_I);
	free(iieffdose_T);
	free(iithydose_I);
	free(iithydose_T);
	free(iieffdose_Tmax);
	free(iithydose_Tmax);

	free(effdose_G_P);
	free(effdose_G_D);
	free(thydose_G_P);
	free(thydose_G_D);
	free(G_D_P);
	free(G_D_D);
	free(G_W_P);
	free(G_W_D);
}


int main(int argc, char* argv[])
{
	memalloc();

		tmodel = argv[1];
		title = argv[2];
		topt_layer = argv[3];
		topt_avemax = argv[4];
		tflexmodel = argv[5];
	   tutime = argv[6];
		tsfonoff =argv[7];
	//if (argc == 6)
	//	title = argv[5];

	model = std::stoi(tmodel);
	opt_layer = std::stoi(topt_layer);
	opt_avemax = std::stoi(topt_avemax);
	flexmodel = std::stoi(tflexmodel);
	utime = std::stoi(tutime);
	sfonoff = std::stoi(tsfonoff);
	int linen=0;
	stringstream indir, outdir, logdir, tempdir1, tempdir2, tempdir3, indir1, indir2, indir3;
	string sindir, soutdir, slogdir, stempdir1, stempdir2, stempdir3, sindir1, sindir2, sindir3;

	printf("STEP1: Prepare input\n");
	readconfig();

	if (sfonoff == 0)
	{
		shieldingf[0][0] = 1;
		shieldingf[1][0] = 1;
		shieldingf[2][0] = 1;
		shieldingf[3][0] = 1;
	}

	if (model == 1)
	{
		string tttt = title.substr(0, 4);
		iyear = stoi(tttt);
		tttt = title.substr(4, 2);
		imonth = stoi(tttt);
		tttt = title.substr(6, 2);
		iday = stoi(tttt);
		tttt = title.substr(8, 2);
		ihour = stoi(tttt); // Print time
		fihour = ihour; // Start time

		//---- - +1hour------------------------
		int edd1[] = { 31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31 };
		int edd2[] = { 31, 29, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31 };
		if (ihour < 23)
			ihour++;
		else {
			ihour -= 23;

			if (iyear % 4 == 0){
				if (iday < edd2[imonth - 1]) iday++;
				else {
					if (imonth < 12) {
						iday = 1;
						imonth++;
					}
					else {
						iday = 1;
						imonth = 1;
						iyear++;
					}
				}
			}
			else{
				if (iday < edd1[imonth - 1]) iday++;
				else {
					if (imonth < 12) {
						iday = 1;
						imonth++;
					}
					else {
						iday = 1;
						imonth = 1;
						iyear++;
					}
				}
			}
		}
		
		incday = julday(iyear, imonth, iday);
	}
	else
	{
		logdir << dataroot << "LOG/KR1/DOSE/ACCD/" << title << "/";
		slogdir = logdir.str();
		strcpy(templogdir, slogdir.c_str());
		if (!DirectoryExists(templogdir))
			system(("mkdir -p " + slogdir).c_str());

		string listfile;
		if (flexmodel == 1)
		{
			listfile = (dataroot + "LOG/KR1/DOSE/ACCD/" + title + "/flexout1.txt").c_str();
		}
		else if (flexmodel == 2)
		{
			listfile = (dataroot + "LOG/KR1/DOSE/ACCD/" + title + "/flexout2.txt").c_str();
		}
			else
		{
			listfile = (dataroot + "LOG/KR1/DOSE/ACCD/" + title + "/flexout3.txt").c_str();
		}

		system(("ls " + dataroot + "OUTPUT/KR1/FLEXPART/ACCD/" + title + "/model1/  > " + listfile).c_str());

		ifstream list(listfile);
		string firstfile;
		int listcount = 0;

		while (listcount < 3)
		{
			list >> firstfile;
			listcount++;
		}
		while (!list.eof())
		{
			getline(list,dumstr);
			linen++;
		}

		string mm = firstfile.substr(11, 4);
		iyear = stoi(mm);
		mm = firstfile.substr(15, 2);
		imonth = stoi(mm);
		mm = firstfile.substr(17, 2);
		iday = stoi(mm);
		mm = firstfile.substr(20, 2);
		ihour = stoi(mm);
		fihour = ihour;
		incday = julday(iyear, imonth, iday);

	}

	if (model == 1)
	{
		sprintf(tempy, "%4d\0", iyear);
		sprintf(tempm, "%02d\0", imonth);
		sprintf(tempd, "%02d\0", iday);
		sprintf(temph, "%02d\0", fihour);

		indir << dataroot << "OUTPUT/KR1/FLEXPART/AUTO/" << tempy << "/" << tempm << "/" << tempd << "/" << temph << "/" ;
		outdir << dataroot << "OUTPUT/KR1/DOSE/AUTO/" << tempy << "/" << tempm << "/" << tempd << "/" << temph << "/";
		logdir << dataroot << "LOG/KR1/DOSE/AUTO/" << tempy << "/" << tempm << "/" << tempd << "/" << temph << "/";

		sindir = indir.str();
		soutdir = outdir.str();
		slogdir = logdir.str();
	strcpy(templogdir, slogdir.c_str());
		if (!DirectoryExists(templogdir))
			system(("mkdir -p " + slogdir).c_str());

				string listfile1 = (dataroot + "LOG/KR1/DOSE/AUTO/" + tempy +"/"+ tempm +"/"+ tempd +"/"+ temph + "/flexout.txt").c_str();
		system(("ls " + dataroot + "OUTPUT/KR1/FLEXPART/AUTO/" + tempy +"/"+ tempm +"/"+ tempd +"/"+ temph + "/  > " + listfile1).c_str());

		ifstream list1(listfile1);

		int listcount = 0;



		while (!list1.eof())
		{
			getline(list1,dumstr);
			linen++;
		}
	}
	else
	{
		indir1 << dataroot << "OUTPUT/KR1/FLEXPART/ACCD/" << title << "/model1/";
		indir2 << dataroot << "OUTPUT/KR1/FLEXPART/ACCD/" << title << "/model2/";
		indir3 << dataroot << "OUTPUT/KR1/FLEXPART/ACCD/" << title << "/model3/";
		outdir << dataroot << "OUTPUT/KR1/DOSE/ACCD/" << title << "/";
		//logdir << "../../_accident/" << title << "/log/flexpart/";
		tempdir1 << dataroot << "TEMP/KR1/DOSE/ACCD/" << title <<  "/model1/";
		tempdir2 << dataroot << "TEMP/KR1/DOSE/ACCD/" << title <<  "/model2/";
		tempdir3 << dataroot << "TEMP/KR1/DOSE/ACCD/" << title <<  "/model3/";

		soutdir = outdir.str();
	}

	if (model != 1)
	{
		if (flexmodel == 1)
		{
			stempdir1 = tempdir1.str();
			strcpy(ctempdir1, stempdir1.c_str());
			if (!DirectoryExists(ctempdir1))
				system(("mkdir -p " + stempdir1).c_str());
			sindir1 = indir1.str();
			strcpy(cindir, sindir1.c_str());
		}
		else if (flexmodel == 2)
		{
			stempdir2 = tempdir2.str();
			strcpy(ctempdir2, stempdir2.c_str());
			if (!DirectoryExists(ctempdir2))
				system(("mkdir -p " + stempdir2).c_str());
			sindir2 = indir2.str();
			strcpy(cindir, sindir2.c_str());
		}
		else
		{
			stempdir3 = tempdir3.str();
			strcpy(ctempdir3, stempdir3.c_str());
			if (!DirectoryExists(ctempdir3))
				system(("mkdir -p " + stempdir3).c_str());
			sindir3 = indir3.str();
			strcpy(cindir, sindir3.c_str());
		}
	}
	else
	{
		strcpy(cindir, sindir.c_str());
	}

	strcpy(coutdir, soutdir.c_str());
	strcpy(clogdir, slogdir.c_str());

		if (!DirectoryExists(cindir))
	{
		stringstream emm;
		emm << clogdir << "fail.txt";
		emmpath = emm.str();
		ofstream errormm(emmpath);
		errormm << "ERROR: No input directory found" << endl;
		printf("ERROR: No input directory found\n");
		exit(1);
	}
	
	//readinput();
	if (!DirectoryExists(coutdir))
		system(("mkdir -p " + soutdir).c_str());
	if (!DirectoryExists(clogdir))
		system(("mkdir -p " + slogdir).c_str());
	
	if (model == 1)
	{
timestep = linen - 5;
		printf("NOTICE: Total Time Step : %d\n", timestep);
	}
	else
	{
		timestep = linen-3;
printf("NOTICE: Total Time Step : %d\n", timestep);
	}
	stringstream ss, em;
	ss << clogdir << "log.txt";
	if (model != 1)
	{
		if (flexmodel == 1)
		{
			em << clogdir << "fail1.txt";
		}
		else if (flexmodel == 2)
		{
			em << clogdir << "fail2.txt";
		}
		else
		{
			em << clogdir << "fail3.txt";
		}
	}
	else
	{
		em << clogdir << "fail.txt";
	}

	empath = em.str();
	tcpath = ss.str();


	if (argv[7] == NULL)
	{
		ofstream errorm(empath);
		errorm << "ERROR: 7th argument is not specified" << endl;
		printf("ERROR: 7th argument is not specified\n");
		exit(1);
	}
	if (sfonoff != 0 && sfonoff != 1)
	{
		ofstream errorm(empath);
		errorm << "ERROR: 7th argument must be 0 or 1" << endl;
		printf("ERROR: 7th argument must be 0 or 1\n");
		exit(1);
	}
	if (argv[6] == NULL)
	{
		ofstream errorm(empath);
		errorm << "ERROR: 6th argument is not specified" << endl;
		printf("ERROR: 6th argument is not specified\n");
		exit(1);
	}
	if (utime < 4)
	{
		ofstream errorm(empath);
		errorm << "ERROR: 6th argument(usertime) must be larger than 4(days)" << endl;
		printf("ERROR: 6th argument(usertime) must be larger than 4(days)\n");
		exit(1);
	}
	if (argv[5] == NULL)
	{
		ofstream errorm(empath);
		errorm << "ERROR: 5th argument is not specified" << endl;
		printf("ERROR: 5th argument is not specified\n");
		exit(1);
	}
	if (argv[4] == NULL)
	{
		ofstream errorm(empath);
		errorm << "ERROR: 4th argument is not specified" << endl;
		printf("ERROR: 4th argument is not specified\n");
		exit(1);
	}
	if (argv[3] == NULL)
	{
		ofstream errorm(empath);
		errorm << "ERROR: 3rd argument is not specified" << endl;
		printf("ERROR: 3rd argument is not specified\n");
		exit(1);
	}
	if (argv[2] == NULL)
	{
		ofstream errorm(empath);
		errorm << "ERROR: 2nd argument is not specified" << endl;
		printf("ERROR: 2nd argument is not specified\n");
		exit(1);
	}
	if (argv[1] == NULL)
	{
		ofstream errorm(empath);
		errorm << "ERROR: 1st argument is not specified" << endl;
		printf("ERROR: 1st argument is not specified\n");
		exit(1);
	}

	readdcf();

	dosecalc();

	stringstream sm;

	if (model != 1)
	{
		if (flexmodel == 1)
		{
			sm << clogdir << "success1.txt";
		}
		else if (flexmodel == 2)
		{
			sm << clogdir << "success2.txt";
		}
		else
		{
			sm << clogdir << "success3.txt";
		}
	}
	else
	{
		sm << clogdir << "success.txt";
	}
	smpath = sm.str();
 	ofstream successm(smpath);
	successm << "ADAMO-DOSE_FLEXPART_kr calculation ends. Please check the log file for details" << endl;

	if (model == 1)
	{
		printf("OUTPUT: %s\n", soutdir.c_str());
	}
	else
	{
		if (flexmodel == 1)
		{
			printf("OUTPUT: %s\n", stempdir1.c_str());
		}
		else if (flexmodel == 2)
		{
			printf("OUTPUT: %s\n", stempdir2.c_str());
		}
		else 
		{
			printf("OUTPUT: %s\n", stempdir3.c_str());
		}
	}

	printf("STEP4: Print done\n");



	memfree();
}

void dosecalc() {
	// start time
	double wall0 = get_wall_time();
	double cpu0 = get_cpu_time();

	int i, j, k, n, ii;
	float fa[4];
	char outname[101], outfile[101], outdose[101];
	//= == == == == == == == == == == == == == == == == == == == == == == == == == == =
	//char outpath[] = "C:/temp/1/";
	//= == == == == == == == == == == == == == == == == == == == == == == == == == == =
	int ncid, varid;

	//= == == == == == == == == == == == == == == == == == == == == == == ==

	char cyear[5];
	char cmonth[3], cday[3], chour[3];
	int edd1[] = { 31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31 };
	int edd2[] = { 31, 29, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31 };
	for (int i = 0; i < nx; i++) {
		lon[i] = 123.5f + i*0.01f; //degree E
	}
	for (int i = 0; i < ny; i++) {
		lat[i] = 33.f + i*0.01f; //degree N
	}

	/*	for (int l = 0; l < nspec; l++) {
	for (int k =respath 0; k < ny; k++) {
	for (int j = 0; j < nx; j++) {
	accdrydep[l][k][j] = 0;
	accwetdep[l][k][j] = 0;
	}
	}
	}
	*/

	for (int i = 0; i < nspec; i++)
	{
		for (int j = 0; j < ny; j++)
		{
			for (int k = 0; k < nx; k++)
			{
				dryf[i][j][k] = 0;
				drypf[i][j][k] = 0;
				wetf[i][j][k] = 0;
				wetpf[i][j][k] = 0;
			}
		}

	}

	int nnuclide;
	if (model == 1)
		nnuclide = 1;
	else
		nnuclide = nspec;

	ofstream printlog(tcpath);
printlog << "Arguement" << endl;
printlog << "Mode : " << tmodel << endl;
printlog << "Input title : " <<title << endl;
printlog << "Layer option : " <<topt_layer << endl;
printlog << "Average option : " <<topt_avemax << endl;
printlog << "Sub-model : " <<tflexmodel << endl;
printlog << "Usertime : " <<tutime << endl;
printlog << "Shielding option : " <<tsfonoff << endl;
printlog << endl;
printlog << "Input file names" << endl;

	char respath[160];
	float avecon, maxcon, maxcon1;
	for (int ii = 0; ii < ny; ii++)
	{
		for (int jj = 0; jj < nx; jj++)
		{
			ieffdose_C[ii][jj] = 0.;
			ithydose_C[ii][jj] = 0.;
			ieffdose_G[ii][jj] = 0.;
			ithydose_G[ii][jj] = 0.;
			ieffdose_E[ii][jj] = 0.;
			iieffdose_C[ii][jj] = 0.;
			iithydose_C[ii][jj] = 0.;
			iieffdose_G[ii][jj] = 0.;
			iithydose_G[ii][jj] = 0.;
			iieffdose_E[ii][jj] = 0.;
			ieffdose_Tmax[ii][jj] = 0.;
			ithydose_Tmax[ii][jj] = 0.;
			iieffdose_Tmax[ii][jj] = 0.;
			iithydose_Tmax[ii][jj] = 0.;


			for (int kk = 0; kk < 31; kk++)
			{
				G_D_P[ii][jj][kk] = 0.;
				G_D_D[ii][jj][kk] = 0.;
				G_W_P[ii][jj][kk] = 0.;
				G_W_D[ii][jj][kk] = 0.;
				effdose_G_P[ii][jj][kk] = 0.;
				effdose_G_D[ii][jj][kk] = 0.;
				thydose_G_P[ii][jj][kk] = 0.;
				thydose_G_D[ii][jj][kk] = 0.;
			}
			for (int k = 0; k < 6; k++)
			{
				ieffdose_I[ii][jj][k] = 0.;
				ithydose_I[ii][jj][k] = 0.;
				ieffdose_T[ii][jj][k] = 0.;
				ithydose_T[ii][jj][k] = 0.;
				iieffdose_I[ii][jj][k] = 0.;
				iithydose_I[ii][jj][k] = 0.;
				iieffdose_T[ii][jj][k] = 0.;
				iithydose_T[ii][jj][k] = 0.;
				effdose_F[ii][jj][k] = 0.;
				thydose_F[ii][jj][k] = 0.;
				ieffdose_F[ii][jj][k] = 0.;
				ithydose_F[ii][jj][k] = 0.;
			}

		}
	}

	for (int i = 1; i <= timestep; i++){

		if (i == 1)
		{
/*
			if (model == 1)
			{
				printf("STEP2: Preprocessing done\n");
				printf("INPUT: %s\n", sindir.c_str());
			}
			else
			{
				if (flexmodel == 1)
				{
					printf("STEP2: Preprocessing done\n");
					printf("INPUT: %s\n", sindir1.c_str());
				}
				else if (flexmodel == 2)
				{
					printf("STEP2: Preprocessing done\n");
					printf("INPUT: %s\n", sindir2.c_str());
				}
				else 
				{
					printf("STEP2: Preprocessing done\n");
					printf("INPUT: %s\n", sindir3.c_str());
				}
			}
*/

				printf("STEP2: Preprocessing done\n");
				printf("INPUT: %s\n", cindir);
		}
		//sprintf(outfile, "C:/temp/3/conc/flexpartconc_%02d.txt", i);
		//FILE *out_file = fopen(outfile, "w");
		//sprintf(outdose, "C:/temp/3/dose/flexpartdose_%02d.txt", i);
		//FILE *out_dose = fopen(outdose, "w");
		strcpy(respath, "\0");
		sprintf(cyear, "%4d", iyear);
		sprintf(cmonth, "%02d", imonth);
		sprintf(cday, "%02d", iday);
		sprintf(chour, "%02d", ihour);
		printf("NOTICE: %d %s %s %s %s\n", i, cyear, cmonth, cday, chour);

		sprintf(outname, "flxout_d01_%s%s%s_%s0000.nc", cyear, cmonth, cday, chour);
		//printf("%s\n", outname);
		printlog << outname << endl;
		strcat(respath, cindir);
		strcat(respath, outname);
		check(nc_open(respath, NC_NOWRITE, &ncid));
		check(nc_inq_varid(ncid, "CONC", &varid));
		check(nc_get_var(ncid, varid, conc));




		for (int ii = 0; ii < ny; ii++)
		{
			for (int jj = 0; jj < nx; jj++)
			{
				effdose_C[ii][jj] = 0;
				effdose_G[ii][jj] = 0;
				effdose_E[ii][jj] = 0;
				thydose_C[ii][jj] = 0;
				thydose_G[ii][jj] = 0;
				effdose_Tmax[ii][jj] = 0.;
				thydose_Tmax[ii][jj] = 0.;

				for (int kk = 0; kk < 6; kk++)
				{
					effdose_I[ii][jj][kk] = 0;
					effdose_T[ii][jj][kk] = 0;
					thydose_I[ii][jj][kk] = 0;
					thydose_T[ii][jj][kk] = 0;
				}

			}
		}

		if (opt_layer == 0) // use 0 m result
		{
			if (opt_avemax == 0) // use average result
			{
				for (int m = 0; m < nnuclide; m++) {
					for (int k = 0; k < ny; k++){
						for (int j = 0; j < nx; j++){
							//conc[m][l][k][j] = conc[m][l][k][j] * (1.e-12); //10 - 3 nBq / m3->Bq / m3
							//if (conc[m][l][k][j] != 0)
							//printf("x: %d, y: %d, z: %d, nuc: %d, conc.: %e \n", j, k, l, m, conc[m][l][k][j]);
							/*if (j == 291 && k == 240)
							{
							for (int iii = 0; iii < 8; iii++)
							{
							fprintf(out_file, "x: %f, y: %f, z: %d, nuc: %d, conc.: %e \n", lon[j], lat[k], iii + 1, m + 1, conc[m][iii][k][j]*1e-12);
							}
							}*/
							//fprintf(out_file, "x: %d, y: %d, z: %d, nuc: %d, conc.: %e \n", j+1, k+1, l+1, m+1, conc[m][l][k][j]);
							if (conc[m][0][k][j] != 0 || conc[m][1][k][j] != 0 || conc[m][2][k][j] != 0 || conc[m][3][k][j] != 0 || conc[m][4][k][j] != 0)
							{
								avecon = 0.2 * (conc[m][0][k][j] + conc[m][1][k][j] + conc[m][2][k][j] + conc[m][3][k][j] + conc[m][4][k][j]);

								effdose_C[k][j] += (avecon * (1.e-12)) * exCLD[m][0] * 3600000 * shieldingf[0][0];
								thydose_C[k][j] += (avecon * (1.e-12)) * exCLD[m][1] * 3600000 * shieldingf[0][0];

							}
							if (conc[m][0][k][j] != 0)
							{
								effdose_I[k][j][0] += conc[m][0][k][j] * (1.e-12) * inINH_A[m][0] * br[0] * 1000 * shieldingf[1][0];
								thydose_I[k][j][0] += conc[m][0][k][j] * (1.e-12) * inINH_A[m][1] * br[0] * 1000 * shieldingf[1][0];
								effdose_I[k][j][1] += conc[m][0][k][j] * (1.e-12) * inINH_15y[m][0] * br[1] * 1000 * shieldingf[1][0];
								thydose_I[k][j][1] += conc[m][0][k][j] * (1.e-12) * inINH_15y[m][1] * br[1] * 1000 * shieldingf[1][0];
								effdose_I[k][j][2] += conc[m][0][k][j] * (1.e-12) * inINH_10y[m][0] * br[2] * 1000 * shieldingf[1][0];
								thydose_I[k][j][2] += conc[m][0][k][j] * (1.e-12) * inINH_10y[m][1] * br[2] * 1000 * shieldingf[1][0];
								effdose_I[k][j][3] += conc[m][0][k][j] * (1.e-12) * inINH_5y[m][0] * br[3] * 1000 * shieldingf[1][0];
								thydose_I[k][j][3] += conc[m][0][k][j] * (1.e-12) * inINH_5y[m][1] * br[3] * 1000 * shieldingf[1][0];
								effdose_I[k][j][4] += conc[m][0][k][j] * (1.e-12) * inINH_1y[m][0] * br[4] * 1000 * shieldingf[1][0];
								thydose_I[k][j][4] += conc[m][0][k][j] * (1.e-12) * inINH_1y[m][1] * br[4] * 1000 * shieldingf[1][0];
								effdose_I[k][j][5] += conc[m][0][k][j] * (1.e-12) * inINH_3m[m][0] * br[5] * 1000 * shieldingf[1][0];
								thydose_I[k][j][5] += conc[m][0][k][j] * (1.e-12) * inINH_3m[m][1] * br[5] * 1000 * shieldingf[1][0];

							}
						}
					}
				}
			}
			else // use maximum result
			{
				for (int m = 0; m < nnuclide; m++) {
					for (int k = 0; k < ny; k++){
						for (int j = 0; j < nx; j++){

							/*if (j == 291 && k == 240)
							{
							for (int iii = 0; iii < 8; iii++)
							{
							fprintf(out_file, "x: %f, y: %f, z: %d, nuc: %d, conc.: %e \n", lon[j], lat[k], iii + 1, m + 1, conc[m][iii][k][j] * 1e-12);
							}
							}*/
							if (conc[m][0][k][j] != 0 || conc[m][1][k][j] != 0 || conc[m][2][k][j] != 0 || conc[m][3][k][j] != 0 || conc[m][4][k][j] != 0)
							{
								maxcon = get_max(conc[m][0][k][j], conc[m][1][k][j], conc[m][2][k][j], conc[m][3][k][j], conc[m][4][k][j]);

								effdose_C[k][j] += (maxcon * (1.e-12)) * exCLD[m][0] * 3600000 * shieldingf[0][0];
								thydose_C[k][j] += (maxcon * (1.e-12)) * exCLD[m][1] * 3600000 * shieldingf[0][0];

							}
							if (conc[m][0][k][j] != 0)
							{
								effdose_I[k][j][0] += conc[m][0][k][j] * (1.e-12) * inINH_A[m][0] * br[0] * 1000 * shieldingf[1][0];
								thydose_I[k][j][0] += conc[m][0][k][j] * (1.e-12) * inINH_A[m][1] * br[0] * 1000 * shieldingf[1][0];
								effdose_I[k][j][1] += conc[m][0][k][j] * (1.e-12) * inINH_15y[m][0] * br[1] * 1000 * shieldingf[1][0];
								thydose_I[k][j][1] += conc[m][0][k][j] * (1.e-12) * inINH_15y[m][1] * br[1] * 1000 * shieldingf[1][0];
								effdose_I[k][j][2] += conc[m][0][k][j] * (1.e-12) * inINH_10y[m][0] * br[2] * 1000 * shieldingf[1][0];
								thydose_I[k][j][2] += conc[m][0][k][j] * (1.e-12) * inINH_10y[m][1] * br[2] * 1000 * shieldingf[1][0];
								effdose_I[k][j][3] += conc[m][0][k][j] * (1.e-12) * inINH_5y[m][0] * br[3] * 1000 * shieldingf[1][0];
								thydose_I[k][j][3] += conc[m][0][k][j] * (1.e-12) * inINH_5y[m][1] * br[3] * 1000 * shieldingf[1][0];
								effdose_I[k][j][4] += conc[m][0][k][j] * (1.e-12) * inINH_1y[m][0] * br[4] * 1000 * shieldingf[1][0];
								thydose_I[k][j][4] += conc[m][0][k][j] * (1.e-12) * inINH_1y[m][1] * br[4] * 1000 * shieldingf[1][0];
								effdose_I[k][j][5] += conc[m][0][k][j] * (1.e-12) * inINH_3m[m][0] * br[5] * 1000 * shieldingf[1][0];
								thydose_I[k][j][5] += conc[m][0][k][j] * (1.e-12) * inINH_3m[m][1] * br[5] * 1000 * shieldingf[1][0];

							}
						}
					}
				}
			}
		}
		else // use 0, 10 m result
		{
			if (opt_avemax == 0) // use average result
			{
				for (int m = 0; m < nnuclide; m++) {
					for (int k = 0; k < ny; k++){
						for (int j = 0; j < nx; j++){

							/*if (j == 291 && k == 240)
							{
							for (int iii = 0; iii < 8; iii++)
							{
							fprintf(out_file, "x: %f, y: %f, z: %d, nuc: %d, conc.: %e \n", lon[j], lat[k], iii + 1, m + 1, conc[m][iii][k][j] * 1e-12);
							}
							}*/

							if (conc[m][0][k][j] != 0 || conc[m][1][k][j] != 0 || conc[m][2][k][j] != 0 || conc[m][3][k][j] != 0 || conc[m][4][k][j] != 0)
							{
								avecon = 0.2 * (conc[m][0][k][j] + conc[m][1][k][j] + conc[m][2][k][j] + conc[m][3][k][j] + conc[m][4][k][j]);

								effdose_C[k][j] += (avecon * (1.e-12)) * exCLD[m][0] * 3600000 * shieldingf[0][0];
								thydose_C[k][j] += (avecon * (1.e-12)) * exCLD[m][1] * 3600000 * shieldingf[0][0];

							}
							if (conc[m][0][k][j] != 0 || conc[m][1][k][j] != 0)
							{
								avecon = 0.5 * (conc[m][0][k][j] + conc[m][1][k][j]) * (1.e-12);

								effdose_I[k][j][0] += avecon * inINH_A[m][0] * br[0] * 1000 * shieldingf[1][0];
								thydose_I[k][j][0] += avecon * inINH_A[m][1] * br[0] * 1000 * shieldingf[1][0];
								effdose_I[k][j][1] += avecon * inINH_15y[m][0] * br[1] * 1000 * shieldingf[1][0];
								thydose_I[k][j][1] += avecon * inINH_15y[m][1] * br[1] * 1000 * shieldingf[1][0];
								effdose_I[k][j][2] += avecon * inINH_10y[m][0] * br[2] * 1000 * shieldingf[1][0];
								thydose_I[k][j][2] += avecon * inINH_10y[m][1] * br[2] * 1000 * shieldingf[1][0];
								effdose_I[k][j][3] += avecon * inINH_5y[m][0] * br[3] * 1000 * shieldingf[1][0];
								thydose_I[k][j][3] += avecon * inINH_5y[m][1] * br[3] * 1000 * shieldingf[1][0];
								effdose_I[k][j][4] += avecon * inINH_1y[m][0] * br[4] * 1000 * shieldingf[1][0];
								thydose_I[k][j][4] += avecon * inINH_1y[m][1] * br[4] * 1000 * shieldingf[1][0];
								effdose_I[k][j][5] += avecon * inINH_3m[m][0] * br[5] * 1000 * shieldingf[1][0];
								thydose_I[k][j][5] += avecon * inINH_3m[m][1] * br[5] * 1000 * shieldingf[1][0];

							}
						}
					}
				}
			}
			else // use maximum result
			{
				for (int m = 0; m < nnuclide; m++) {
					for (int k = 0; k < ny; k++){
						for (int j = 0; j < nx; j++){

							/*if (j == 291 && k == 240)
							{
							for (int iii = 0; iii < 8; iii++)
							{
							fprintf(out_file, "x: %f, y: %f, z: %d, nuc: %d, conc.: %e \n", lon[j], lat[k], iii + 1, m + 1, conc[m][iii][k][j] * 1e-12);
							}
							}*/

							if (conc[m][0][k][j] != 0 || conc[m][1][k][j] != 0 || conc[m][2][k][j] != 0 || conc[m][3][k][j] != 0 || conc[m][4][k][j] != 0)
							{
								maxcon = get_max(conc[m][0][k][j], conc[m][1][k][j], conc[m][2][k][j], conc[m][3][k][j], conc[m][4][k][j]);

								effdose_C[k][j] += (maxcon * (1.e-12)) * exCLD[m][0] * 3600000 * shieldingf[0][0];
								thydose_C[k][j] += (maxcon * (1.e-12)) * exCLD[m][1] * 3600000 * shieldingf[0][0];

							}

							if (conc[m][0][k][j] != 0 || conc[m][1][k][j] != 0)
							{
								maxcon = max(conc[m][0][k][j], conc[m][1][k][j]) * (1.e-12);

								effdose_I[k][j][0] += maxcon * inINH_A[m][0] * br[0] * 1000 * shieldingf[1][0];
								thydose_I[k][j][0] += maxcon * inINH_A[m][1] * br[0] * 1000 * shieldingf[1][0];
								effdose_I[k][j][1] += maxcon * inINH_15y[m][0] * br[1] * 1000 * shieldingf[1][0];
								thydose_I[k][j][1] += maxcon * inINH_15y[m][1] * br[1] * 1000 * shieldingf[1][0];
								effdose_I[k][j][2] += maxcon * inINH_10y[m][0] * br[2] * 1000 * shieldingf[1][0];
								thydose_I[k][j][2] += maxcon * inINH_10y[m][1] * br[2] * 1000 * shieldingf[1][0];
								effdose_I[k][j][3] += maxcon * inINH_5y[m][0] * br[3] * 1000 * shieldingf[1][0];
								thydose_I[k][j][3] += maxcon * inINH_5y[m][1] * br[3] * 1000 * shieldingf[1][0];
								effdose_I[k][j][4] += maxcon * inINH_1y[m][0] * br[4] * 1000 * shieldingf[1][0];
								thydose_I[k][j][4] += maxcon * inINH_1y[m][1] * br[4] * 1000 * shieldingf[1][0];
								effdose_I[k][j][5] += maxcon * inINH_3m[m][0] * br[5] * 1000 * shieldingf[1][0];
								thydose_I[k][j][5] += maxcon * inINH_3m[m][1] * br[5] * 1000 * shieldingf[1][0];

							}
						}
					}
				}
			}
		}

		//fclose(out_file);
		check(nc_inq_varid(ncid, "DRYDEP", &varid));
		check(nc_get_var(ncid, varid, drydep));
		for (int l = 0; l < nnuclide; l++) {
			tempgcon = 0.;
			tempgcond = 0.;
			for (int k = 0; k < ny; k++) {
				for (int j = 0; j < nx; j++) {

					/*if (j == 291 && k == 240)
					{
					fprintf(out_file, "x: %f, y: %f, nuc: %d, drydep.: %e \n", lon[j], lat[k], l + 1, drydep[l][k][j] * 1e-15);
					}*/

					drydep[l][k][j] = drydep[l][k][j] * (1.e-12); //10 - 3 pBq / m2->Bq / m2

					//kk = ((1 / dconstant[l]) - ((1 - exp(-dconstant[l])) / (dconstant[l] * dconstant[l])));
					tempgcon = drydep[l][k][j];
					//kk = G_D_P[k][j][l];
					dcheck = ddconstant[l] - dconstant[l];
					if (dconstant[l] == 0 || dcheck == 0)
					{
					ofstream errorm(empath);
					errorm << "ERROR: Error has been detected in decay constant. Please check the DB files" << endl;
					printf("ERROR: Error has been detected in decay constant. Please check the DB files\n");
					exit(1);
					}
					kcon = (tempgcon - (1 - exp(-dconstant[l])) *G_D_P[k][j][l] / dconstant[l]) / ((1 / dconstant[l]) - ((1 - exp(-dconstant[l])) / (dconstant[l] * dconstant[l])));
					if (kcon < 0 || isnan(kcon) !=false)
					{
						kcon = 0.;
					}

					//accdrydep[l][k][j] = accdrydep[l][k][j] + drydep[l][k][j] * (1.e-15); //10 - 3 pBq / m2->Bq / m2
					tempfact = (G_D_P[k][j][l] * dconstant[l] - kcon) / (ddconstant[l] - dconstant[l]);


					if (ddconstant[l] != 0)
					{
						tempgcond = (tempfact / dconstant[l]) * (1 - exp(-dconstant[l])) + kcon / ddconstant[l] + (1 - exp(-ddconstant[l]))*(G_D_D[k][j][l] - tempfact - kcon / ddconstant[l]) / ddconstant[l];
						if (tempgcond < 0)
						{
							tempgcond = 0.;
						}

					}
					if (i == timestep)
					{
						effdose_G_P[k][j][l] += tempgcon * exGRD[l][0] * 3600000 * shieldingf[3][0];
						effdose_G_D[k][j][l] += tempgcond * dexGRD[l][0] * 3600000 * shieldingf[3][0];
						thydose_G_P[k][j][l] += tempgcon * exGRD[l][1] * 3600000 * shieldingf[3][0];
						thydose_G_D[k][j][l] += tempgcond * dexGRD[l][1] * 3600000 * shieldingf[3][0];
					}

					effdose_G[k][j] += tempgcon * exGRD[l][0] * 3600000 * shieldingf[3][0] + tempgcond * dexGRD[l][0] * 3600000 * shieldingf[3][0];
					thydose_G[k][j] += tempgcon * exGRD[l][1] * 3600000 * shieldingf[3][0] + tempgcond * dexGRD[l][1] * 3600000 * shieldingf[3][0];

					G_D_P[k][j][l] = (G_D_P[k][j][l] - kcon / dconstant[l]) * exp(-dconstant[l]) + kcon / dconstant[l];
					if (ddconstant[l] != 0)
					{
						G_D_D[k][j][l] = tempfact * exp(-dconstant[l]) + kcon / ddconstant[l] + (G_D_D[k][j][l] - tempfact - kcon / ddconstant[l])* exp(-ddconstant[l]);
					}

					if (dryf[l][k][j] <= tempgcon)
					{
						dryf[l][k][j] = tempgcon;
					}
					if (drypf[l][k][j] <= tempgcond)
					{
						drypf[l][k][j] = tempgcond;
					}
//					if( k == 274 && j == 592)
//					{
//						printf("%e %e %e \n", drydep[l][k][j], tempgcon, dryf[l][k][j]);
//					}
				}
			}
		}
		check(nc_inq_varid(ncid, "WETDEP", &varid));
		check(nc_get_var(ncid, varid, wetdep));
		for (int l = 0; l < nnuclide; l++) {
			tempgcon = 0.;
			tempgcond = 0.;
			for (int k = 0; k < ny; k++) {
				for (int j = 0; j < nx; j++) {

					/*if (j == 291 && k == 240)
					{
					fprintf(out_file, "x: %f, y: %f, nuc: %d, wetdep.: %e \n", lon[j], lat[k], l + 1, wetdep[l][k][j] * 1e-15);
					}*/

					wetdep[l][k][j] = wetdep[l][k][j] * (1.e-12); //10 - 3 pBq / m2->Bq / m2
					dcheck = ddconstant[l] - dconstant[l];
					if (dconstant[l] == 0 || dcheck == 0)
					{
					ofstream errorm(empath);
					errorm << "ERROR: Error has been detected in decay constant. Please check the DB files" << endl;
					printf("ERROR: Error has been detected in decay constant. Please check the DB files\n");
					exit(1);
					}
					kcon = (wetdep[l][k][j] - (1 - exp(-dconstant[l])) *G_W_P[k][j][l] / dconstant[l]) / ((1 / dconstant[l]) - ((1 - exp(-dconstant[l])) / (dconstant[l] * dconstant[l])));
					if (kcon < 0 || isnan(kcon) !=false)
					{
						kcon = 0.;
					}


					//accwetdep[l][k][j] = accwetdep[l][k][j] + wetdep[l][k][j] * (1.e-15); //10 - 3 pBq / m2->Bq / m2
					tempfact = (G_W_P[k][j][l] * dconstant[l] - kcon) / (ddconstant[l] - dconstant[l]);
					tempgcon = wetdep[l][k][j];
					if (ddconstant[l] != 0)
					{
						tempgcond = (tempfact / dconstant[l]) * (1 - exp(-dconstant[l])) + kcon / ddconstant[l] + (1 - exp(-ddconstant[l]))*(G_W_D[k][j][l] - tempfact - kcon / ddconstant[l]) / ddconstant[l];
						if (tempgcond < 0)
						{
							tempgcond = 0.;
						}
					}
					if (i == timestep)
					{
						effdose_G_P[k][j][l] += tempgcon * exGRD[l][0] * 3600000 * shieldingf[3][0];
						effdose_G_D[k][j][l] += tempgcond * dexGRD[l][0] * 3600000 * shieldingf[3][0];
						thydose_G_P[k][j][l] += tempgcon * exGRD[l][1] * 3600000 * shieldingf[3][0];
						thydose_G_D[k][j][l] += tempgcond * dexGRD[l][1] * 3600000 * shieldingf[3][0];
					}

					effdose_G[k][j] += tempgcon * exGRD[l][0] * 3600000 * shieldingf[3][0] + tempgcond * dexGRD[l][0] * 3600000 * shieldingf[3][0];
					thydose_G[k][j] += tempgcon * exGRD[l][1] * 3600000 * shieldingf[3][0] + tempgcond * dexGRD[l][1] * 3600000 * shieldingf[3][0];


					G_W_P[k][j][l] = (G_W_P[k][j][l] - kcon / dconstant[l]) * exp(-dconstant[l]) + kcon / dconstant[l];
					if (ddconstant[l] != 0)
					{
						G_W_D[k][j][l] = tempfact * exp(-dconstant[l]) + kcon / ddconstant[l] + (G_W_D[k][j][l] - tempfact - kcon / ddconstant[l])* exp(-ddconstant[l]);
					}

					if (wetf[l][k][j] <= tempgcon)
					{
						wetf[l][k][j] = tempgcon;
					}
					if (wetpf[l][k][j] <= tempgcond)
					{
						wetpf[l][k][j] = tempgcond;
					}
					
//					if( k == 274 && j == 592)
//					{
//						printf("%e %e %e \n", wetdep[l][k][j], tempgcon, wetf[l][k][j]);
//					}
				}
			}
		}
		//= = End of reading output == == == == == == == == == == == =
		check(nc_close(ncid));



		for (int ii = 0; ii < ny; ii++)
		{
			for (int j = 0; j < nx; j++)
			{

				effdose_E[ii][j] = effdose_C[ii][j] * IERNetsf[0]+ effdose_G[ii][j]* IERNetsf[1];

				for (int k = 0; k < 6; k++)
				{
					effdose_T[ii][j][k] = effdose_C[ii][j] + effdose_G[ii][j] + effdose_I[ii][j][k];
					thydose_T[ii][j][k] = thydose_C[ii][j] + thydose_G[ii][j] + thydose_I[ii][j][k];

				}
				effdose_Tmax[ii][j] = get_max1(effdose_T[ii][j][0], effdose_T[ii][j][1], effdose_T[ii][j][2], effdose_T[ii][j][3], effdose_T[ii][j][4], effdose_T[ii][j][5]);
				thydose_Tmax[ii][j] = get_max1(thydose_T[ii][j][0], thydose_T[ii][j][1], thydose_T[ii][j][2], thydose_T[ii][j][3], thydose_T[ii][j][4], thydose_T[ii][j][5]);
			}
		}
		for (int ii = 0; ii < ny; ii++)
		{
			for (int j = 0; j < nx; j++)
			{
				ieffdose_C[ii][j] += effdose_C[ii][j];
				ithydose_C[ii][j] += thydose_C[ii][j];
				ieffdose_G[ii][j] += effdose_G[ii][j];
				ithydose_G[ii][j] += thydose_G[ii][j];
				for (int k = 0; k < 6; k++)
				{
					ieffdose_I[ii][j][k] += effdose_I[ii][j][k];
					ithydose_I[ii][j][k] += thydose_I[ii][j][k];
					ieffdose_T[ii][j][k] = ieffdose_C[ii][j] + ieffdose_G[ii][j] + ieffdose_I[ii][j][k];
					ithydose_T[ii][j][k] = ithydose_C[ii][j] + ithydose_G[ii][j] + ithydose_I[ii][j][k];
				}
				ieffdose_Tmax[ii][j] = get_max1(ieffdose_T[ii][j][0], ieffdose_T[ii][j][1], ieffdose_T[ii][j][2], ieffdose_T[ii][j][3], ieffdose_T[ii][j][4], ieffdose_T[ii][j][5]);
				ithydose_Tmax[ii][j] = get_max1(ithydose_T[ii][j][0], ithydose_T[ii][j][1], ithydose_T[ii][j][2], ithydose_T[ii][j][3], ithydose_T[ii][j][4], ithydose_T[ii][j][5]);
			}
		}

		for (int ii = 0; ii < ny; ii++)
		{
			for (int j = 0; j < nx; j++)
			{
				ieffdose_E[ii][j] = ieffdose_C[ii][j]* IERNetsf[0] + ieffdose_G[ii][j]* IERNetsf[1];
			}
		}

		if (i == 48)
		{
			stringstream ss5, ss6;
			if (model == 1)
			{
				ss5 << coutdir << "int_2day.eff";
				ss6 << coutdir << "int_2day.thy";
			}
			else
			{

				if (flexmodel == 1)
				{
					ss5 << ctempdir1 << "int_2day.eff";
					ss6 << ctempdir1 << "int_2day.thy";

				}
				else if (flexmodel == 2)
				{
					ss5 << ctempdir2 << "int_2day.eff";
					ss6 << ctempdir2 << "int_2day.thy";

				}
				else
				{
					ss5 << ctempdir3 << "int_2day.eff";
					ss6 << ctempdir3 << "int_2day.thy";

				}
			}
			string i2effpath = ss5.str();
			string i2thypath = ss6.str();
			ofstream i2outeff(i2effpath, ios_base::out | ios_base::binary);
			ofstream i2outthy(i2thypath, ios_base::out | ios_base::binary);

			for (int ii = 0; ii < ny; ii++)
			{
				for (int j = 0; j < nx; j++)
				{
					if (ii == 0 && j == 0)
					{
						i2outeff.write((char *)&ii, sizeof(int));
						i2outeff.write((char *)&j, sizeof(int));
						i2outthy.write((char *)&ii, sizeof(int));
						i2outthy.write((char *)&j, sizeof(int));
						i2outeff.write((char *)&ieffdose_C[ii][j], sizeof(float));
						i2outeff.write((char *)&ieffdose_G[ii][j], sizeof(float));
						i2outeff.write((char *)&ieffdose_E[ii][j], sizeof(float));
						i2outthy.write((char *)&ithydose_C[ii][j], sizeof(float));
						i2outthy.write((char *)&ithydose_G[ii][j], sizeof(float));


						for (int k = 0; k < 6; k++)
						{
							i2outeff.write((char *)&ieffdose_I[ii][j][k], sizeof(float));
							i2outeff.write((char *)&ieffdose_T[ii][j][k], sizeof(float));
							i2outthy.write((char *)&ithydose_I[ii][j][k], sizeof(float));
							i2outthy.write((char *)&ithydose_T[ii][j][k], sizeof(float));

						}

						i2outeff.write((char *)&ieffdose_Tmax[ii][j], sizeof(float));

						i2outthy.write((char *)&ithydose_Tmax[ii][j], sizeof(float));

					}
					else
					{
						if (effdose_T[ii][j][0] != 0 || thydose_T[ii][j][0] != 0)
						{
							i2outeff.write((char *)&ii, sizeof(int));
							i2outeff.write((char *)&j, sizeof(int));
							i2outthy.write((char *)&ii, sizeof(int));
							i2outthy.write((char *)&j, sizeof(int));
							i2outeff.write((char *)&ieffdose_C[ii][j], sizeof(float));
							i2outeff.write((char *)&ieffdose_G[ii][j], sizeof(float));
							i2outeff.write((char *)&ieffdose_E[ii][j], sizeof(float));
							i2outthy.write((char *)&ithydose_C[ii][j], sizeof(float));
							i2outthy.write((char *)&ithydose_G[ii][j], sizeof(float));

							for (int k = 0; k < 6; k++)
							{
								i2outeff.write((char *)&ieffdose_I[ii][j][k], sizeof(float));
								i2outeff.write((char *)&ieffdose_T[ii][j][k], sizeof(float));
								i2outthy.write((char *)&ithydose_I[ii][j][k], sizeof(float));
								i2outthy.write((char *)&ithydose_T[ii][j][k], sizeof(float));

							}

							i2outeff.write((char *)&ieffdose_Tmax[ii][j], sizeof(float));
							i2outthy.write((char *)&ithydose_Tmax[ii][j], sizeof(float));

						}
					}
				}
			}
		}


		// print dose output

		stringstream ss1, ss2, ss3, ss4;

		if (model == 1)
		{
			ss1 << coutdir << iyear << setfill('0') << setw(2) << imonth << setfill('0') << setw(2) << iday << "_";
			ss1 << setfill('0') << setw(2) << ihour << ".eff";
			ss2 << coutdir << iyear << setfill('0') << setw(2) << imonth << setfill('0') << setw(2) << iday << "_";
			ss2 << setfill('0') << setw(2) << ihour << ".thy";
			ss3 << coutdir << iyear << setfill('0') << setw(2) << imonth << setfill('0') << setw(2) << iday << "_";
			ss3 << setfill('0') << setw(2) << ihour << ".ieff";
			ss4 << coutdir << iyear << setfill('0') << setw(2) << imonth << setfill('0') << setw(2) << iday << "_";
			ss4 << setfill('0') << setw(2) << ihour << ".ithy";
		}
		else
		{
			if (flexmodel == 1)
			{
				ss1 << ctempdir1 << iyear << setfill('0') << setw(2) << imonth << setfill('0') << setw(2) << iday << "_";
				ss1 << setfill('0') << setw(2) << ihour << ".eff";
				ss2 << ctempdir1 << iyear << setfill('0') << setw(2) << imonth << setfill('0') << setw(2) << iday << "_";
				ss2 << setfill('0') << setw(2) << ihour << ".thy";
				ss3 << ctempdir1 << iyear << setfill('0') << setw(2) << imonth << setfill('0') << setw(2) << iday << "_";
				ss3 << setfill('0') << setw(2) << ihour << ".ieff";
				ss4 << ctempdir1 << iyear << setfill('0') << setw(2) << imonth << setfill('0') << setw(2) << iday << "_";
				ss4 << setfill('0') << setw(2) << ihour << ".ithy";
			}
			else if (flexmodel == 2)
			{
				ss1 << ctempdir2 << iyear << setfill('0') << setw(2) << imonth << setfill('0') << setw(2) << iday << "_";
				ss1 << setfill('0') << setw(2) << ihour << ".eff";
				ss2 << ctempdir2 << iyear << setfill('0') << setw(2) << imonth << setfill('0') << setw(2) << iday << "_";
				ss2 << setfill('0') << setw(2) << ihour << ".thy";
				ss3 << ctempdir2 << iyear << setfill('0') << setw(2) << imonth << setfill('0') << setw(2) << iday << "_";
				ss3 << setfill('0') << setw(2) << ihour << ".ieff";
				ss4 << ctempdir2 << iyear << setfill('0') << setw(2) << imonth << setfill('0') << setw(2) << iday << "_";
				ss4 << setfill('0') << setw(2) << ihour << ".ithy";
			}
			else
			{
				ss1 << ctempdir3 << iyear << setfill('0') << setw(2) << imonth << setfill('0') << setw(2) << iday << "_";
				ss1 << setfill('0') << setw(2) << ihour << ".eff";
				ss2 << ctempdir3 << iyear << setfill('0') << setw(2) << imonth << setfill('0') << setw(2) << iday << "_";
				ss2 << setfill('0') << setw(2) << ihour << ".thy";
				ss3 << ctempdir3 << iyear << setfill('0') << setw(2) << imonth << setfill('0') << setw(2) << iday << "_";
				ss3 << setfill('0') << setw(2) << ihour << ".ieff";
				ss4 << ctempdir3 << iyear << setfill('0') << setw(2) << imonth << setfill('0') << setw(2) << iday << "_";
				ss4 << setfill('0') << setw(2) << ihour << ".ithy";
			}
		}


		string effpath = ss1.str();
		string thypath = ss2.str();
		string ieffpath = ss3.str();
		string ithypath = ss4.str();
		ofstream outeff(effpath, ios_base::out | ios_base::binary);
		ofstream outthy(thypath, ios_base::out | ios_base::binary);
		ofstream outieff(ieffpath, ios_base::out | ios_base::binary);
		ofstream outithy(ithypath, ios_base::out | ios_base::binary);

		for (int ii = 0; ii < ny; ii++)
		{
			for (int j = 0; j < nx; j++)
			{
				if (ii == 0 && j == 0)
				{
					outeff.write((char *)&ii, sizeof(int));
					outeff.write((char *)&j, sizeof(int));
					outthy.write((char *)&ii, sizeof(int));
					outthy.write((char *)&j, sizeof(int));
					outeff.write((char *)&effdose_C[ii][j], sizeof(float));
					outeff.write((char *)&effdose_G[ii][j], sizeof(float));
					outeff.write((char *)&effdose_E[ii][j], sizeof(float));
					outthy.write((char *)&thydose_C[ii][j], sizeof(float));
					outthy.write((char *)&thydose_G[ii][j], sizeof(float));
					outieff.write((char *)&ii, sizeof(int));
					outieff.write((char *)&j, sizeof(int));
					outithy.write((char *)&ii, sizeof(int));
					outithy.write((char *)&j, sizeof(int));
					outieff.write((char *)&ieffdose_C[ii][j], sizeof(float));
					outieff.write((char *)&ieffdose_G[ii][j], sizeof(float));
					outieff.write((char *)&ieffdose_E[ii][j], sizeof(float));
					outithy.write((char *)&ithydose_C[ii][j], sizeof(float));
					outithy.write((char *)&ithydose_G[ii][j], sizeof(float));

					for (int k = 0; k < 6; k++)
					{
						outeff.write((char *)&effdose_I[ii][j][k], sizeof(float));
						outeff.write((char *)&effdose_T[ii][j][k], sizeof(float));
						outthy.write((char *)&thydose_I[ii][j][k], sizeof(float));
						outthy.write((char *)&thydose_T[ii][j][k], sizeof(float));
						outieff.write((char *)&ieffdose_I[ii][j][k], sizeof(float));
						outieff.write((char *)&ieffdose_T[ii][j][k], sizeof(float));
						outithy.write((char *)&ithydose_I[ii][j][k], sizeof(float));
						outithy.write((char *)&ithydose_T[ii][j][k], sizeof(float));
					}

					outeff.write((char *)&effdose_Tmax[ii][j], sizeof(float));
					outthy.write((char *)&thydose_Tmax[ii][j], sizeof(float));
					outieff.write((char *)&ieffdose_Tmax[ii][j], sizeof(float));
					outithy.write((char *)&ithydose_Tmax[ii][j], sizeof(float));

				}
				else
				{
					if (effdose_T[ii][j][0] != 0 || thydose_T[ii][j][0] != 0)
					{
						outeff.write((char *)&ii, sizeof(int));
						outeff.write((char *)&j, sizeof(int));
						outthy.write((char *)&ii, sizeof(int));
						outthy.write((char *)&j, sizeof(int));
						outeff.write((char *)&effdose_C[ii][j], sizeof(float));
						outeff.write((char *)&effdose_G[ii][j], sizeof(float));
						outeff.write((char *)&effdose_E[ii][j], sizeof(float));
						outthy.write((char *)&thydose_C[ii][j], sizeof(float));
						outthy.write((char *)&thydose_G[ii][j], sizeof(float));
						outieff.write((char *)&ii, sizeof(int));
						outieff.write((char *)&j, sizeof(int));
						outithy.write((char *)&ii, sizeof(int));
						outithy.write((char *)&j, sizeof(int));
						outieff.write((char *)&ieffdose_C[ii][j], sizeof(float));
						outieff.write((char *)&ieffdose_G[ii][j], sizeof(float));
						outieff.write((char *)&ieffdose_E[ii][j], sizeof(float));
						outithy.write((char *)&ithydose_C[ii][j], sizeof(float));
						outithy.write((char *)&ithydose_G[ii][j], sizeof(float));

						for (int k = 0; k < 6; k++)
						{
							outeff.write((char *)&effdose_I[ii][j][k], sizeof(float));
							outeff.write((char *)&effdose_T[ii][j][k], sizeof(float));
							outthy.write((char *)&thydose_I[ii][j][k], sizeof(float));
							outthy.write((char *)&thydose_T[ii][j][k], sizeof(float));
							outieff.write((char *)&ieffdose_I[ii][j][k], sizeof(float));
							outieff.write((char *)&ieffdose_T[ii][j][k], sizeof(float));
							outithy.write((char *)&ithydose_I[ii][j][k], sizeof(float));
							outithy.write((char *)&ithydose_T[ii][j][k], sizeof(float));
						}

						outeff.write((char *)&effdose_Tmax[ii][j], sizeof(float));
						outthy.write((char *)&thydose_Tmax[ii][j], sizeof(float));
						outieff.write((char *)&ieffdose_Tmax[ii][j], sizeof(float));
						outithy.write((char *)&ithydose_Tmax[ii][j], sizeof(float));

					}
				}
			}
		}

		//---- - +1hour------------------------
		if (ihour < 23)
			ihour++;
		else {
			ihour -= 23;

			if (iyear % 4 == 0){
				if (iday < edd2[imonth - 1]) iday++;
				else {
					if (imonth < 12) {
						iday = 1;
						imonth++;
					}
					else {
						iday = 1;
						imonth = 1;
						iyear++;
					}
				}
			}
			else{
				if (iday < edd1[imonth - 1]) iday++;
				else {
					if (imonth < 12) {
						iday = 1;
						imonth++;
					}
					else {
						iday = 1;
						imonth = 1;
						iyear++;
					}
				}
			}
		}
	}
	
	
	//Calculating ingestion dose


		for (int kk = 0; kk < nnuclide; kk++)
	{
		for (int ii = 0; ii < ny; ii++)
		{
			for (int jj = 0; jj < nx; jj++)
			{
				if (dryf[kk][ii][jj] != 0 || wetf[kk][ii][jj] !=0)
				{
					for (int f = 0; f < 4; f++)
					{

						if (incday < sday[f])
						{
							temppcon = (dryf[kk][ii][jj]+wetf[kk][ii][jj]) * exp(-(htoctime[f] + fday[f] - incday) * dconstant[kk]*24)*tf_p[kk][f]/165;
							tempdcon = (dryf[kk][ii][jj]+wetf[kk][ii][jj]) * (dconstant[kk]/(ddconstant[kk]-dconstant[kk]))*(exp(-(htoctime[f]+fday[f]-incday)*dconstant[kk]*24)-exp(-(htoctime[f]+fday[f]-incday)*ddconstant[kk]*24))*tfd_p[kk][f]/165;

							
							effdose_F[ii][jj][0] += temppcon * inING_A[kk][0] * ingq[5][f] + tempdcon * inINGd_A[kk][0] * ingq[5][f];
							thydose_F[ii][jj][0] += temppcon * inING_A[kk][1] * ingq[5][f] + tempdcon * inINGd_A[kk][1] * ingq[5][f];
							
							effdose_F[ii][jj][1] += temppcon * inING_15y[kk][0] * ingq[4][f] + tempdcon * inINGd_15y[kk][0] * ingq[4][f];
							thydose_F[ii][jj][1] += temppcon * inING_15y[kk][1] * ingq[4][f] + tempdcon * inINGd_15y[kk][1] * ingq[4][f];
			
							effdose_F[ii][jj][2] += temppcon * inING_10y[kk][0] * ingq[3][f] + tempdcon * inINGd_10y[kk][0] * ingq[3][f];
							thydose_F[ii][jj][2] += temppcon * inING_10y[kk][1] * ingq[3][f] + tempdcon * inINGd_10y[kk][1] * ingq[3][f];

							effdose_F[ii][jj][3] += temppcon * inING_5y[kk][0] * ingq[2][f] + tempdcon * inINGd_5y[kk][0] * ingq[2][f];
							thydose_F[ii][jj][3] += temppcon * inING_5y[kk][1] * ingq[2][f] + tempdcon * inINGd_5y[kk][1] * ingq[2][f];						

							effdose_F[ii][jj][4] += temppcon * inING_1y[kk][0] * ingq[1][f] + tempdcon * inINGd_1y[kk][0] * ingq[1][f];
							thydose_F[ii][jj][4] += temppcon * inING_1y[kk][1] * ingq[1][f] + tempdcon * inINGd_1y[kk][1] * ingq[1][f];							

							effdose_F[ii][jj][5] += temppcon * inING_3m[kk][0] * ingq[0][f] + tempdcon * inINGd_3m[kk][0] * ingq[0][f];
							thydose_F[ii][jj][5] += temppcon * inING_3m[kk][1] * ingq[0][f] + tempdcon * inINGd_3m[kk][1] * ingq[0][f];							

						ieffdose_F[ii][jj][0] += temppcon * inING_A[kk][0] * ingq[5][f] * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
						ithydose_F[ii][jj][0] += temppcon * inING_A[kk][1] * ingq[5][f] * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
						
						ieffdose_F[ii][jj][1] += temppcon * inING_15y[kk][0] * ingq[4][f] * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
						ithydose_F[ii][jj][1] += temppcon * inING_15y[kk][1] * ingq[4][f] * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
						
						ieffdose_F[ii][jj][2] += temppcon * inING_10y[kk][0] * ingq[3][f] * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
						ithydose_F[ii][jj][2] += temppcon * inING_10y[kk][1] * ingq[3][f] * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
						
						ieffdose_F[ii][jj][3] += temppcon * inING_5y[kk][0] * ingq[2][f] * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
						ithydose_F[ii][jj][3] += temppcon * inING_5y[kk][1] * ingq[2][f] * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
						
						ieffdose_F[ii][jj][4] += temppcon * inING_1y[kk][0] * ingq[1][f] * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
						ithydose_F[ii][jj][4] += temppcon * inING_1y[kk][1] * ingq[1][f] * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
						
						ieffdose_F[ii][jj][5] += temppcon * inING_3m[kk][0] * ingq[0][f] * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
						ithydose_F[ii][jj][5] += temppcon * inING_3m[kk][1] * ingq[0][f] * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
			

if (ddconstant[kk] != 0)

{
						ieffdose_F[ii][jj][0] += tempdcon * inINGd_A[kk][0] * ingq[5][f] * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
						ithydose_F[ii][jj][0] += tempdcon * inINGd_A[kk][1] * ingq[5][f] * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
						
						ieffdose_F[ii][jj][1] += tempdcon * inINGd_15y[kk][0] * ingq[4][f] * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
						ithydose_F[ii][jj][1] += tempdcon * inINGd_15y[kk][1] * ingq[4][f] * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
						
						ieffdose_F[ii][jj][2] += tempdcon * inINGd_10y[kk][0] * ingq[3][f] * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
						ithydose_F[ii][jj][2] += tempdcon * inINGd_10y[kk][1] * ingq[3][f] * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
						
						ieffdose_F[ii][jj][3] += tempdcon * inINGd_5y[kk][0] * ingq[2][f] * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
						ithydose_F[ii][jj][3] += tempdcon * inINGd_5y[kk][1] * ingq[2][f] * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
						
						ieffdose_F[ii][jj][4] += tempdcon * inINGd_1y[kk][0] * ingq[1][f] * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
						ithydose_F[ii][jj][4] += tempdcon * inINGd_1y[kk][1] * ingq[1][f] * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
						
						ieffdose_F[ii][jj][5] += tempdcon * inINGd_3m[kk][0] * ingq[0][f] * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
						ithydose_F[ii][jj][5] += tempdcon * inINGd_3m[kk][1] * ingq[0][f] * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
}
							if (f == 0)
							{
								for (int a = 2; a < 4; a++)
								{
								effdose_F[ii][jj][0] += temppcon * inING_A[kk][0] * ingq[5][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_A[kk][0] * ingq[5][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);
								thydose_F[ii][jj][0] += temppcon * inING_A[kk][1] * ingq[5][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_A[kk][1] * ingq[5][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);
				
								effdose_F[ii][jj][1] += temppcon * inING_15y[kk][0] * ingq[4][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_15y[kk][0] * ingq[4][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);
								thydose_F[ii][jj][1] += temppcon * inING_15y[kk][1] * ingq[4][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_15y[kk][1] * ingq[4][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);		
							
								effdose_F[ii][jj][2] += temppcon * inING_10y[kk][0] * ingq[3][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_10y[kk][0] * ingq[3][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);
								thydose_F[ii][jj][2] += temppcon * inING_10y[kk][1] * ingq[3][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_10y[kk][1] * ingq[3][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);		

								effdose_F[ii][jj][3] += temppcon * inING_5y[kk][0] * ingq[2][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_5y[kk][0] * ingq[2][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);
								thydose_F[ii][jj][3] += temppcon * inING_5y[kk][1] * ingq[2][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_5y[kk][1] * ingq[2][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);		
								
								effdose_F[ii][jj][4] += temppcon * inING_1y[kk][0] * ingq[1][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_1y[kk][0] * ingq[1][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);
								thydose_F[ii][jj][4] += temppcon * inING_1y[kk][1] * ingq[1][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_1y[kk][1] * ingq[1][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);	
								
								effdose_F[ii][jj][5] += temppcon * inING_3m[kk][0] * ingq[0][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_3m[kk][0] * ingq[0][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);
								thydose_F[ii][jj][5] += temppcon * inING_3m[kk][1] * ingq[0][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_3m[kk][1] * ingq[0][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);	

							ieffdose_F[ii][jj][0] += temppcon * inING_A[kk][0] * ingq[5][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							ithydose_F[ii][jj][0] += temppcon * inING_A[kk][1] * ingq[5][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
			
							ieffdose_F[ii][jj][1] += temppcon * inING_15y[kk][0] * ingq[4][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							ithydose_F[ii][jj][1] += temppcon * inING_15y[kk][1] * ingq[4][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							
							ieffdose_F[ii][jj][2] += temppcon * inING_10y[kk][0] * ingq[3][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							ithydose_F[ii][jj][2] += temppcon * inING_10y[kk][1] * ingq[3][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							
							ieffdose_F[ii][jj][3] += temppcon * inING_5y[kk][0] * ingq[2][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							ithydose_F[ii][jj][3] += temppcon * inING_5y[kk][1] * ingq[2][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
			
							ieffdose_F[ii][jj][4] += temppcon * inING_1y[kk][0] * ingq[1][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							ithydose_F[ii][jj][4] += temppcon * inING_1y[kk][1] * ingq[1][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							
							ieffdose_F[ii][jj][5] += temppcon * inING_3m[kk][0] * ingq[0][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							ithydose_F[ii][jj][5] += temppcon * inING_3m[kk][1] * ingq[0][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));

if (ddconstant[kk] != 0)

{
							ieffdose_F[ii][jj][0] += tempdcon * inINGd_A[kk][0] * ingq[5][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							ithydose_F[ii][jj][0] += tempdcon * inINGd_A[kk][1] * ingq[5][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
			
							ieffdose_F[ii][jj][1] += tempdcon * inINGd_15y[kk][0] * ingq[4][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							ithydose_F[ii][jj][1] += tempdcon * inINGd_15y[kk][1] * ingq[4][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							
							ieffdose_F[ii][jj][2] += tempdcon * inINGd_10y[kk][0] * ingq[3][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							ithydose_F[ii][jj][2] += tempdcon * inINGd_10y[kk][1] * ingq[3][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							
							ieffdose_F[ii][jj][3] += tempdcon * inINGd_5y[kk][0] * ingq[2][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							ithydose_F[ii][jj][3] += tempdcon * inINGd_5y[kk][1] * ingq[2][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
			
							ieffdose_F[ii][jj][4] += tempdcon * inINGd_1y[kk][0] * ingq[1][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							ithydose_F[ii][jj][4] += tempdcon * inINGd_1y[kk][1] * ingq[1][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							
							ieffdose_F[ii][jj][5] += tempdcon * inINGd_3m[kk][0] * ingq[0][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							ithydose_F[ii][jj][5] += tempdcon * inINGd_3m[kk][1] * ingq[0][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));


}

								}
							}
							if (f == 2)
							{
								for (int a = 0; a < 2; a++)
								{
								effdose_F[ii][jj][0] += temppcon * inING_A[kk][0] * ingq[5][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_A[kk][0] * ingq[5][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);
								thydose_F[ii][jj][0] += temppcon * inING_A[kk][1] * ingq[5][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_A[kk][1] * ingq[5][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);
				
								effdose_F[ii][jj][1] += temppcon * inING_15y[kk][0] * ingq[4][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_15y[kk][0] * ingq[4][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);
								thydose_F[ii][jj][1] += temppcon * inING_15y[kk][1] * ingq[4][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_15y[kk][1] * ingq[4][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);		
							
								effdose_F[ii][jj][2] += temppcon * inING_10y[kk][0] * ingq[3][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_10y[kk][0] * ingq[3][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);
								thydose_F[ii][jj][2] += temppcon * inING_10y[kk][1] * ingq[3][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_10y[kk][1] * ingq[3][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);		

								effdose_F[ii][jj][3] += temppcon * inING_5y[kk][0] * ingq[2][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_5y[kk][0] * ingq[2][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);
								thydose_F[ii][jj][3] += temppcon * inING_5y[kk][1] * ingq[2][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_5y[kk][1] * ingq[2][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);		
								
								effdose_F[ii][jj][4] += temppcon * inING_1y[kk][0] * ingq[1][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_1y[kk][0] * ingq[1][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);
								thydose_F[ii][jj][4] += temppcon * inING_1y[kk][1] * ingq[1][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_1y[kk][1] * ingq[1][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);	
								
								effdose_F[ii][jj][5] += temppcon * inING_3m[kk][0] * ingq[0][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_3m[kk][0] * ingq[0][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);
								thydose_F[ii][jj][5] += temppcon * inING_3m[kk][1] * ingq[0][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_3m[kk][1] * ingq[0][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);	

							ieffdose_F[ii][jj][0] += temppcon * inING_A[kk][0] * ingq[5][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							ithydose_F[ii][jj][0] += temppcon * inING_A[kk][1] * ingq[5][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
			
							ieffdose_F[ii][jj][1] += temppcon * inING_15y[kk][0] * ingq[4][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							ithydose_F[ii][jj][1] += temppcon * inING_15y[kk][1] * ingq[4][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							
							ieffdose_F[ii][jj][2] += temppcon * inING_10y[kk][0] * ingq[3][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							ithydose_F[ii][jj][2] += temppcon * inING_10y[kk][1] * ingq[3][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							
							ieffdose_F[ii][jj][3] += temppcon * inING_5y[kk][0] * ingq[2][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							ithydose_F[ii][jj][3] += temppcon * inING_5y[kk][1] * ingq[2][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
			
							ieffdose_F[ii][jj][4] += temppcon * inING_1y[kk][0] * ingq[1][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							ithydose_F[ii][jj][4] += temppcon * inING_1y[kk][1] * ingq[1][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							
							ieffdose_F[ii][jj][5] += temppcon * inING_3m[kk][0] * ingq[0][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							ithydose_F[ii][jj][5] += temppcon * inING_3m[kk][1] * ingq[0][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));

if (ddconstant[kk] != 0)

{
							ieffdose_F[ii][jj][0] += tempdcon * inINGd_A[kk][0] * ingq[5][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							ithydose_F[ii][jj][0] += tempdcon * inINGd_A[kk][1] * ingq[5][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
			
							ieffdose_F[ii][jj][1] += tempdcon * inINGd_15y[kk][0] * ingq[4][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							ithydose_F[ii][jj][1] += tempdcon * inINGd_15y[kk][1] * ingq[4][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							
							ieffdose_F[ii][jj][2] += tempdcon * inINGd_10y[kk][0] * ingq[3][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							ithydose_F[ii][jj][2] += tempdcon * inINGd_10y[kk][1] * ingq[3][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							
							ieffdose_F[ii][jj][3] += tempdcon * inINGd_5y[kk][0] * ingq[2][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							ithydose_F[ii][jj][3] += tempdcon * inINGd_5y[kk][1] * ingq[2][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
			
							ieffdose_F[ii][jj][4] += tempdcon * inINGd_1y[kk][0] * ingq[1][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							ithydose_F[ii][jj][4] += tempdcon * inINGd_1y[kk][1] * ingq[1][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							
							ieffdose_F[ii][jj][5] += tempdcon * inINGd_3m[kk][0] * ingq[0][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							ithydose_F[ii][jj][5] += tempdcon * inINGd_3m[kk][1] * ingq[0][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));


}



								}	
							}	
						}
						
						else if (incday < fday[f])
						{
							if (f != 2)
							{	
								temppcon = (dryf[kk][ii][jj]+wetf[kk][ii][jj]) * exp(-(htoctime[f] + fday[f] - incday) * dconstant[kk]*24)*partup[kk]/prod[f] + (dryf[kk][ii][jj]+wetf[kk][ii][jj]) * exp(-(htoctime[f] + fday[f] - incday) * dconstant[kk]*24)*tf_p[kk][f]/165;
								tempdcon = (dryf[kk][ii][jj]+wetf[kk][ii][jj]) * (dconstant[kk]/(ddconstant[kk]-dconstant[kk]))*(exp(-(htoctime[f]+fday[f]-incday)*dconstant[kk]*24)-exp(-(htoctime[f]+fday[f]-incday)*ddconstant[kk]*24))*partup[kk]/prod[f] + (dryf[kk][ii][jj]+wetf[kk][ii][jj]) * (dconstant[kk]/(ddconstant[kk]-dconstant[kk]))*(exp(-(htoctime[f]+fday[f]-incday)*dconstant[kk]*24)-exp(-(htoctime[f]+fday[f]-incday)*ddconstant[kk]*24))*tfd_p[kk][f]/165;
temppcona = (dryf[kk][ii][jj]+wetf[kk][ii][jj]) * exp(-(htoctime[f] + fday[f] - incday) * dconstant[kk]*24)*partup[kk]/prod[f];
temppconr = (dryf[kk][ii][jj]+wetf[kk][ii][jj]) * exp(-(htoctime[f] + fday[f] - incday) * dconstant[kk]*24)*tf_p[kk][f]/165;
tempdconr = (dryf[kk][ii][jj]+wetf[kk][ii][jj]) * (dconstant[kk]/(ddconstant[kk]-dconstant[kk]))*(exp(-(htoctime[f]+fday[f]-incday)*dconstant[kk]*24)-exp(-(htoctime[f]+fday[f]-incday)*ddconstant[kk]*24))*tfd_p[kk][f]/165;				

				
								effdose_F[ii][jj][0] += temppcon * inING_A[kk][0] * ingq[5][f] + tempdcon * inINGd_A[kk][0] * ingq[5][f];
								thydose_F[ii][jj][0] += temppcon * inING_A[kk][1] * ingq[5][f] + tempdcon * inINGd_A[kk][1] * ingq[5][f];
								
								effdose_F[ii][jj][1] += temppcon * inING_15y[kk][0] * ingq[4][f] + tempdcon * inINGd_15y[kk][0] * ingq[4][f];
								thydose_F[ii][jj][1] += temppcon * inING_15y[kk][1] * ingq[4][f] + tempdcon * inINGd_15y[kk][1] * ingq[4][f];
				
								effdose_F[ii][jj][2] += temppcon * inING_10y[kk][0] * ingq[3][f] + tempdcon * inINGd_10y[kk][0] * ingq[3][f];
								thydose_F[ii][jj][2] += temppcon * inING_10y[kk][1] * ingq[3][f] + tempdcon * inINGd_10y[kk][1] * ingq[3][f];

								effdose_F[ii][jj][3] += temppcon * inING_5y[kk][0] * ingq[2][f] + tempdcon * inINGd_5y[kk][0] * ingq[2][f];
								thydose_F[ii][jj][3] += temppcon * inING_5y[kk][1] * ingq[2][f] + tempdcon * inINGd_5y[kk][1] * ingq[2][f];						

								effdose_F[ii][jj][4] += temppcon * inING_1y[kk][0] * ingq[1][f] + tempdcon * inINGd_1y[kk][0] * ingq[1][f];
								thydose_F[ii][jj][4] += temppcon * inING_1y[kk][1] * ingq[1][f] + tempdcon * inINGd_1y[kk][1] * ingq[1][f];							

								effdose_F[ii][jj][5] += temppcon * inING_3m[kk][0] * ingq[0][f] + tempdcon * inINGd_3m[kk][0] * ingq[0][f];
								thydose_F[ii][jj][5] += temppcon * inING_3m[kk][1] * ingq[0][f] + tempdcon * inINGd_3m[kk][1] * ingq[0][f];	

						ieffdose_F[ii][jj][0] += temppconr * inING_A[kk][0] * ingq[5][f] * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
						ithydose_F[ii][jj][0] += temppconr * inING_A[kk][1] * ingq[5][f] * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
						
						ieffdose_F[ii][jj][1] += temppconr * inING_15y[kk][0] * ingq[4][f] * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
						ithydose_F[ii][jj][1] += temppconr * inING_15y[kk][1] * ingq[4][f] * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
						
						ieffdose_F[ii][jj][2] += temppconr * inING_10y[kk][0] * ingq[3][f] * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
						ithydose_F[ii][jj][2] += temppconr * inING_10y[kk][1] * ingq[3][f] * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
						
						ieffdose_F[ii][jj][3] += temppconr * inING_5y[kk][0] * ingq[2][f] * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
						ithydose_F[ii][jj][3] += temppconr * inING_5y[kk][1] * ingq[2][f] * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
						
						ieffdose_F[ii][jj][4] += temppconr * inING_1y[kk][0] * ingq[1][f] * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
						ithydose_F[ii][jj][4] += temppconr * inING_1y[kk][1] * ingq[1][f] * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
						
						ieffdose_F[ii][jj][5] += temppconr * inING_3m[kk][0] * ingq[0][f] * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
						ithydose_F[ii][jj][5] += temppconr * inING_3m[kk][1] * ingq[0][f] * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
			

if (ddconstant[kk] != 0)

{
						ieffdose_F[ii][jj][0] += tempdconr * inINGd_A[kk][0] * ingq[5][f] * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
						ithydose_F[ii][jj][0] += tempdconr * inINGd_A[kk][1] * ingq[5][f] * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
						
						ieffdose_F[ii][jj][1] += tempdconr * inINGd_15y[kk][0] * ingq[4][f] * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
						ithydose_F[ii][jj][1] += tempdconr * inINGd_15y[kk][1] * ingq[4][f] * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
						
						ieffdose_F[ii][jj][2] += tempdconr * inINGd_10y[kk][0] * ingq[3][f] * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
						ithydose_F[ii][jj][2] += tempdconr * inINGd_10y[kk][1] * ingq[3][f] * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
						
						ieffdose_F[ii][jj][3] += tempdconr * inINGd_5y[kk][0] * ingq[2][f] * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
						ithydose_F[ii][jj][3] += tempdconr * inINGd_5y[kk][1] * ingq[2][f] * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
						
						ieffdose_F[ii][jj][4] += tempdconr * inINGd_1y[kk][0] * ingq[1][f] * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
						ithydose_F[ii][jj][4] += tempdconr * inINGd_1y[kk][1] * ingq[1][f] * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
						
						ieffdose_F[ii][jj][5] += tempdconr * inINGd_3m[kk][0] * ingq[0][f] * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
						ithydose_F[ii][jj][5] += tempdconr * inINGd_3m[kk][1] * ingq[0][f] * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
}
	

								if (f == 0)
								{
									for (int a = 2; a < 4; a++)
									{
									effdose_F[ii][jj][0] += temppcon * inING_A[kk][0] * ingq[5][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_A[kk][0] * ingq[5][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);
									thydose_F[ii][jj][0] += temppcon * inING_A[kk][1] * ingq[5][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_A[kk][1] * ingq[5][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);
					
									effdose_F[ii][jj][1] += temppcon * inING_15y[kk][0] * ingq[4][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_15y[kk][0] * ingq[4][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);
									thydose_F[ii][jj][1] += temppcon * inING_15y[kk][1] * ingq[4][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_15y[kk][1] * ingq[4][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);		
								
									effdose_F[ii][jj][2] += temppcon * inING_10y[kk][0] * ingq[3][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_10y[kk][0] * ingq[3][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);
									thydose_F[ii][jj][2] += temppcon * inING_10y[kk][1] * ingq[3][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_10y[kk][1] * ingq[3][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);		

									effdose_F[ii][jj][3] += temppcon * inING_5y[kk][0] * ingq[2][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_5y[kk][0] * ingq[2][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);
									thydose_F[ii][jj][3] += temppcon * inING_5y[kk][1] * ingq[2][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_5y[kk][1] * ingq[2][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);		
									
									effdose_F[ii][jj][4] += temppcon * inING_1y[kk][0] * ingq[1][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_1y[kk][0] * ingq[1][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);
									thydose_F[ii][jj][4] += temppcon * inING_1y[kk][1] * ingq[1][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_1y[kk][1] * ingq[1][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);	
									
									effdose_F[ii][jj][5] += temppcon * inING_3m[kk][0] * ingq[0][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_3m[kk][0] * ingq[0][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);
									thydose_F[ii][jj][5] += temppcon * inING_3m[kk][1] * ingq[0][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_3m[kk][1] * ingq[0][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);	

							ieffdose_F[ii][jj][0] += temppconr * inING_A[kk][0] * ingq[5][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							ithydose_F[ii][jj][0] += temppconr * inING_A[kk][1] * ingq[5][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
			
							ieffdose_F[ii][jj][1] += temppconr * inING_15y[kk][0] * ingq[4][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							ithydose_F[ii][jj][1] += temppconr * inING_15y[kk][1] * ingq[4][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							
							ieffdose_F[ii][jj][2] += temppconr * inING_10y[kk][0] * ingq[3][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							ithydose_F[ii][jj][2] += temppconr * inING_10y[kk][1] * ingq[3][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							
							ieffdose_F[ii][jj][3] += temppconr * inING_5y[kk][0] * ingq[2][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							ithydose_F[ii][jj][3] += temppconr * inING_5y[kk][1] * ingq[2][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
			
							ieffdose_F[ii][jj][4] += temppconr * inING_1y[kk][0] * ingq[1][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							ithydose_F[ii][jj][4] += temppconr * inING_1y[kk][1] * ingq[1][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							
							ieffdose_F[ii][jj][5] += temppconr * inING_3m[kk][0] * ingq[0][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							ithydose_F[ii][jj][5] += temppconr * inING_3m[kk][1] * ingq[0][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));

if (ddconstant[kk] != 0)

{
							ieffdose_F[ii][jj][0] += tempdconr * inINGd_A[kk][0] * ingq[5][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							ithydose_F[ii][jj][0] += tempdconr * inINGd_A[kk][1] * ingq[5][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
			
							ieffdose_F[ii][jj][1] += tempdconr * inINGd_15y[kk][0] * ingq[4][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							ithydose_F[ii][jj][1] += tempdconr * inINGd_15y[kk][1] * ingq[4][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							
							ieffdose_F[ii][jj][2] += tempdconr * inINGd_10y[kk][0] * ingq[3][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							ithydose_F[ii][jj][2] += tempdconr * inINGd_10y[kk][1] * ingq[3][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							
							ieffdose_F[ii][jj][3] += tempdconr * inINGd_5y[kk][0] * ingq[2][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							ithydose_F[ii][jj][3] += tempdconr * inINGd_5y[kk][1] * ingq[2][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
			
							ieffdose_F[ii][jj][4] += tempdconr * inINGd_1y[kk][0] * ingq[1][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							ithydose_F[ii][jj][4] += tempdconr * inINGd_1y[kk][1] * ingq[1][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							
							ieffdose_F[ii][jj][5] += tempdconr * inINGd_3m[kk][0] * ingq[0][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							ithydose_F[ii][jj][5] += tempdconr * inINGd_3m[kk][1] * ingq[0][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));


}


									}
								}
								if (f == 2)
								{
									for (int a = 0; a < 2; a++)
									{
									effdose_F[ii][jj][0] += temppcon * inING_A[kk][0] * ingq[5][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_A[kk][0] * ingq[5][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);
									thydose_F[ii][jj][0] += temppcon * inING_A[kk][1] * ingq[5][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_A[kk][1] * ingq[5][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);
					
									effdose_F[ii][jj][1] += temppcon * inING_15y[kk][0] * ingq[4][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_15y[kk][0] * ingq[4][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);
									thydose_F[ii][jj][1] += temppcon * inING_15y[kk][1] * ingq[4][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_15y[kk][1] * ingq[4][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);		
								
									effdose_F[ii][jj][2] += temppcon * inING_10y[kk][0] * ingq[3][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_10y[kk][0] * ingq[3][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);
									thydose_F[ii][jj][2] += temppcon * inING_10y[kk][1] * ingq[3][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_10y[kk][1] * ingq[3][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);		

									effdose_F[ii][jj][3] += temppcon * inING_5y[kk][0] * ingq[2][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_5y[kk][0] * ingq[2][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);
									thydose_F[ii][jj][3] += temppcon * inING_5y[kk][1] * ingq[2][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_5y[kk][1] * ingq[2][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);		
									
									effdose_F[ii][jj][4] += temppcon * inING_1y[kk][0] * ingq[1][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_1y[kk][0] * ingq[1][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);
									thydose_F[ii][jj][4] += temppcon * inING_1y[kk][1] * ingq[1][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_1y[kk][1] * ingq[1][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);	
									
									effdose_F[ii][jj][5] += temppcon * inING_3m[kk][0] * ingq[0][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_3m[kk][0] * ingq[0][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);
									thydose_F[ii][jj][5] += temppcon * inING_3m[kk][1] * ingq[0][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_3m[kk][1] * ingq[0][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);	

							ieffdose_F[ii][jj][0] += temppconr * inING_A[kk][0] * ingq[5][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							ithydose_F[ii][jj][0] += temppconr * inING_A[kk][1] * ingq[5][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
			
							ieffdose_F[ii][jj][1] += temppconr * inING_15y[kk][0] * ingq[4][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							ithydose_F[ii][jj][1] += temppconr * inING_15y[kk][1] * ingq[4][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							
							ieffdose_F[ii][jj][2] += temppconr * inING_10y[kk][0] * ingq[3][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							ithydose_F[ii][jj][2] += temppconr * inING_10y[kk][1] * ingq[3][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							
							ieffdose_F[ii][jj][3] += temppconr * inING_5y[kk][0] * ingq[2][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							ithydose_F[ii][jj][3] += temppconr * inING_5y[kk][1] * ingq[2][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
			
							ieffdose_F[ii][jj][4] += temppconr * inING_1y[kk][0] * ingq[1][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							ithydose_F[ii][jj][4] += temppconr * inING_1y[kk][1] * ingq[1][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							
							ieffdose_F[ii][jj][5] += temppconr * inING_3m[kk][0] * ingq[0][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							ithydose_F[ii][jj][5] += temppconr * inING_3m[kk][1] * ingq[0][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));

if (ddconstant[kk] != 0)

{
							ieffdose_F[ii][jj][0] += tempdconr * inINGd_A[kk][0] * ingq[5][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							ithydose_F[ii][jj][0] += tempdconr * inINGd_A[kk][1] * ingq[5][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
			
							ieffdose_F[ii][jj][1] += tempdconr * inINGd_15y[kk][0] * ingq[4][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							ithydose_F[ii][jj][1] += tempdconr * inINGd_15y[kk][1] * ingq[4][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							
							ieffdose_F[ii][jj][2] += tempdconr * inINGd_10y[kk][0] * ingq[3][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							ithydose_F[ii][jj][2] += tempdconr * inINGd_10y[kk][1] * ingq[3][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							
							ieffdose_F[ii][jj][3] += tempdconr * inINGd_5y[kk][0] * ingq[2][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							ithydose_F[ii][jj][3] += tempdconr * inINGd_5y[kk][1] * ingq[2][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
			
							ieffdose_F[ii][jj][4] += tempdconr * inINGd_1y[kk][0] * ingq[1][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							ithydose_F[ii][jj][4] += tempdconr * inINGd_1y[kk][1] * ingq[1][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							
							ieffdose_F[ii][jj][5] += tempdconr * inINGd_3m[kk][0] * ingq[0][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							ithydose_F[ii][jj][5] += tempdconr * inINGd_3m[kk][1] * ingq[0][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));


}


									}	
								}									
							}
	
	
							else
							{
								if ((fday[f]-incday) < 30)
								{

									temppcon = (dryf[kk][ii][jj]+wetf[kk][ii][jj]) * exp(-(htoctime[f] + fday[f] - incday) * dconstant[kk]*24)*partup[kk]/prod[f] + (dryf[kk][ii][jj]+wetf[kk][ii][jj]) * exp(-(htoctime[f] + fday[f] - incday) * dconstant[kk]*24)*tf_p[kk][f]/165;
									tempdcon = (dryf[kk][ii][jj]+wetf[kk][ii][jj]) * (dconstant[kk]/(ddconstant[kk]-dconstant[kk]))*(exp(-(htoctime[f]+fday[f]-incday)*dconstant[kk]*24)-exp(-(htoctime[f]+fday[f]-incday)*ddconstant[kk]*24))*partup[kk]/prod[f] + (dryf[kk][ii][jj]+wetf[kk][ii][jj]) * (dconstant[kk]/(ddconstant[kk]-dconstant[kk]))*(exp(-(htoctime[f]+fday[f]-incday)*dconstant[kk]*24)-exp(-(htoctime[f]+fday[f]-incday)*ddconstant[kk]*24))*tfd_p[kk][f]/165;
		
temppcona = (dryf[kk][ii][jj]+wetf[kk][ii][jj]) * exp(-(htoctime[f] + fday[f] - incday) * dconstant[kk]*24)*partup[kk]/prod[f];
temppconr = (dryf[kk][ii][jj]+wetf[kk][ii][jj]) * exp(-(htoctime[f] + fday[f] - incday) * dconstant[kk]*24)*tf_p[kk][f]/165;
tempdconr = (dryf[kk][ii][jj]+wetf[kk][ii][jj]) * (dconstant[kk]/(ddconstant[kk]-dconstant[kk]))*(exp(-(htoctime[f]+fday[f]-incday)*dconstant[kk]*24)-exp(-(htoctime[f]+fday[f]-incday)*ddconstant[kk]*24))*tfd_p[kk][f]/165;		

									effdose_F[ii][jj][0] += temppcon * inING_A[kk][0] * ingq[5][f] + tempdcon * inINGd_A[kk][0] * ingq[5][f];
									thydose_F[ii][jj][0] += temppcon * inING_A[kk][1] * ingq[5][f] + tempdcon * inINGd_A[kk][1] * ingq[5][f];
									
									effdose_F[ii][jj][1] += temppcon * inING_15y[kk][0] * ingq[4][f] + tempdcon * inINGd_15y[kk][0] * ingq[4][f];
									thydose_F[ii][jj][1] += temppcon * inING_15y[kk][1] * ingq[4][f] + tempdcon * inINGd_15y[kk][1] * ingq[4][f];
					
									effdose_F[ii][jj][2] += temppcon * inING_10y[kk][0] * ingq[3][f] + tempdcon * inINGd_10y[kk][0] * ingq[3][f];
									thydose_F[ii][jj][2] += temppcon * inING_10y[kk][1] * ingq[3][f] + tempdcon * inINGd_10y[kk][1] * ingq[3][f];

									effdose_F[ii][jj][3] += temppcon * inING_5y[kk][0] * ingq[2][f] + tempdcon * inINGd_5y[kk][0] * ingq[2][f];
									thydose_F[ii][jj][3] += temppcon * inING_5y[kk][1] * ingq[2][f] + tempdcon * inINGd_5y[kk][1] * ingq[2][f];						

									effdose_F[ii][jj][4] += temppcon * inING_1y[kk][0] * ingq[1][f] + tempdcon * inINGd_1y[kk][0] * ingq[1][f];
									thydose_F[ii][jj][4] += temppcon * inING_1y[kk][1] * ingq[1][f] + tempdcon * inINGd_1y[kk][1] * ingq[1][f];							

									effdose_F[ii][jj][5] += temppcon * inING_3m[kk][0] * ingq[0][f] + tempdcon * inINGd_3m[kk][0] * ingq[0][f];
									thydose_F[ii][jj][5] += temppcon * inING_3m[kk][1] * ingq[0][f] + tempdcon * inINGd_3m[kk][1] * ingq[0][f];																		
								
						ieffdose_F[ii][jj][0] += temppconr * inING_A[kk][0] * ingq[5][f] * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
						ithydose_F[ii][jj][0] += temppconr * inING_A[kk][1] * ingq[5][f] * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
						
						ieffdose_F[ii][jj][1] += temppconr * inING_15y[kk][0] * ingq[4][f] * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
						ithydose_F[ii][jj][1] += temppconr * inING_15y[kk][1] * ingq[4][f] * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
						
						ieffdose_F[ii][jj][2] += temppconr * inING_10y[kk][0] * ingq[3][f] * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
						ithydose_F[ii][jj][2] += temppconr * inING_10y[kk][1] * ingq[3][f] * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
						
						ieffdose_F[ii][jj][3] += temppconr * inING_5y[kk][0] * ingq[2][f] * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
						ithydose_F[ii][jj][3] += temppconr * inING_5y[kk][1] * ingq[2][f] * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
						
						ieffdose_F[ii][jj][4] += temppconr * inING_1y[kk][0] * ingq[1][f] * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
						ithydose_F[ii][jj][4] += temppconr * inING_1y[kk][1] * ingq[1][f] * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
						
						ieffdose_F[ii][jj][5] += temppconr * inING_3m[kk][0] * ingq[0][f] * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
						ithydose_F[ii][jj][5] += temppconr * inING_3m[kk][1] * ingq[0][f] * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
			

if (ddconstant[kk] != 0)

{
						ieffdose_F[ii][jj][0] += tempdconr * inINGd_A[kk][0] * ingq[5][f] * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
						ithydose_F[ii][jj][0] += tempdconr * inINGd_A[kk][1] * ingq[5][f] * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
						
						ieffdose_F[ii][jj][1] += tempdconr * inINGd_15y[kk][0] * ingq[4][f] * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
						ithydose_F[ii][jj][1] += tempdconr * inINGd_15y[kk][1] * ingq[4][f] * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
						
						ieffdose_F[ii][jj][2] += tempdconr * inINGd_10y[kk][0] * ingq[3][f] * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
						ithydose_F[ii][jj][2] += tempdconr * inINGd_10y[kk][1] * ingq[3][f] * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
						
						ieffdose_F[ii][jj][3] += tempdconr * inINGd_5y[kk][0] * ingq[2][f] * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
						ithydose_F[ii][jj][3] += tempdconr * inINGd_5y[kk][1] * ingq[2][f] * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
						
						ieffdose_F[ii][jj][4] += tempdconr * inINGd_1y[kk][0] * ingq[1][f] * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
						ithydose_F[ii][jj][4] += tempdconr * inINGd_1y[kk][1] * ingq[1][f] * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
						
						ieffdose_F[ii][jj][5] += tempdconr * inINGd_3m[kk][0] * ingq[0][f] * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
						ithydose_F[ii][jj][5] += tempdconr * inINGd_3m[kk][1] * ingq[0][f] * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
}
			

									if (f == 0)
									{
										for (int a = 2; a < 4; a++)
										{
										effdose_F[ii][jj][0] += temppcon * inING_A[kk][0] * ingq[5][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_A[kk][0] * ingq[5][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);
										thydose_F[ii][jj][0] += temppcon * inING_A[kk][1] * ingq[5][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_A[kk][1] * ingq[5][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);
						
										effdose_F[ii][jj][1] += temppcon * inING_15y[kk][0] * ingq[4][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_15y[kk][0] * ingq[4][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);
										thydose_F[ii][jj][1] += temppcon * inING_15y[kk][1] * ingq[4][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_15y[kk][1] * ingq[4][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);		
									
										effdose_F[ii][jj][2] += temppcon * inING_10y[kk][0] * ingq[3][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_10y[kk][0] * ingq[3][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);
										thydose_F[ii][jj][2] += temppcon * inING_10y[kk][1] * ingq[3][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_10y[kk][1] * ingq[3][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);		

										effdose_F[ii][jj][3] += temppcon * inING_5y[kk][0] * ingq[2][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_5y[kk][0] * ingq[2][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);
										thydose_F[ii][jj][3] += temppcon * inING_5y[kk][1] * ingq[2][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_5y[kk][1] * ingq[2][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);		
										
										effdose_F[ii][jj][4] += temppcon * inING_1y[kk][0] * ingq[1][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_1y[kk][0] * ingq[1][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);
										thydose_F[ii][jj][4] += temppcon * inING_1y[kk][1] * ingq[1][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_1y[kk][1] * ingq[1][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);	
										
										effdose_F[ii][jj][5] += temppcon * inING_3m[kk][0] * ingq[0][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_3m[kk][0] * ingq[0][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);
										thydose_F[ii][jj][5] += temppcon * inING_3m[kk][1] * ingq[0][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_3m[kk][1] * ingq[0][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);	

							ieffdose_F[ii][jj][0] += temppconr * inING_A[kk][0] * ingq[5][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							ithydose_F[ii][jj][0] += temppconr * inING_A[kk][1] * ingq[5][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
			
							ieffdose_F[ii][jj][1] += temppconr * inING_15y[kk][0] * ingq[4][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							ithydose_F[ii][jj][1] += temppconr * inING_15y[kk][1] * ingq[4][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							
							ieffdose_F[ii][jj][2] += temppconr * inING_10y[kk][0] * ingq[3][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							ithydose_F[ii][jj][2] += temppconr * inING_10y[kk][1] * ingq[3][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							
							ieffdose_F[ii][jj][3] += temppconr * inING_5y[kk][0] * ingq[2][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							ithydose_F[ii][jj][3] += temppconr * inING_5y[kk][1] * ingq[2][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
			
							ieffdose_F[ii][jj][4] += temppconr * inING_1y[kk][0] * ingq[1][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							ithydose_F[ii][jj][4] += temppconr * inING_1y[kk][1] * ingq[1][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							
							ieffdose_F[ii][jj][5] += temppconr * inING_3m[kk][0] * ingq[0][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							ithydose_F[ii][jj][5] += temppconr * inING_3m[kk][1] * ingq[0][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));

if (ddconstant[kk] != 0)

{
							ieffdose_F[ii][jj][0] += tempdconr * inINGd_A[kk][0] * ingq[5][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							ithydose_F[ii][jj][0] += tempdconr * inINGd_A[kk][1] * ingq[5][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
			
							ieffdose_F[ii][jj][1] += tempdconr * inINGd_15y[kk][0] * ingq[4][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							ithydose_F[ii][jj][1] += tempdconr * inINGd_15y[kk][1] * ingq[4][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							
							ieffdose_F[ii][jj][2] += tempdconr * inINGd_10y[kk][0] * ingq[3][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							ithydose_F[ii][jj][2] += tempdconr * inINGd_10y[kk][1] * ingq[3][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							
							ieffdose_F[ii][jj][3] += tempdconr * inINGd_5y[kk][0] * ingq[2][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							ithydose_F[ii][jj][3] += tempdconr * inINGd_5y[kk][1] * ingq[2][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
			
							ieffdose_F[ii][jj][4] += tempdconr * inINGd_1y[kk][0] * ingq[1][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							ithydose_F[ii][jj][4] += tempdconr * inINGd_1y[kk][1] * ingq[1][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							
							ieffdose_F[ii][jj][5] += tempdconr * inINGd_3m[kk][0] * ingq[0][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							ithydose_F[ii][jj][5] += tempdconr * inINGd_3m[kk][1] * ingq[0][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));


}


										}
									}
									if (f == 2)
									{
										for (int a = 0; a < 2; a++)
										{
										effdose_F[ii][jj][0] += temppcon * inING_A[kk][0] * ingq[5][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_A[kk][0] * ingq[5][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);
										thydose_F[ii][jj][0] += temppcon * inING_A[kk][1] * ingq[5][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_A[kk][1] * ingq[5][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);
						
										effdose_F[ii][jj][1] += temppcon * inING_15y[kk][0] * ingq[4][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_15y[kk][0] * ingq[4][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);
										thydose_F[ii][jj][1] += temppcon * inING_15y[kk][1] * ingq[4][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_15y[kk][1] * ingq[4][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);		
									
										effdose_F[ii][jj][2] += temppcon * inING_10y[kk][0] * ingq[3][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_10y[kk][0] * ingq[3][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);
										thydose_F[ii][jj][2] += temppcon * inING_10y[kk][1] * ingq[3][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_10y[kk][1] * ingq[3][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);		

										effdose_F[ii][jj][3] += temppcon * inING_5y[kk][0] * ingq[2][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_5y[kk][0] * ingq[2][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);
										thydose_F[ii][jj][3] += temppcon * inING_5y[kk][1] * ingq[2][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_5y[kk][1] * ingq[2][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);		
										
										effdose_F[ii][jj][4] += temppcon * inING_1y[kk][0] * ingq[1][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_1y[kk][0] * ingq[1][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);
										thydose_F[ii][jj][4] += temppcon * inING_1y[kk][1] * ingq[1][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_1y[kk][1] * ingq[1][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);	
										
										effdose_F[ii][jj][5] += temppcon * inING_3m[kk][0] * ingq[0][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_3m[kk][0] * ingq[0][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);
										thydose_F[ii][jj][5] += temppcon * inING_3m[kk][1] * ingq[0][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_3m[kk][1] * ingq[0][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);	

							ieffdose_F[ii][jj][0] += temppconr * inING_A[kk][0] * ingq[5][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							ithydose_F[ii][jj][0] += temppconr * inING_A[kk][1] * ingq[5][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
			
							ieffdose_F[ii][jj][1] += temppconr * inING_15y[kk][0] * ingq[4][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							ithydose_F[ii][jj][1] += temppconr * inING_15y[kk][1] * ingq[4][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							
							ieffdose_F[ii][jj][2] += temppconr * inING_10y[kk][0] * ingq[3][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							ithydose_F[ii][jj][2] += temppconr * inING_10y[kk][1] * ingq[3][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							
							ieffdose_F[ii][jj][3] += temppconr * inING_5y[kk][0] * ingq[2][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							ithydose_F[ii][jj][3] += temppconr * inING_5y[kk][1] * ingq[2][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
			
							ieffdose_F[ii][jj][4] += temppconr * inING_1y[kk][0] * ingq[1][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							ithydose_F[ii][jj][4] += temppconr * inING_1y[kk][1] * ingq[1][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							
							ieffdose_F[ii][jj][5] += temppconr * inING_3m[kk][0] * ingq[0][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							ithydose_F[ii][jj][5] += temppconr * inING_3m[kk][1] * ingq[0][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));

if (ddconstant[kk] != 0)

{
							ieffdose_F[ii][jj][0] += tempdconr * inINGd_A[kk][0] * ingq[5][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							ithydose_F[ii][jj][0] += tempdconr * inINGd_A[kk][1] * ingq[5][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
			
							ieffdose_F[ii][jj][1] += tempdconr * inINGd_15y[kk][0] * ingq[4][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							ithydose_F[ii][jj][1] += tempdconr * inINGd_15y[kk][1] * ingq[4][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							
							ieffdose_F[ii][jj][2] += tempdconr * inINGd_10y[kk][0] * ingq[3][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							ithydose_F[ii][jj][2] += tempdconr * inINGd_10y[kk][1] * ingq[3][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							
							ieffdose_F[ii][jj][3] += tempdconr * inINGd_5y[kk][0] * ingq[2][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							ithydose_F[ii][jj][3] += tempdconr * inINGd_5y[kk][1] * ingq[2][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
			
							ieffdose_F[ii][jj][4] += tempdconr * inINGd_1y[kk][0] * ingq[1][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							ithydose_F[ii][jj][4] += tempdconr * inINGd_1y[kk][1] * ingq[1][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							
							ieffdose_F[ii][jj][5] += tempdconr * inINGd_3m[kk][0] * ingq[0][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							ithydose_F[ii][jj][5] += tempdconr * inINGd_3m[kk][1] * ingq[0][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));


}

	
										}	
									}									
								
								
								}
								else
								{

									temppcon = (dryf[kk][ii][jj]+wetf[kk][ii][jj]) * exp(-(htoctime[f] + 30) * dconstant[kk]*24)*partup[kk]/prod[f] + (dryf[kk][ii][jj]+wetf[kk][ii][jj]) * exp(-(htoctime[f] + 30) * dconstant[kk]*24)*tf_p[kk][f]/165;
									tempdcon = (dryf[kk][ii][jj]+wetf[kk][ii][jj]) * (dconstant[kk]/(ddconstant[kk]-dconstant[kk]))*(exp(-(htoctime[f]+30)*dconstant[kk]*24)-exp(-(htoctime[f]+30)*ddconstant[kk]*24))*partup[kk]/prod[f] + (dryf[kk][ii][jj]+wetf[kk][ii][jj]) * (dconstant[kk]/(ddconstant[kk]-dconstant[kk]))*(exp(-(htoctime[f]+30)*dconstant[kk]*24)-exp(-(htoctime[f]+30)*ddconstant[kk]*24))*tfd_p[kk][f]/165;
				
temppcona = (dryf[kk][ii][jj]+wetf[kk][ii][jj]) * exp(-(htoctime[f] + 30) * dconstant[kk]*24)*partup[kk]/prod[f];
temppconr = (dryf[kk][ii][jj]+wetf[kk][ii][jj]) * exp(-(htoctime[f] + 30) * dconstant[kk]*24)*tf_p[kk][f]/165;
tempdconr = (dryf[kk][ii][jj]+wetf[kk][ii][jj]) * (dconstant[kk]/(ddconstant[kk]-dconstant[kk]))*(exp(-(htoctime[f]+30)*dconstant[kk]*24)-exp(-(htoctime[f]+30)*ddconstant[kk]*24))*tfd_p[kk][f]/165;				

									effdose_F[ii][jj][0] += temppcon * inING_A[kk][0] * ingq[5][f] + tempdcon * inINGd_A[kk][0] * ingq[5][f];
									thydose_F[ii][jj][0] += temppcon * inING_A[kk][1] * ingq[5][f] + tempdcon * inINGd_A[kk][1] * ingq[5][f];
									
									effdose_F[ii][jj][1] += temppcon * inING_15y[kk][0] * ingq[4][f] + tempdcon * inINGd_15y[kk][0] * ingq[4][f];
									thydose_F[ii][jj][1] += temppcon * inING_15y[kk][1] * ingq[4][f] + tempdcon * inINGd_15y[kk][1] * ingq[4][f];
					
									effdose_F[ii][jj][2] += temppcon * inING_10y[kk][0] * ingq[3][f] + tempdcon * inINGd_10y[kk][0] * ingq[3][f];
									thydose_F[ii][jj][2] += temppcon * inING_10y[kk][1] * ingq[3][f] + tempdcon * inINGd_10y[kk][1] * ingq[3][f];

									effdose_F[ii][jj][3] += temppcon * inING_5y[kk][0] * ingq[2][f] + tempdcon * inINGd_5y[kk][0] * ingq[2][f];
									thydose_F[ii][jj][3] += temppcon * inING_5y[kk][1] * ingq[2][f] + tempdcon * inINGd_5y[kk][1] * ingq[2][f];						

									effdose_F[ii][jj][4] += temppcon * inING_1y[kk][0] * ingq[1][f] + tempdcon * inINGd_1y[kk][0] * ingq[1][f];
									thydose_F[ii][jj][4] += temppcon * inING_1y[kk][1] * ingq[1][f] + tempdcon * inINGd_1y[kk][1] * ingq[1][f];							

									effdose_F[ii][jj][5] += temppcon * inING_3m[kk][0] * ingq[0][f] + tempdcon * inINGd_3m[kk][0] * ingq[0][f];
									thydose_F[ii][jj][5] += temppcon * inING_3m[kk][1] * ingq[0][f] + tempdcon * inINGd_3m[kk][1] * ingq[0][f];																		
								
						ieffdose_F[ii][jj][0] += temppconr * inING_A[kk][0] * ingq[5][f] * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
						ithydose_F[ii][jj][0] += temppconr * inING_A[kk][1] * ingq[5][f] * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
						
						ieffdose_F[ii][jj][1] += temppconr * inING_15y[kk][0] * ingq[4][f] * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
						ithydose_F[ii][jj][1] += temppconr * inING_15y[kk][1] * ingq[4][f] * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
						
						ieffdose_F[ii][jj][2] += temppconr * inING_10y[kk][0] * ingq[3][f] * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
						ithydose_F[ii][jj][2] += temppconr * inING_10y[kk][1] * ingq[3][f] * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
						
						ieffdose_F[ii][jj][3] += temppconr * inING_5y[kk][0] * ingq[2][f] * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
						ithydose_F[ii][jj][3] += temppconr * inING_5y[kk][1] * ingq[2][f] * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
						
						ieffdose_F[ii][jj][4] += temppconr * inING_1y[kk][0] * ingq[1][f] * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
						ithydose_F[ii][jj][4] += temppconr * inING_1y[kk][1] * ingq[1][f] * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
						
						ieffdose_F[ii][jj][5] += temppconr * inING_3m[kk][0] * ingq[0][f] * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
						ithydose_F[ii][jj][5] += temppconr * inING_3m[kk][1] * ingq[0][f] * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
			

if (ddconstant[kk] != 0)

{
						ieffdose_F[ii][jj][0] += tempdconr * inINGd_A[kk][0] * ingq[5][f] * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
						ithydose_F[ii][jj][0] += tempdconr * inINGd_A[kk][1] * ingq[5][f] * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
						
						ieffdose_F[ii][jj][1] += tempdconr * inINGd_15y[kk][0] * ingq[4][f] * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
						ithydose_F[ii][jj][1] += tempdconr * inINGd_15y[kk][1] * ingq[4][f] * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
						
						ieffdose_F[ii][jj][2] += tempdconr * inINGd_10y[kk][0] * ingq[3][f] * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
						ithydose_F[ii][jj][2] += tempdconr * inINGd_10y[kk][1] * ingq[3][f] * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
						
						ieffdose_F[ii][jj][3] += tempdconr * inINGd_5y[kk][0] * ingq[2][f] * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
						ithydose_F[ii][jj][3] += tempdconr * inINGd_5y[kk][1] * ingq[2][f] * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
						
						ieffdose_F[ii][jj][4] += tempdconr * inINGd_1y[kk][0] * ingq[1][f] * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
						ithydose_F[ii][jj][4] += tempdconr * inINGd_1y[kk][1] * ingq[1][f] * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
						
						ieffdose_F[ii][jj][5] += tempdconr * inINGd_3m[kk][0] * ingq[0][f] * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
						ithydose_F[ii][jj][5] += tempdconr * inINGd_3m[kk][1] * ingq[0][f] * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
}
			

									if (f == 0)
									{
										for (int a = 2; a < 4; a++)
										{
										effdose_F[ii][jj][0] += temppcon * inING_A[kk][0] * ingq[5][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_A[kk][0] * ingq[5][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);
										thydose_F[ii][jj][0] += temppcon * inING_A[kk][1] * ingq[5][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_A[kk][1] * ingq[5][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);
						
										effdose_F[ii][jj][1] += temppcon * inING_15y[kk][0] * ingq[4][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_15y[kk][0] * ingq[4][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);
										thydose_F[ii][jj][1] += temppcon * inING_15y[kk][1] * ingq[4][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_15y[kk][1] * ingq[4][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);		
									
										effdose_F[ii][jj][2] += temppcon * inING_10y[kk][0] * ingq[3][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_10y[kk][0] * ingq[3][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);
										thydose_F[ii][jj][2] += temppcon * inING_10y[kk][1] * ingq[3][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_10y[kk][1] * ingq[3][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);		

										effdose_F[ii][jj][3] += temppcon * inING_5y[kk][0] * ingq[2][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_5y[kk][0] * ingq[2][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);
										thydose_F[ii][jj][3] += temppcon * inING_5y[kk][1] * ingq[2][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_5y[kk][1] * ingq[2][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);		
										
										effdose_F[ii][jj][4] += temppcon * inING_1y[kk][0] * ingq[1][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_1y[kk][0] * ingq[1][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);
										thydose_F[ii][jj][4] += temppcon * inING_1y[kk][1] * ingq[1][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_1y[kk][1] * ingq[1][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);	
										
										effdose_F[ii][jj][5] += temppcon * inING_3m[kk][0] * ingq[0][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_3m[kk][0] * ingq[0][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);
										thydose_F[ii][jj][5] += temppcon * inING_3m[kk][1] * ingq[0][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_3m[kk][1] * ingq[0][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);	

							ieffdose_F[ii][jj][0] += temppconr * inING_A[kk][0] * ingq[5][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							ithydose_F[ii][jj][0] += temppconr * inING_A[kk][1] * ingq[5][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
			
							ieffdose_F[ii][jj][1] += temppconr * inING_15y[kk][0] * ingq[4][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							ithydose_F[ii][jj][1] += temppconr * inING_15y[kk][1] * ingq[4][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							
							ieffdose_F[ii][jj][2] += temppconr * inING_10y[kk][0] * ingq[3][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							ithydose_F[ii][jj][2] += temppconr * inING_10y[kk][1] * ingq[3][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							
							ieffdose_F[ii][jj][3] += temppconr * inING_5y[kk][0] * ingq[2][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							ithydose_F[ii][jj][3] += temppconr * inING_5y[kk][1] * ingq[2][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
			
							ieffdose_F[ii][jj][4] += temppconr * inING_1y[kk][0] * ingq[1][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							ithydose_F[ii][jj][4] += temppconr * inING_1y[kk][1] * ingq[1][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							
							ieffdose_F[ii][jj][5] += temppconr * inING_3m[kk][0] * ingq[0][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							ithydose_F[ii][jj][5] += temppconr * inING_3m[kk][1] * ingq[0][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));

if (ddconstant[kk] != 0)

{
							ieffdose_F[ii][jj][0] += tempdconr * inINGd_A[kk][0] * ingq[5][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							ithydose_F[ii][jj][0] += tempdconr * inINGd_A[kk][1] * ingq[5][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
			
							ieffdose_F[ii][jj][1] += tempdconr * inINGd_15y[kk][0] * ingq[4][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							ithydose_F[ii][jj][1] += tempdconr * inINGd_15y[kk][1] * ingq[4][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							
							ieffdose_F[ii][jj][2] += tempdconr * inINGd_10y[kk][0] * ingq[3][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							ithydose_F[ii][jj][2] += tempdconr * inINGd_10y[kk][1] * ingq[3][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							
							ieffdose_F[ii][jj][3] += tempdconr * inINGd_5y[kk][0] * ingq[2][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							ithydose_F[ii][jj][3] += tempdconr * inINGd_5y[kk][1] * ingq[2][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
			
							ieffdose_F[ii][jj][4] += tempdconr * inINGd_1y[kk][0] * ingq[1][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							ithydose_F[ii][jj][4] += tempdconr * inINGd_1y[kk][1] * ingq[1][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							
							ieffdose_F[ii][jj][5] += tempdconr * inINGd_3m[kk][0] * ingq[0][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							ithydose_F[ii][jj][5] += tempdconr * inINGd_3m[kk][1] * ingq[0][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));


}

	
										}
									}
									if (f == 2)
									{
										for (int a = 0; a < 2; a++)
										{
										effdose_F[ii][jj][0] += temppcon * inING_A[kk][0] * ingq[5][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_A[kk][0] * ingq[5][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);
										thydose_F[ii][jj][0] += temppcon * inING_A[kk][1] * ingq[5][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_A[kk][1] * ingq[5][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);
						
										effdose_F[ii][jj][1] += temppcon * inING_15y[kk][0] * ingq[4][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_15y[kk][0] * ingq[4][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);
										thydose_F[ii][jj][1] += temppcon * inING_15y[kk][1] * ingq[4][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_15y[kk][1] * ingq[4][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);		
									
										effdose_F[ii][jj][2] += temppcon * inING_10y[kk][0] * ingq[3][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_10y[kk][0] * ingq[3][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);
										thydose_F[ii][jj][2] += temppcon * inING_10y[kk][1] * ingq[3][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_10y[kk][1] * ingq[3][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);		

										effdose_F[ii][jj][3] += temppcon * inING_5y[kk][0] * ingq[2][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_5y[kk][0] * ingq[2][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);
										thydose_F[ii][jj][3] += temppcon * inING_5y[kk][1] * ingq[2][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_5y[kk][1] * ingq[2][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);		
										
										effdose_F[ii][jj][4] += temppcon * inING_1y[kk][0] * ingq[1][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_1y[kk][0] * ingq[1][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);
										thydose_F[ii][jj][4] += temppcon * inING_1y[kk][1] * ingq[1][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_1y[kk][1] * ingq[1][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);	
										
										effdose_F[ii][jj][5] += temppcon * inING_3m[kk][0] * ingq[0][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_3m[kk][0] * ingq[0][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);
										thydose_F[ii][jj][5] += temppcon * inING_3m[kk][1] * ingq[0][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_3m[kk][1] * ingq[0][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);	

							ieffdose_F[ii][jj][0] += temppconr * inING_A[kk][0] * ingq[5][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							ithydose_F[ii][jj][0] += temppconr * inING_A[kk][1] * ingq[5][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
			
							ieffdose_F[ii][jj][1] += temppconr * inING_15y[kk][0] * ingq[4][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							ithydose_F[ii][jj][1] += temppconr * inING_15y[kk][1] * ingq[4][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							
							ieffdose_F[ii][jj][2] += temppconr * inING_10y[kk][0] * ingq[3][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							ithydose_F[ii][jj][2] += temppconr * inING_10y[kk][1] * ingq[3][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							
							ieffdose_F[ii][jj][3] += temppconr * inING_5y[kk][0] * ingq[2][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							ithydose_F[ii][jj][3] += temppconr * inING_5y[kk][1] * ingq[2][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
			
							ieffdose_F[ii][jj][4] += temppconr * inING_1y[kk][0] * ingq[1][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							ithydose_F[ii][jj][4] += temppconr * inING_1y[kk][1] * ingq[1][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							
							ieffdose_F[ii][jj][5] += temppconr * inING_3m[kk][0] * ingq[0][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							ithydose_F[ii][jj][5] += temppconr * inING_3m[kk][1] * ingq[0][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));

if (ddconstant[kk] != 0)

{
							ieffdose_F[ii][jj][0] += tempdconr * inINGd_A[kk][0] * ingq[5][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							ithydose_F[ii][jj][0] += tempdconr * inINGd_A[kk][1] * ingq[5][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
			
							ieffdose_F[ii][jj][1] += tempdconr * inINGd_15y[kk][0] * ingq[4][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							ithydose_F[ii][jj][1] += tempdconr * inINGd_15y[kk][1] * ingq[4][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							
							ieffdose_F[ii][jj][2] += tempdconr * inINGd_10y[kk][0] * ingq[3][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							ithydose_F[ii][jj][2] += tempdconr * inINGd_10y[kk][1] * ingq[3][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							
							ieffdose_F[ii][jj][3] += tempdconr * inINGd_5y[kk][0] * ingq[2][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							ithydose_F[ii][jj][3] += tempdconr * inINGd_5y[kk][1] * ingq[2][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
			
							ieffdose_F[ii][jj][4] += tempdconr * inINGd_1y[kk][0] * ingq[1][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							ithydose_F[ii][jj][4] += tempdconr * inINGd_1y[kk][1] * ingq[1][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							
							ieffdose_F[ii][jj][5] += tempdconr * inINGd_3m[kk][0] * ingq[0][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							ithydose_F[ii][jj][5] += tempdconr * inINGd_3m[kk][1] * ingq[0][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));


}

	
										}	
									}									
								}
							}
						}
						
						else
						{

							temppcon = (dryf[kk][ii][jj]+wetf[kk][ii][jj]) * exp(-(htoctime[f] +365+fday[f] - incday) * dconstant[kk]*24)*tf_p[kk][f]/165;
							tempdcon = (dryf[kk][ii][jj]+wetf[kk][ii][jj]) * (dconstant[kk]/(ddconstant[kk]-dconstant[kk]))*(exp(-(htoctime[f]+365+fday[f]-incday)*dconstant[kk]*24)-exp(-(htoctime[f]+365+fday[f]-incday)*ddconstant[kk]*24))*tfd_p[kk][f]/165;
			
temppcona = (dryf[kk][ii][jj]+wetf[kk][ii][jj]) * exp(-(htoctime[f] + 365+fday[f] - incday) * dconstant[kk]*24)*partup[kk]/prod[f];
temppconr = (dryf[kk][ii][jj]+wetf[kk][ii][jj]) * exp(-(htoctime[f] + 365+fday[f] - incday) * dconstant[kk]*24)*tf_p[kk][f]/165;

				
							effdose_F[ii][jj][0] += temppcon * inING_A[kk][0] * ingq[5][f] + tempdcon * inINGd_A[kk][0] * ingq[5][f];
							thydose_F[ii][jj][0] += temppcon * inING_A[kk][1] * ingq[5][f] + tempdcon * inINGd_A[kk][1] * ingq[5][f];
							
							effdose_F[ii][jj][1] += temppcon * inING_15y[kk][0] * ingq[4][f] + tempdcon * inINGd_15y[kk][0] * ingq[4][f];
							thydose_F[ii][jj][1] += temppcon * inING_15y[kk][1] * ingq[4][f] + tempdcon * inINGd_15y[kk][1] * ingq[4][f];
			
							effdose_F[ii][jj][2] += temppcon * inING_10y[kk][0] * ingq[3][f] + tempdcon * inINGd_10y[kk][0] * ingq[3][f];
							thydose_F[ii][jj][2] += temppcon * inING_10y[kk][1] * ingq[3][f] + tempdcon * inINGd_10y[kk][1] * ingq[3][f];

							effdose_F[ii][jj][3] += temppcon * inING_5y[kk][0] * ingq[2][f] + tempdcon * inINGd_5y[kk][0] * ingq[2][f];
							thydose_F[ii][jj][3] += temppcon * inING_5y[kk][1] * ingq[2][f] + tempdcon * inINGd_5y[kk][1] * ingq[2][f];						

							effdose_F[ii][jj][4] += temppcon * inING_1y[kk][0] * ingq[1][f] + tempdcon * inINGd_1y[kk][0] * ingq[1][f];
							thydose_F[ii][jj][4] += temppcon * inING_1y[kk][1] * ingq[1][f] + tempdcon * inINGd_1y[kk][1] * ingq[1][f];							

							effdose_F[ii][jj][5] += temppcon * inING_3m[kk][0] * ingq[0][f] + tempdcon * inINGd_3m[kk][0] * ingq[0][f];
							thydose_F[ii][jj][5] += temppcon * inING_3m[kk][1] * ingq[0][f] + tempdcon * inINGd_3m[kk][1] * ingq[0][f];																		
					
						ieffdose_F[ii][jj][0] += temppcon * inING_A[kk][0] * ingq[5][f] * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
						ithydose_F[ii][jj][0] += temppcon * inING_A[kk][1] * ingq[5][f] * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
						
						ieffdose_F[ii][jj][1] += temppcon * inING_15y[kk][0] * ingq[4][f] * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
						ithydose_F[ii][jj][1] += temppcon * inING_15y[kk][1] * ingq[4][f] * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
						
						ieffdose_F[ii][jj][2] += temppcon * inING_10y[kk][0] * ingq[3][f] * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
						ithydose_F[ii][jj][2] += temppcon * inING_10y[kk][1] * ingq[3][f] * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
						
						ieffdose_F[ii][jj][3] += temppcon * inING_5y[kk][0] * ingq[2][f] * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
						ithydose_F[ii][jj][3] += temppcon * inING_5y[kk][1] * ingq[2][f] * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
						
						ieffdose_F[ii][jj][4] += temppcon * inING_1y[kk][0] * ingq[1][f] * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
						ithydose_F[ii][jj][4] += temppcon * inING_1y[kk][1] * ingq[1][f] * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
						
						ieffdose_F[ii][jj][5] += temppcon * inING_3m[kk][0] * ingq[0][f] * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
						ithydose_F[ii][jj][5] += temppcon * inING_3m[kk][1] * ingq[0][f] * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
			

if (ddconstant[kk] != 0)

{
						ieffdose_F[ii][jj][0] += tempdcon * inINGd_A[kk][0] * ingq[5][f] * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
						ithydose_F[ii][jj][0] += tempdcon * inINGd_A[kk][1] * ingq[5][f] * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
						
						ieffdose_F[ii][jj][1] += tempdcon * inINGd_15y[kk][0] * ingq[4][f] * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
						ithydose_F[ii][jj][1] += tempdcon * inINGd_15y[kk][1] * ingq[4][f] * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
						
						ieffdose_F[ii][jj][2] += tempdcon * inINGd_10y[kk][0] * ingq[3][f] * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
						ithydose_F[ii][jj][2] += tempdcon * inINGd_10y[kk][1] * ingq[3][f] * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
						
						ieffdose_F[ii][jj][3] += tempdcon * inINGd_5y[kk][0] * ingq[2][f] * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
						ithydose_F[ii][jj][3] += tempdcon * inINGd_5y[kk][1] * ingq[2][f] * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
						
						ieffdose_F[ii][jj][4] += tempdcon * inINGd_1y[kk][0] * ingq[1][f] * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
						ithydose_F[ii][jj][4] += tempdcon * inINGd_1y[kk][1] * ingq[1][f] * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
						
						ieffdose_F[ii][jj][5] += tempdcon * inINGd_3m[kk][0] * ingq[0][f] * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
						ithydose_F[ii][jj][5] += tempdcon * inINGd_3m[kk][1] * ingq[0][f] * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
}
			

							if (f == 0)
							{
								for (int a = 2; a < 4; a++)
								{
								effdose_F[ii][jj][0] += temppcon * inING_A[kk][0] * ingq[5][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_A[kk][0] * ingq[5][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);
								thydose_F[ii][jj][0] += temppcon * inING_A[kk][1] * ingq[5][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_A[kk][1] * ingq[5][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);
				
								effdose_F[ii][jj][1] += temppcon * inING_15y[kk][0] * ingq[4][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_15y[kk][0] * ingq[4][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);
								thydose_F[ii][jj][1] += temppcon * inING_15y[kk][1] * ingq[4][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_15y[kk][1] * ingq[4][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);		
							
								effdose_F[ii][jj][2] += temppcon * inING_10y[kk][0] * ingq[3][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_10y[kk][0] * ingq[3][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);
								thydose_F[ii][jj][2] += temppcon * inING_10y[kk][1] * ingq[3][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_10y[kk][1] * ingq[3][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);		

								effdose_F[ii][jj][3] += temppcon * inING_5y[kk][0] * ingq[2][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_5y[kk][0] * ingq[2][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);
								thydose_F[ii][jj][3] += temppcon * inING_5y[kk][1] * ingq[2][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_5y[kk][1] * ingq[2][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);		
								
								effdose_F[ii][jj][4] += temppcon * inING_1y[kk][0] * ingq[1][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_1y[kk][0] * ingq[1][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);
								thydose_F[ii][jj][4] += temppcon * inING_1y[kk][1] * ingq[1][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_1y[kk][1] * ingq[1][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);	
								
								effdose_F[ii][jj][5] += temppcon * inING_3m[kk][0] * ingq[0][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_3m[kk][0] * ingq[0][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);
								thydose_F[ii][jj][5] += temppcon * inING_3m[kk][1] * ingq[0][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_3m[kk][1] * ingq[0][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);	

							ieffdose_F[ii][jj][0] += temppcon * inING_A[kk][0] * ingq[5][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							ithydose_F[ii][jj][0] += temppcon * inING_A[kk][1] * ingq[5][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
			
							ieffdose_F[ii][jj][1] += temppcon * inING_15y[kk][0] * ingq[4][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							ithydose_F[ii][jj][1] += temppcon * inING_15y[kk][1] * ingq[4][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							
							ieffdose_F[ii][jj][2] += temppcon * inING_10y[kk][0] * ingq[3][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							ithydose_F[ii][jj][2] += temppcon * inING_10y[kk][1] * ingq[3][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							
							ieffdose_F[ii][jj][3] += temppcon * inING_5y[kk][0] * ingq[2][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							ithydose_F[ii][jj][3] += temppcon * inING_5y[kk][1] * ingq[2][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
			
							ieffdose_F[ii][jj][4] += temppcon * inING_1y[kk][0] * ingq[1][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							ithydose_F[ii][jj][4] += temppcon * inING_1y[kk][1] * ingq[1][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							
							ieffdose_F[ii][jj][5] += temppcon * inING_3m[kk][0] * ingq[0][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							ithydose_F[ii][jj][5] += temppcon * inING_3m[kk][1] * ingq[0][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));

if (ddconstant[kk] != 0)

{
							ieffdose_F[ii][jj][0] += tempdcon * inINGd_A[kk][0] * ingq[5][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							ithydose_F[ii][jj][0] += tempdcon * inINGd_A[kk][1] * ingq[5][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
			
							ieffdose_F[ii][jj][1] += tempdcon * inINGd_15y[kk][0] * ingq[4][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							ithydose_F[ii][jj][1] += tempdcon * inINGd_15y[kk][1] * ingq[4][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							
							ieffdose_F[ii][jj][2] += tempdcon * inINGd_10y[kk][0] * ingq[3][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							ithydose_F[ii][jj][2] += tempdcon * inINGd_10y[kk][1] * ingq[3][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							
							ieffdose_F[ii][jj][3] += tempdcon * inINGd_5y[kk][0] * ingq[2][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							ithydose_F[ii][jj][3] += tempdcon * inINGd_5y[kk][1] * ingq[2][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
			
							ieffdose_F[ii][jj][4] += tempdcon * inINGd_1y[kk][0] * ingq[1][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							ithydose_F[ii][jj][4] += tempdcon * inINGd_1y[kk][1] * ingq[1][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							
							ieffdose_F[ii][jj][5] += tempdcon * inINGd_3m[kk][0] * ingq[0][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							ithydose_F[ii][jj][5] += tempdcon * inINGd_3m[kk][1] * ingq[0][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));


}


								}
							}
							if (f == 2)
							{
								for (int a = 0; a < 2; a++)
								{
								effdose_F[ii][jj][0] += temppcon * inING_A[kk][0] * ingq[5][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_A[kk][0] * ingq[5][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);
								thydose_F[ii][jj][0] += temppcon * inING_A[kk][1] * ingq[5][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_A[kk][1] * ingq[5][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);
				
								effdose_F[ii][jj][1] += temppcon * inING_15y[kk][0] * ingq[4][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_15y[kk][0] * ingq[4][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);
								thydose_F[ii][jj][1] += temppcon * inING_15y[kk][1] * ingq[4][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_15y[kk][1] * ingq[4][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);		
							
								effdose_F[ii][jj][2] += temppcon * inING_10y[kk][0] * ingq[3][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_10y[kk][0] * ingq[3][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);
								thydose_F[ii][jj][2] += temppcon * inING_10y[kk][1] * ingq[3][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_10y[kk][1] * ingq[3][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);		

								effdose_F[ii][jj][3] += temppcon * inING_5y[kk][0] * ingq[2][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_5y[kk][0] * ingq[2][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);
								thydose_F[ii][jj][3] += temppcon * inING_5y[kk][1] * ingq[2][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_5y[kk][1] * ingq[2][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);		
								
								effdose_F[ii][jj][4] += temppcon * inING_1y[kk][0] * ingq[1][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_1y[kk][0] * ingq[1][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);
								thydose_F[ii][jj][4] += temppcon * inING_1y[kk][1] * ingq[1][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_1y[kk][1] * ingq[1][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);	
								
								effdose_F[ii][jj][5] += temppcon * inING_3m[kk][0] * ingq[0][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_3m[kk][0] * ingq[0][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);
								thydose_F[ii][jj][5] += temppcon * inING_3m[kk][1] * ingq[0][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) + tempdcon * inINGd_3m[kk][1] * ingq[0][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24);	

							ieffdose_F[ii][jj][0] += temppcon * inING_A[kk][0] * ingq[5][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							ithydose_F[ii][jj][0] += temppcon * inING_A[kk][1] * ingq[5][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
			
							ieffdose_F[ii][jj][1] += temppcon * inING_15y[kk][0] * ingq[4][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							ithydose_F[ii][jj][1] += temppcon * inING_15y[kk][1] * ingq[4][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							
							ieffdose_F[ii][jj][2] += temppcon * inING_10y[kk][0] * ingq[3][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							ithydose_F[ii][jj][2] += temppcon * inING_10y[kk][1] * ingq[3][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							
							ieffdose_F[ii][jj][3] += temppcon * inING_5y[kk][0] * ingq[2][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							ithydose_F[ii][jj][3] += temppcon * inING_5y[kk][1] * ingq[2][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
			
							ieffdose_F[ii][jj][4] += temppcon * inING_1y[kk][0] * ingq[1][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							ithydose_F[ii][jj][4] += temppcon * inING_1y[kk][1] * ingq[1][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							
							ieffdose_F[ii][jj][5] += temppcon * inING_3m[kk][0] * ingq[0][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));
							ithydose_F[ii][jj][5] += temppcon * inING_3m[kk][1] * ingq[0][a+4] * frate[a] * tf_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*dconstant[kk]*24) * (exp(-365 * 24 * dconstant[kk])-exp(-365*24*70*dconstant[kk]))/(1-exp(-365 * 24 * dconstant[kk]));

if (ddconstant[kk] != 0)

{
							ieffdose_F[ii][jj][0] += tempdcon * inINGd_A[kk][0] * ingq[5][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							ithydose_F[ii][jj][0] += tempdcon * inINGd_A[kk][1] * ingq[5][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
			
							ieffdose_F[ii][jj][1] += tempdcon * inINGd_15y[kk][0] * ingq[4][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							ithydose_F[ii][jj][1] += tempdcon * inINGd_15y[kk][1] * ingq[4][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							
							ieffdose_F[ii][jj][2] += tempdcon * inINGd_10y[kk][0] * ingq[3][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							ithydose_F[ii][jj][2] += tempdcon * inINGd_10y[kk][1] * ingq[3][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							
							ieffdose_F[ii][jj][3] += tempdcon * inINGd_5y[kk][0] * ingq[2][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							ithydose_F[ii][jj][3] += tempdcon * inINGd_5y[kk][1] * ingq[2][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
			
							ieffdose_F[ii][jj][4] += tempdcon * inINGd_1y[kk][0] * ingq[1][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							ithydose_F[ii][jj][4] += tempdcon * inINGd_1y[kk][1] * ingq[1][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							
							ieffdose_F[ii][jj][5] += tempdcon * inINGd_3m[kk][0] * ingq[0][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));
							ithydose_F[ii][jj][5] += tempdcon * inINGd_3m[kk][1] * ingq[0][a+4] * frate[a] * tfd_a[kk][a] * exp(-(htoctime[a+4]+gperiod[8])*ddconstant[kk]*24) * (exp(-365 * 24 * ddconstant[kk])-exp(-365*24*70*ddconstant[kk]))/(1-exp(-365 * 24 * ddconstant[kk]));


}


								}	
							}						
						}
			
					}
				}



			}
		}
	}
	
	
	
	


		for (int ii = 0; ii < ny; ii++)
		{
			for (int jj = 0; jj < nx; jj++)
			{


					ieffdose_F[ii][jj][0] += effdose_F[ii][jj][0];
					ithydose_F[ii][jj][0] += thydose_F[ii][jj][0];
					ieffdose_F[ii][jj][1] += effdose_F[ii][jj][1];
					ithydose_F[ii][jj][1] += thydose_F[ii][jj][1];
					ieffdose_F[ii][jj][2] += effdose_F[ii][jj][2];
					ithydose_F[ii][jj][2] += thydose_F[ii][jj][2];
					ieffdose_F[ii][jj][3] += effdose_F[ii][jj][3];
					ithydose_F[ii][jj][3] += thydose_F[ii][jj][3];
					ieffdose_F[ii][jj][4] += effdose_F[ii][jj][4];
					ithydose_F[ii][jj][4] += thydose_F[ii][jj][4];
					ieffdose_F[ii][jj][5] += effdose_F[ii][jj][5];
					ithydose_F[ii][jj][5] += thydose_F[ii][jj][5];

			}
		}


	for (int ii = 0; ii < ny; ii++)
	{
		for (int jj = 0; jj < nx; jj++)
		{
			for (int l = 0; l < 6; l ++)
			{
				effdose_F[ii][jj][l] = effdose_F[ii][jj][l] * 1000;
				thydose_F[ii][jj][l] = thydose_F[ii][jj][l] * 1000;
				ieffdose_F[ii][jj][l] = ieffdose_F[ii][jj][l] * 1000;
				ithydose_F[ii][jj][l] = ithydose_F[ii][jj][l] * 1000;
			}
		}
	}

		printf("STEP3: Analysis done\n");
		stringstream ssf1, ssf2;
		if (model == 1)
		{
			ssf1 << coutdir << "ingestion.eff";
			ssf2 << coutdir << "ingestion.thy";
		}
		else
		{

			if (flexmodel == 1)
			{
				ssf1 << ctempdir1 << "ingestion.eff";
				ssf2 << ctempdir1 << "ingestion.thy";

			}
			else if (flexmodel == 2)
			{
				ssf1 << ctempdir2 << "ingestion.eff";
				ssf2 << ctempdir2 << "ingestion.thy";
			}
			else
			{
				ssf1 << ctempdir3 << "ingestion.eff";
				ssf2 << ctempdir3 << "ingestion.thy";
			}
		}
		string efffpath = ssf1.str();
		string thyfpath = ssf2.str();
		ofstream gouteff(efffpath, ios_base::out | ios_base::binary);
		ofstream goutthy(thyfpath, ios_base::out | ios_base::binary);

		for (int ii = 0; ii < ny; ii++)
		{
			for (int j = 0; j < nx; j++)
			{
				if (ii == 0 && j == 0)
				{
					gouteff.write((char *)&ii, sizeof(int));
					gouteff.write((char *)&j, sizeof(int));
					goutthy.write((char *)&ii, sizeof(int));
					goutthy.write((char *)&j, sizeof(int));

					for (int k = 0; k < 6; k++)
					{
						gouteff.write((char *)&effdose_F[ii][j][k], sizeof(float));
						goutthy.write((char *)&thydose_F[ii][j][k], sizeof(float));
						gouteff.write((char *)&ieffdose_F[ii][j][k], sizeof(float));
						goutthy.write((char *)&ithydose_F[ii][j][k], sizeof(float));
					}

				}
				else
				{
					if (effdose_F[ii][j][0] != 0 || thydose_F[ii][j][0] != 0)
					{
						gouteff.write((char *)&ii, sizeof(int));
						gouteff.write((char *)&j, sizeof(int));
						goutthy.write((char *)&ii, sizeof(int));
						goutthy.write((char *)&j, sizeof(int));

						for (int k = 0; k < 6; k++)
						{
							gouteff.write((char *)&effdose_F[ii][j][k], sizeof(float));
							goutthy.write((char *)&thydose_F[ii][j][k], sizeof(float));
							gouteff.write((char *)&ieffdose_F[ii][j][k], sizeof(float));
							goutthy.write((char *)&ithydose_F[ii][j][k], sizeof(float));

						}
					}
				}
			}
		}

		if (timestep < 168)
		{
			for (int ii = 0; ii < ny; ii++)
			{
				for (int j = 0; j < nx; j++)
				{
					iieffdose_C[ii][j] = ieffdose_C[ii][j];
					iithydose_C[ii][j] = ithydose_C[ii][j];
					iieffdose_G[ii][j] = ieffdose_G[ii][j];
					iithydose_G[ii][j] = ithydose_G[ii][j];
					for (int l = 0; l < nnuclide; l++)
					{
						if (ddconstant[l] !=0)
						{
							iieffdose_G[ii][j] += effdose_G_P[ii][j][l] * (exp(-dconstant[l])-exp(-(7 * 24 - (timestep - 1)) * dconstant[l]))/(1-exp(-dconstant[l])) + effdose_G_D[ii][j][l] * (exp(-ddconstant[l])-exp(-(7 * 24 - (timestep - 1)) * ddconstant[l]))/(1-exp(-ddconstant[l]));
							iithydose_G[ii][j] += thydose_G_P[ii][j][l] * (exp(-dconstant[l])-exp(-(7 * 24 - (timestep - 1)) * dconstant[l]))/(1-exp(-dconstant[l])) + thydose_G_D[ii][j][l] * (exp(-ddconstant[l])-exp(-(7 * 24 - (timestep - 1)) * ddconstant[l]))/(1-exp(-ddconstant[l]));
						}
						else
						{
							iieffdose_G[ii][j] += effdose_G_P[ii][j][l] * (exp(-dconstant[l])-exp(-(7 * 24 - (timestep - 1)) * dconstant[l]))/(1-exp(-dconstant[l]));
							iithydose_G[ii][j] += thydose_G_P[ii][j][l] * (exp(-dconstant[l])-exp(-(7 * 24 - (timestep - 1)) * dconstant[l]))/(1-exp(-dconstant[l]));
						}
					}
					iieffdose_E[ii][j] = iieffdose_G[ii][j]* IERNetsf[1] + iieffdose_C[ii][j]* IERNetsf[0];
					for (int k = 0; k < 6; k++)
					{
						iieffdose_I[ii][j][k] = ieffdose_I[ii][j][k];
						iithydose_I[ii][j][k] = ithydose_I[ii][j][k];
						iieffdose_T[ii][j][k] = iieffdose_C[ii][j] + iieffdose_G[ii][j] + iieffdose_I[ii][j][k];
						iithydose_T[ii][j][k] = iithydose_C[ii][j] + iithydose_G[ii][j] + iithydose_I[ii][j][k];
					}
					iieffdose_Tmax[ii][j] = get_max1(iieffdose_T[ii][j][0], iieffdose_T[ii][j][1], iieffdose_T[ii][j][2], iieffdose_T[ii][j][3], iieffdose_T[ii][j][4], iieffdose_T[ii][j][5]);
					iithydose_Tmax[ii][j] = get_max1(iithydose_T[ii][j][0], iithydose_T[ii][j][1], iithydose_T[ii][j][2], iithydose_T[ii][j][3], iithydose_T[ii][j][4], iithydose_T[ii][j][5]);
				}
			}

			stringstream ss7, ss8;
			if (model == 1)
			{
				ss7 << coutdir << "int_7day.eff";
				ss8 << coutdir << "int_7day.thy";
			}
			else
			{

				if (flexmodel == 1)
				{
					ss7 << ctempdir1 << "int_7day.eff";
					ss8 << ctempdir1 << "int_7day.thy";

				}
				else if (flexmodel == 2)
				{
					ss7 << ctempdir2 << "int_7day.eff";
					ss8 << ctempdir2 << "int_7day.thy";
				}
				else
				{
					ss7 << ctempdir3 << "int_7day.eff";
					ss8 << ctempdir3 << "int_7day.thy";
				}
			}
			string i7effpath = ss7.str();
			string i7thypath = ss8.str();
			ofstream i7outeff(i7effpath, ios_base::out | ios_base::binary);
			ofstream i7outthy(i7thypath, ios_base::out | ios_base::binary);

			for (int ii = 0; ii < ny; ii++)
			{
				for (int j = 0; j < nx; j++)
				{
					if (ii == 0 && j == 0)
					{
						i7outeff.write((char *)&ii, sizeof(int));
						i7outeff.write((char *)&j, sizeof(int));
						i7outthy.write((char *)&ii, sizeof(int));
						i7outthy.write((char *)&j, sizeof(int));
						i7outeff.write((char *)&iieffdose_C[ii][j], sizeof(float));
						i7outeff.write((char *)&iieffdose_G[ii][j], sizeof(float));
						i7outeff.write((char *)&iieffdose_E[ii][j], sizeof(float));
						i7outthy.write((char *)&iithydose_C[ii][j], sizeof(float));
						i7outthy.write((char *)&iithydose_G[ii][j], sizeof(float));


						for (int k = 0; k < 6; k++)
						{
							i7outeff.write((char *)&iieffdose_I[ii][j][k], sizeof(float));
							i7outeff.write((char *)&iieffdose_T[ii][j][k], sizeof(float));
							i7outthy.write((char *)&iithydose_I[ii][j][k], sizeof(float));
							i7outthy.write((char *)&iithydose_T[ii][j][k], sizeof(float));

						}
						i7outeff.write((char *)&iieffdose_Tmax[ii][j], sizeof(float));
						i7outthy.write((char *)&iithydose_Tmax[ii][j], sizeof(float));

					}
					else
					{
						if (effdose_T[ii][j][0] != 0 || thydose_T[ii][j][0] != 0)
						{
							i7outeff.write((char *)&ii, sizeof(int));
							i7outeff.write((char *)&j, sizeof(int));
							i7outthy.write((char *)&ii, sizeof(int));
							i7outthy.write((char *)&j, sizeof(int));
							i7outeff.write((char *)&iieffdose_C[ii][j], sizeof(float));
							i7outeff.write((char *)&iieffdose_G[ii][j], sizeof(float));
							i7outeff.write((char *)&iieffdose_E[ii][j], sizeof(float));
							i7outthy.write((char *)&iithydose_C[ii][j], sizeof(float));
							i7outthy.write((char *)&iithydose_G[ii][j], sizeof(float));

							for (int k = 0; k < 6; k++)
							{
								i7outeff.write((char *)&iieffdose_I[ii][j][k], sizeof(float));
								i7outeff.write((char *)&iieffdose_T[ii][j][k], sizeof(float));
								i7outthy.write((char *)&iithydose_I[ii][j][k], sizeof(float));
								i7outthy.write((char *)&iithydose_T[ii][j][k], sizeof(float));

							}
							i7outeff.write((char *)&iieffdose_Tmax[ii][j], sizeof(float));
							i7outthy.write((char *)&iithydose_Tmax[ii][j], sizeof(float));

						}
					}
				}
			}
		}

		if (timestep < (utime * 24))
		{
			for (int ii = 0; ii < ny; ii++)
			{
				for (int j = 0; j < nx; j++)
				{
					iieffdose_G[ii][j] = ieffdose_G[ii][j];
					iithydose_G[ii][j] = ithydose_G[ii][j];

					for (int l = 0; l < nnuclide; l++)
					{
						if (ddconstant[l] !=0)
						{
							iieffdose_G[ii][j] += effdose_G_P[ii][j][l] * (exp(-dconstant[l])-exp(-(utime * 24 -(timestep - 1)) * dconstant[l]))/(1-exp(-dconstant[l])) + effdose_G_D[ii][j][l] * (exp(-ddconstant[l])-exp(-(utime * 24 -(timestep - 1)) * ddconstant[l]))/(1-exp(-ddconstant[l]));
							iithydose_G[ii][j] += thydose_G_P[ii][j][l] * (exp(-dconstant[l])-exp(-(utime * 24 -(timestep - 1)) * dconstant[l]))/(1-exp(-dconstant[l])) + thydose_G_D[ii][j][l] * (exp(-ddconstant[l])-exp(-(utime * 24 -(timestep - 1)) * ddconstant[l]))/(1-exp(-ddconstant[l]));
						}
						else
						{
							iieffdose_G[ii][j] += effdose_G_P[ii][j][l] * (exp(-dconstant[l])-exp(-(utime * 24 -(timestep - 1)) * dconstant[l]))/(1-exp(-dconstant[l]));
							iithydose_G[ii][j] += thydose_G_P[ii][j][l] * (exp(-dconstant[l])-exp(-(utime * 24 -(timestep - 1)) * dconstant[l]))/(1-exp(-dconstant[l]));
						}
					}

					iieffdose_E[ii][j] = iieffdose_G[ii][j]* IERNetsf[1] + iieffdose_C[ii][j]* IERNetsf[0];
					for (int k = 0; k < 6; k++)
					{
						iieffdose_T[ii][j][k] = iieffdose_C[ii][j] + iieffdose_G[ii][j] + iieffdose_I[ii][j][k];
						iithydose_T[ii][j][k] = iithydose_C[ii][j] + iithydose_G[ii][j] + iithydose_I[ii][j][k];
					}
					iieffdose_Tmax[ii][j] = get_max1(iieffdose_T[ii][j][0], iieffdose_T[ii][j][1], iieffdose_T[ii][j][2], iieffdose_T[ii][j][3], iieffdose_T[ii][j][4], iieffdose_T[ii][j][5]);
					iithydose_Tmax[ii][j] = get_max1(iithydose_T[ii][j][0], iithydose_T[ii][j][1], iithydose_T[ii][j][2], iithydose_T[ii][j][3], iithydose_T[ii][j][4], iithydose_T[ii][j][5]);
				}
			}
			stringstream ss9, ss10;
			if (model == 1)
			{
				ss9 << coutdir << "int_usertime.eff";
				ss10 << coutdir << "int_usertime.thy";
			}
			else
			{

				if (flexmodel == 1)
				{
					ss9 << ctempdir1 << "int_usertime.eff";
					ss10 << ctempdir1 << "int_usertime.thy";

				}
				else if (flexmodel == 2)
				{
					ss9 << ctempdir2 << "int_usertime.eff";
					ss10 << ctempdir2 << "int_usertime.thy";
				}
				else
				{
					ss9 << ctempdir3 << "int_usertime.eff";
					ss10 << ctempdir3 << "int_usertime.thy";
				}
			}
			string iueffpath = ss9.str();
			string iuthypath = ss10.str();
			ofstream iuouteff(iueffpath, ios_base::out | ios_base::binary);
			ofstream iuoutthy(iuthypath, ios_base::out | ios_base::binary);

			for (int ii = 0; ii < ny; ii++)
			{
				for (int j = 0; j < nx; j++)
				{
					if (ii == 0 && j == 0)
					{
						iuouteff.write((char *)&ii, sizeof(int));
						iuouteff.write((char *)&j, sizeof(int));
						iuoutthy.write((char *)&ii, sizeof(int));
						iuoutthy.write((char *)&j, sizeof(int));
						iuouteff.write((char *)&iieffdose_C[ii][j], sizeof(float));
						iuouteff.write((char *)&iieffdose_G[ii][j], sizeof(float));
						iuouteff.write((char *)&iieffdose_E[ii][j], sizeof(float));
						iuoutthy.write((char *)&iithydose_C[ii][j], sizeof(float));
						iuoutthy.write((char *)&iithydose_G[ii][j], sizeof(float));


						for (int k = 0; k < 6; k++)
						{
							iuouteff.write((char *)&iieffdose_I[ii][j][k], sizeof(float));
							iuouteff.write((char *)&iieffdose_T[ii][j][k], sizeof(float));
							iuoutthy.write((char *)&iithydose_I[ii][j][k], sizeof(float));
							iuoutthy.write((char *)&iithydose_T[ii][j][k], sizeof(float));

						}
						iuouteff.write((char *)&iieffdose_Tmax[ii][j], sizeof(float));
						iuoutthy.write((char *)&iithydose_Tmax[ii][j], sizeof(float));

					}
					else
					{
						if (effdose_T[ii][j][0] != 0 || thydose_T[ii][j][0] != 0)
						{
							iuouteff.write((char *)&ii, sizeof(int));
							iuouteff.write((char *)&j, sizeof(int));
							iuoutthy.write((char *)&ii, sizeof(int));
							iuoutthy.write((char *)&j, sizeof(int));
							iuouteff.write((char *)&iieffdose_C[ii][j], sizeof(float));
							iuouteff.write((char *)&iieffdose_G[ii][j], sizeof(float));
							iuouteff.write((char *)&iieffdose_E[ii][j], sizeof(float));
							iuoutthy.write((char *)&iithydose_C[ii][j], sizeof(float));
							iuoutthy.write((char *)&iithydose_G[ii][j], sizeof(float));

							for (int k = 0; k < 6; k++)
							{
								iuouteff.write((char *)&iieffdose_I[ii][j][k], sizeof(float));
								iuouteff.write((char *)&iieffdose_T[ii][j][k], sizeof(float));
								iuoutthy.write((char *)&iithydose_I[ii][j][k], sizeof(float));
								iuoutthy.write((char *)&iithydose_T[ii][j][k], sizeof(float));

							}
							iuouteff.write((char *)&iieffdose_Tmax[ii][j], sizeof(float));
							iuoutthy.write((char *)&iithydose_Tmax[ii][j], sizeof(float));

						}
					}
				}
			}
		}
		

		if (timestep < 8760)
		{
			for (int ii = 0; ii < ny; ii++)
			{
				for (int j = 0; j < nx; j++)
				{
					iieffdose_G[ii][j] = ieffdose_G[ii][j] ;
					iithydose_G[ii][j] = ithydose_G[ii][j] ;

					for (int l = 0; l < nnuclide; l++)
					{
						if (ddconstant[l] !=0)
						{
							iieffdose_G[ii][j] = effdose_G_P[ii][j][l] * (exp(-dconstant[l]) - exp(-(365 * 24 - (timestep - 1)) * dconstant[l])) / (1 - exp(-dconstant[l])) + effdose_G_D[ii][j][l] * (exp(-ddconstant[l]) - exp(-(365 * 24 - (timestep - 1)) * ddconstant[l])) / (1 - exp(-ddconstant[l]));
							iithydose_G[ii][j] = thydose_G_P[ii][j][l] * (exp(-dconstant[l]) - exp(-(365 * 24 - (timestep - 1)) * dconstant[l])) / (1 - exp(-dconstant[l])) + thydose_G_D[ii][j][l] * (exp(-ddconstant[l]) - exp(-(365 * 24 - (timestep - 1)) * ddconstant[l])) / (1 - exp(-ddconstant[l]));
						}
						else
						{
							iieffdose_G[ii][j] += effdose_G_P[ii][j][l] * (exp(-dconstant[l]) - exp(-(365 * 24 - (timestep - 1)) * dconstant[l])) / (1 - exp(-dconstant[l]));
							iithydose_G[ii][j] += thydose_G_P[ii][j][l] * (exp(-dconstant[l]) - exp(-(365 * 24 - (timestep - 1)) * dconstant[l])) / (1 - exp(-dconstant[l]));
						}
					}

					iieffdose_E[ii][j] = iieffdose_G[ii][j]* IERNetsf[1] + iieffdose_C[ii][j]* IERNetsf[0];
					for (int k = 0; k < 6; k++)
					{
						iieffdose_T[ii][j][k] = iieffdose_C[ii][j] + iieffdose_G[ii][j] + iieffdose_I[ii][j][k];
						iithydose_T[ii][j][k] = iithydose_C[ii][j] + iithydose_G[ii][j] + iithydose_I[ii][j][k];
					}
					iieffdose_Tmax[ii][j] = get_max1(iieffdose_T[ii][j][0], iieffdose_T[ii][j][1], iieffdose_T[ii][j][2], iieffdose_T[ii][j][3], iieffdose_T[ii][j][4], iieffdose_T[ii][j][5]);
					iithydose_Tmax[ii][j] = get_max1(iithydose_T[ii][j][0], iithydose_T[ii][j][1], iithydose_T[ii][j][2], iithydose_T[ii][j][3], iithydose_T[ii][j][4], iithydose_T[ii][j][5]);
				}
			}
			stringstream ss11, ss12;
			if (model == 1)
			{
				ss11 << coutdir << "int_1year.eff";
				ss12 << coutdir << "int_1year.thy";
			}
			else
			{

				if (flexmodel == 1)
				{
					ss11 << ctempdir1 << "int_1year.eff";
					ss12 << ctempdir1 << "int_1year.thy";

				}
				else if (flexmodel == 2)
				{
					ss11 << ctempdir2 << "int_1year.eff";
					ss12 << ctempdir2 << "int_1year.thy";
				}
				else
				{
					ss11 << ctempdir3 << "int_1year.eff";
					ss12 << ctempdir3 << "int_1year.thy";
				}
			}
			string iyeffpath = ss11.str();
			string iythypath = ss12.str();
			ofstream iyouteff(iyeffpath, ios_base::out | ios_base::binary);
			ofstream iyoutthy(iythypath, ios_base::out | ios_base::binary);

			for (int ii = 0; ii < ny; ii++)
			{
				for (int j = 0; j < nx; j++)
				{
					if (ii == 0 && j == 0)
					{
						iyouteff.write((char *)&ii, sizeof(int));
						iyouteff.write((char *)&j, sizeof(int));
						iyoutthy.write((char *)&ii, sizeof(int));
						iyoutthy.write((char *)&j, sizeof(int));
						iyouteff.write((char *)&iieffdose_C[ii][j], sizeof(float));
						iyouteff.write((char *)&iieffdose_G[ii][j], sizeof(float));
						iyouteff.write((char *)&iieffdose_E[ii][j], sizeof(float));
						iyoutthy.write((char *)&iithydose_C[ii][j], sizeof(float));
						iyoutthy.write((char *)&iithydose_G[ii][j], sizeof(float));


						for (int k = 0; k < 6; k++)
						{
							iyouteff.write((char *)&iieffdose_I[ii][j][k], sizeof(float));
							iyouteff.write((char *)&iieffdose_T[ii][j][k], sizeof(float));
							iyoutthy.write((char *)&iithydose_I[ii][j][k], sizeof(float));
							iyoutthy.write((char *)&iithydose_T[ii][j][k], sizeof(float));

						}

						iyouteff.write((char *)&iieffdose_Tmax[ii][j], sizeof(float));
						iyoutthy.write((char *)&iithydose_Tmax[ii][j], sizeof(float));

					}
					else
					{
						if (effdose_T[ii][j][0] != 0 || thydose_T[ii][j][0] != 0)
						{
							iyouteff.write((char *)&ii, sizeof(int));
							iyouteff.write((char *)&j, sizeof(int));
							iyoutthy.write((char *)&ii, sizeof(int));
							iyoutthy.write((char *)&j, sizeof(int));
							iyouteff.write((char *)&iieffdose_C[ii][j], sizeof(float));
							iyouteff.write((char *)&iieffdose_G[ii][j], sizeof(float));
							iyouteff.write((char *)&iieffdose_E[ii][j], sizeof(float));
							iyoutthy.write((char *)&iithydose_C[ii][j], sizeof(float));
							iyoutthy.write((char *)&iithydose_G[ii][j], sizeof(float));

							for (int k = 0; k < 6; k++)
							{
								iyouteff.write((char *)&iieffdose_I[ii][j][k], sizeof(float));
								iyouteff.write((char *)&iieffdose_T[ii][j][k], sizeof(float));
								iyoutthy.write((char *)&iithydose_I[ii][j][k], sizeof(float));
								iyoutthy.write((char *)&iithydose_T[ii][j][k], sizeof(float));

							}

							iyouteff.write((char *)&iieffdose_Tmax[ii][j], sizeof(float));
							iyoutthy.write((char *)&iithydose_Tmax[ii][j], sizeof(float));

						}
					}
				}
			}
		}

		if (timestep < 48)
		{
			for (int ii = 0; ii < ny; ii++)
			{
				for (int j = 0; j < nx; j++)
				{
					iieffdose_C[ii][j] = ieffdose_C[ii][j];
					iithydose_C[ii][j] = ithydose_C[ii][j];
					iieffdose_G[ii][j] = ieffdose_G[ii][j];
					iithydose_G[ii][j] = ithydose_G[ii][j];
					for (int l = 0; l < nnuclide; l++)
					{
						if (ddconstant[l] !=0)
						{
							iieffdose_G[ii][j] += effdose_G_P[ii][j][l] * (exp(-dconstant[l])-exp(-(2 * 24 - (timestep - 1)) * dconstant[l]))/(1-exp(-dconstant[l])) + effdose_G_D[ii][j][l] * (exp(-ddconstant[l])-exp(-(2 * 24 - (timestep - 1)) * ddconstant[l]))/(1-exp(-ddconstant[l]));
							iithydose_G[ii][j] += thydose_G_P[ii][j][l] * (exp(-dconstant[l])-exp(-(2 * 24 - (timestep - 1)) * dconstant[l]))/(1-exp(-dconstant[l])) + thydose_G_D[ii][j][l] * (exp(-ddconstant[l])-exp(-(2 * 24 - (timestep - 1)) * ddconstant[l]))/(1-exp(-ddconstant[l]));
						}
						else
						{
							iieffdose_G[ii][j] += effdose_G_P[ii][j][l] * (exp(-dconstant[l])-exp(-(2 * 24 - (timestep - 1)) * dconstant[l]))/(1-exp(-dconstant[l]));
							iithydose_G[ii][j] += thydose_G_P[ii][j][l] * (exp(-dconstant[l])-exp(-(2 * 24 - (timestep - 1)) * dconstant[l]))/(1-exp(-dconstant[l]));
						}
					}
					iieffdose_E[ii][j] = iieffdose_G[ii][j]* IERNetsf[1] + iieffdose_C[ii][j]* IERNetsf[0];
					for (int k = 0; k < 6; k++)
					{
						iieffdose_I[ii][j][k] = ieffdose_I[ii][j][k];
						iithydose_I[ii][j][k] = ithydose_I[ii][j][k];
						iieffdose_T[ii][j][k] = iieffdose_C[ii][j] + iieffdose_G[ii][j] + iieffdose_I[ii][j][k];
						iithydose_T[ii][j][k] = iithydose_C[ii][j] + iithydose_G[ii][j] + iithydose_I[ii][j][k];
					}
					iieffdose_Tmax[ii][j] = get_max1(iieffdose_T[ii][j][0], iieffdose_T[ii][j][1], iieffdose_T[ii][j][2], iieffdose_T[ii][j][3], iieffdose_T[ii][j][4], iieffdose_T[ii][j][5]);
					iithydose_Tmax[ii][j] = get_max1(iithydose_T[ii][j][0], iithydose_T[ii][j][1], iithydose_T[ii][j][2], iithydose_T[ii][j][3], iithydose_T[ii][j][4], iithydose_T[ii][j][5]);
				}
			}

			stringstream ss13, ss14;
			if (model == 1)
			{
				ss13 << coutdir << "int_2day.eff";
				ss14 << coutdir << "int_2day.thy";
			}
			else
			{

				if (flexmodel == 1)
				{
					ss13 << ctempdir1 << "int_2day.eff";
					ss14 << ctempdir1 << "int_2day.thy";

				}
				else if (flexmodel == 2)
				{
					ss13 << ctempdir2 << "int_2day.eff";
					ss14 << ctempdir2 << "int_2day.thy";
				}
				else
				{
					ss13 << ctempdir3 << "int_2day.eff";
					ss14 << ctempdir3 << "int_2day.thy";
				}
			}
			string i2effpath = ss13.str();
			string i2thypath = ss14.str();
			ofstream i2outeff(i2effpath, ios_base::out | ios_base::binary);
			ofstream i2outthy(i2thypath, ios_base::out | ios_base::binary);

			for (int ii = 0; ii < ny; ii++)
			{
				for (int j = 0; j < nx; j++)
				{
					if (ii == 0 && j == 0)
					{
						i2outeff.write((char *)&ii, sizeof(int));
						i2outeff.write((char *)&j, sizeof(int));
						i2outthy.write((char *)&ii, sizeof(int));
						i2outthy.write((char *)&j, sizeof(int));
						i2outeff.write((char *)&iieffdose_C[ii][j], sizeof(float));
						i2outeff.write((char *)&iieffdose_G[ii][j], sizeof(float));
						i2outeff.write((char *)&iieffdose_E[ii][j], sizeof(float));
						i2outthy.write((char *)&iithydose_C[ii][j], sizeof(float));
						i2outthy.write((char *)&iithydose_G[ii][j], sizeof(float));


						for (int k = 0; k < 6; k++)
						{
							i2outeff.write((char *)&iieffdose_I[ii][j][k], sizeof(float));
							i2outeff.write((char *)&iieffdose_T[ii][j][k], sizeof(float));
							i2outthy.write((char *)&iithydose_I[ii][j][k], sizeof(float));
							i2outthy.write((char *)&iithydose_T[ii][j][k], sizeof(float));

						}
						i2outeff.write((char *)&iieffdose_Tmax[ii][j], sizeof(float));
						i2outthy.write((char *)&iithydose_Tmax[ii][j], sizeof(float));

					}
					else
					{
						if (effdose_T[ii][j][0] != 0 || thydose_T[ii][j][0] != 0)
						{
							i2outeff.write((char *)&ii, sizeof(int));
							i2outeff.write((char *)&j, sizeof(int));
							i2outthy.write((char *)&ii, sizeof(int));
							i2outthy.write((char *)&j, sizeof(int));
							i2outeff.write((char *)&iieffdose_C[ii][j], sizeof(float));
							i2outeff.write((char *)&iieffdose_G[ii][j], sizeof(float));
							i2outeff.write((char *)&iieffdose_E[ii][j], sizeof(float));
							i2outthy.write((char *)&iithydose_C[ii][j], sizeof(float));
							i2outthy.write((char *)&iithydose_G[ii][j], sizeof(float));

							for (int k = 0; k < 6; k++)
							{
								i2outeff.write((char *)&iieffdose_I[ii][j][k], sizeof(float));
								i2outeff.write((char *)&iieffdose_T[ii][j][k], sizeof(float));
								i2outthy.write((char *)&iithydose_I[ii][j][k], sizeof(float));
								i2outthy.write((char *)&iithydose_T[ii][j][k], sizeof(float));

							}
							i2outeff.write((char *)&iieffdose_Tmax[ii][j], sizeof(float));
							i2outthy.write((char *)&iithydose_Tmax[ii][j], sizeof(float));

						}
					}
				}
			}
		}

	// end time
	double wall1 = get_wall_time();
	double cpu1 = get_cpu_time();
	printlog << endl;
	printlog << "Output path : " << coutdir << endl;
	printlog << "Wall Time = " << wall1 - wall0 << " sec" << endl;
	printlog << "CPU Time  = " << cpu1 - cpu0 << " sec" << endl;

}

void check(int status)
{
	//NetCDF function check
	//
	if (status != NC_NOERR) {
		printf("ERROR: %s\n", nc_strerror(status));
 		ofstream errorm(empath);
		errorm << nc_strerror(status) << endl;
		exit(1);
	}
}

void readconfig()
{
	ifstream configfile;
	configfile.open("../../../COMM/adamov3.cfg");
	string ss;

	if (!configfile)
	{
		printf("ERROR: adamov3.cfg not found.\n");

		if (model == 1)
		{
			string fmpath;
			stringstream fm;
			fm << "../../../LOG/KR1/DOSE/AUTO/" << tempy << "/" << tempm << "/" << tempd << "/" << temph << "/fail.txt";
			fmpath = fm.str();
	 		ofstream failedm(fmpath);
			failedm << "ERROR: adamov3.cfg not found" << endl;
		}
		else
		{
			string fmpath;
			stringstream fm;
			fm << "../../../LOG/KR1/DOSE/ACCD/" << title << "/fail.txt";
			fmpath = fm.str();
	 		ofstream failedm(fmpath);
			failedm << "ERROR: adamov3.cfg not found" << endl;

		}

		exit(1);
	}


	string strconfig;
	string conarr[3];

	getline(configfile, strconfig);

	stringstream ssconfig(strconfig);
	while (ssconfig >> ss)
	{
		exeroot = ss;
	}


	getline(configfile, strconfig);
	stringstream ssconfig2(strconfig);

	while (ssconfig2 >> ss)
	{
		dataroot = ss;
	}
}


void readdcf()
{
	string line;

	ifstream brdat, exclouddat, exgrounddat, inhadat, inh15ydat, inh10ydat, inh5ydat, inh1ydat, inh3mdat, decayconstant;
	ifstream ingadat, ing15ydat, ing10ydat, ing5ydat, ing1ydat, ing3mdat, ingdat, sff, tfadat, tfpdat, rfdat;

	if (model == 1)
	{
			ingdat.open("db/model1/ingestion_data.dat");
			sff.open("db/model1/Shielding_Factors.dat");


	string str, arr[10];


	getline(ingdat, str);
	getline(ingdat, str);
	getline(ingdat, str);
	getline(sff, str);


		br[0] = 9.17E-01;
		br[1] = 8.33E-01;
		br[2] = 6.25E-01;
		br[3] = 3.63E-01;
		br[4] = 2.17E-01;
		br[5] = 1.21E-01;

		exCLD[0][0] = 9.28E-17;
		exCLD[0][1] = 7.55E-18;
		exGRD[0][0] = 2.99E-18;
		exGRD[0][1] = 2.51E-19;
		inINH_A[0][0] = 4.60E-09;
		inINH_A[0][1] = 4.40E-09;
		inINH_15y[0][0] = 4.40E-09;
		inINH_15y[0][1] = 4.20E-09;
		inINH_10y[0][0] = 3.70E-09;
		inINH_10y[0][1] = 3.50E-09;
		inINH_5y[0][0] = 3.60E-09;
		inINH_5y[0][1] = 3.20E-09;
		inINH_1y[0][0] = 5.40E-09;
		inINH_1y[0][1] = 4.40E-09;
		inINH_3m[0][0] = 8.80E-09;
		inINH_3m[0][1] = 7.50E-09;
		dexGRD[0][0] = 5.79E-16;
		dexGRD[0][1] = 5.87E-16;
		dconstant[0] = 2.64E-06;
		ddconstant[0] = 16.29656381;
		value[0] = 0.99999736;

		inING_A[0][0] = 0.000000013;
		inING_A[0][1] = 0.000000013;
		inING_15y[0][0] = 0.000000013;
		inING_15y[0][1] = 0.000000013;
		inING_10y[0][0] = 0.00000001;
		inING_10y[0][1] = 9.7E-09;
		inING_5y[0][0] = 0.000000009;
		inING_5y[0][1] = 9.6E-09;
		inING_1y[0][0] = 0.000000012;
		inING_1y[0][1] = 0.000000011;
		inING_3m[0][0] = 0.000000021;
		inING_3m[0][1] = 0.000000019;
				
		tf_a[0][0] = 8.30E-03;
		tf_a[0][1] = 3.00E-02;
		tf_a[0][2] = 2.60E-01;
		tf_a[0][3] = 4.50E+00;
		tfd_a[0][0] = 3.60E-04;
		tfd_a[0][1] = 5.00E-04;
		tfd_a[0][2] = 1.00E-02;
		tfd_a[0][3] = 5.00E-04;


		tf_p[0][0] = 2.60E-02;
		tf_p[0][1] = 8.40E-02;
		tf_p[0][2] = 2.00E-02;
		tf_p[0][3] = 2.00E-03;
		tfd_p[0][0] = 5.00E-03;
		tfd_p[0][1] = 5.00E-03;
		tfd_p[0][2] = 5.00E-03;
		tfd_p[0][3] = 5.00E-03;


		for (int i = 0; i < 4; i++)
		{
			getline(sff, str);
			stringstream ssinf(str);
			for (int j = 0; j < 4; j++)
			{
				ssinf >> arr[j];
			}

			for (int j = 0; j < 3; j++)
			{
				int k = j+1;
				shieldingf[i][j] = std::stof(arr[k]);
			}
		}

	getline(sff,str);
	getline(sff,str);
	stringstream ssinf2(str);
	for (int j =0; j <3; j++)
	{
		ssinf2 >> arr[j];

	}
	for (int j =0; j <2; j++)
	{
		int k = j+1;
		IERNetsf[j] = std::stof(arr[k]);
	}

		for (int i = 0; i < 6; i++)
		{

			getline(ingdat, str);
			stringstream ssina(str);

			for (int j = 0; j <10; j++)
			{
				ssina >> arr[j];
			}

			for (int j = 0; j <9; j++)
			{
				ingq[i][j] = std::stof(arr[j+1]);
			}
		}


		getline(ingdat, str);
		getline(ingdat, str);
		getline(ingdat, str);
		getline(ingdat, str);

		getline(ingdat, str);
		stringstream ssinb(str);
		for (int j =0; j < 9; j++)
		{
			ssinb >> arr[j];
		}
		for (int j =0; j < 9; j++)
		{
			htoctime[j] = std::stof(arr[j]);
		}
		getline(ingdat, str);
		getline(ingdat, str);
		getline(ingdat, str);
		getline(ingdat, str);

		getline(ingdat, str);
		stringstream ssinc(str);
		for (int j =0; j < 9; j++)
		{
			ssinc >> arr[j];
		}
		for (int j =0; j < 9; j++)
		{
			gperiod[j] = std::stof(arr[j]);
		}
		getline(ingdat, str);
		getline(ingdat, str);
		getline(ingdat, str);
		getline(ingdat, str);

		getline(ingdat, str);
		stringstream ssind(str);
		for (int j =0; j < 4; j++)
		{
			ssind >> arr[j];
		}
		for (int j =0; j < 4; j++)
		{
			frate[j] = std::stof(arr[j]);
		}
		getline(ingdat, str);
		getline(ingdat, str);
		getline(ingdat, str);
		getline(ingdat, str);

		getline(ingdat, str);
		stringstream ssine(str);
		for (int j =0; j < 9; j++)
		{
			ssine >> arr[j];
		}
		for (int j =0; j < 9; j++)
		{
			prod[j] = std::stof(arr[j]);
		}
		
		getline(ingdat, str);
		getline(ingdat, str);
		getline(ingdat, str);
		getline(ingdat, str);
		getline(ingdat, str);
		getline(ingdat, str);
		getline(ingdat, str);
		getline(ingdat, str);
		getline(ingdat, str);		
		getline(ingdat, str);
		stringstream ssing(str);
		for (int j =0; j < 4; j++)
		{
			ssing >> arr[j];
		}		
		for (int j = 0; j < 4; j++)
		{
			sday[j] = std::stoi(arr[j]);
		}
		getline(ingdat, str);
		stringstream ssinh(str);
		for (int j =0; j < 4; j++)
		{
			ssinh >> arr[j];
		}	
		for (int j = 0; j < 4; j++)
		{
			fday[j] = std::stoi(arr[j]);
		}
		
		partup[0] = 0.25;
		return;
	}
	else
	{
		if (flexmodel == 1)
		{
			brdat.open("db/model1/Breathing_Rate.dat");
			if (!brdat){
				printf("ERROR: DB files not found.\n");
				ofstream errorm(empath);
				errorm << "ERROR: DB files not found" << endl;
				exit(1);
			}
			exclouddat.open("db/model1/ExDCF_Cloud.dat");
			exgrounddat.open("db/model1/ExDCF_Ground.dat");
			inhadat.open("db/model1/InDCF_Inhalation_A.dat");
			inh15ydat.open("db/model1/InDCF_Inhalation_15y.dat");
			inh10ydat.open("db/model1/InDCF_Inhalation_10y.dat");
			inh5ydat.open("db/model1/InDCF_Inhalation_5y.dat");
			inh1ydat.open("db/model1/InDCF_Inhalation_1y.dat");
			inh3mdat.open("db/model1/InDCF_Inhalation_3m.dat");
			decayconstant.open("db/model1/Decay_constant.dat");
			ingadat.open("db/model1/InDCF_Ingestion_A.dat");
			ing15ydat.open("db/model1/InDCF_Ingestion_15y.dat");
			ing10ydat.open("db/model1/InDCF_Ingestion_10y.dat");
			ing5ydat.open("db/model1/InDCF_Ingestion_5y.dat");
			ing1ydat.open("db/model1/InDCF_Ingestion_1y.dat");
			ing3mdat.open("db/model1/InDCF_Ingestion_3m.dat");
			ingdat.open("db/model1/ingestion_data.dat");
			sff.open("db/model1/Shielding_Factors.dat");
			tfadat.open("db/model1/transfer_factor_animal.dat");
			tfpdat.open("db/model1/transfer_factor_plant.dat");
			rfdat.open("db/model1/retentionfactor.dat");
		}
		else if (flexmodel == 2)
		{
			brdat.open("db/model2/Breathing_Rate.dat");
			if (!brdat){
				printf("ERROR: DB files not found.\n");
				ofstream errorm(empath);
				errorm << "ERROR: DB files not found" << endl;
				exit(1);
			}
			exclouddat.open("db/model2/ExDCF_Cloud.dat");
			exgrounddat.open("db/model2/ExDCF_Ground.dat");
			inhadat.open("db/model2/InDCF_Inhalation_A.dat");
			inh15ydat.open("db/model2/InDCF_Inhalation_15y.dat");
			inh10ydat.open("db/model2/InDCF_Inhalation_10y.dat");
			inh5ydat.open("db/model2/InDCF_Inhalation_5y.dat");
			inh1ydat.open("db/model2/InDCF_Inhalation_1y.dat");
			inh3mdat.open("db/model2/InDCF_Inhalation_3m.dat");
			decayconstant.open("db/model2/Decay_constant.dat");
			ingadat.open("db/model2/InDCF_Ingestion_A.dat");
			ing15ydat.open("db/model2/InDCF_Ingestion_15y.dat");
			ing10ydat.open("db/model2/InDCF_Ingestion_10y.dat");
			ing5ydat.open("db/model2/InDCF_Ingestion_5y.dat");
			ing1ydat.open("db/model2/InDCF_Ingestion_1y.dat");
			ing3mdat.open("db/model2/InDCF_Ingestion_3m.dat");
			ingdat.open("db/model2/ingestion_data.dat");
			sff.open("db/model2/Shielding_Factors.dat");
			tfadat.open("db/model2/transfer_factor_animal.dat");
			tfpdat.open("db/model2/transfer_factor_plant.dat");
			rfdat.open("db/model2/retentionfactor.dat");
		}
		else
		{

			brdat.open("db/model3/Breathing_Rate.dat");
			if (!brdat){
				printf("ERROR: DB files not found.\n");
				ofstream errorm(empath);
				errorm << "ERROR: DB files not found" << endl;
				exit(1);
			}
			exclouddat.open("db/model3/ExDCF_Cloud.dat");
			exgrounddat.open("db/model3/ExDCF_Ground.dat");
			inhadat.open("db/model3/InDCF_Inhalation_A.dat");
			inh15ydat.open("db/model3/InDCF_Inhalation_15y.dat");
			inh10ydat.open("db/model3/InDCF_Inhalation_10y.dat");
			inh5ydat.open("db/model3/InDCF_Inhalation_5y.dat");
			inh1ydat.open("db/model3/InDCF_Inhalation_1y.dat");
			inh3mdat.open("db/model3/InDCF_Inhalation_3m.dat");
			decayconstant.open("db/model3/Decay_constant.dat");
			ingadat.open("db/model3/InDCF_Ingestion_A.dat");
			ing15ydat.open("db/model3/InDCF_Ingestion_15y.dat");
			ing10ydat.open("db/model3/InDCF_Ingestion_10y.dat");
			ing5ydat.open("db/model3/InDCF_Ingestion_5y.dat");
			ing1ydat.open("db/model3/InDCF_Ingestion_1y.dat");
			ing3mdat.open("db/model3/InDCF_Ingestion_3m.dat");
			ingdat.open("db/model3/ingestion_data.dat");
			sff.open("db/model3/Shielding_Factors.dat");
			tfadat.open("db/model3/transfer_factor_animal.dat");
			tfpdat.open("db/model3/transfer_factor_plant.dat");
			rfdat.open("db/model3/retentionfactor.dat");
		}
	}

	string str, arr[10];
	getline(brdat, str);
	getline(exclouddat, str);
	getline(exgrounddat, str);
	getline(inhadat, str);
	getline(inh15ydat, str);
	getline(inh10ydat, str);
	getline(inh5ydat, str);
	getline(inh1ydat, str);
	getline(inh3mdat, str);
	getline(decayconstant, str);
	getline(ingadat, str);
	getline(ing15ydat, str);
	getline(ing10ydat, str);
	getline(ing5ydat, str);
	getline(ing1ydat, str);
	getline(ing3mdat, str);
	getline(ingdat, str);
	getline(ingdat, str);
	getline(ingdat, str);
	getline(sff, str);
	getline(tfadat, str);
	getline(tfpdat, str);
	getline(tfadat, str);
	getline(tfpdat, str);
	getline(rfdat, str);
	
	for (int i = 0; i < 4; i++)
	{
		getline(sff, str);
		stringstream ssinf(str);
		for (int j = 0; j < 4; j++)
		{
			ssinf >> arr[j];
		}

		for (int j = 0; j < 3; j++)
		{
			int k = j+1;
			shieldingf[i][j] = std::stof(arr[k]);
		}
	}
	getline(sff,str);
	getline(sff,str);
	stringstream ssinf2(str);
	for (int j =0; j <3; j++)
	{
		ssinf2 >> arr[j];

	}
	for (int j =0; j <2; j++)
	{
		int k = j+1;
		IERNetsf[j] = std::stof(arr[k]);
	}


	for (int i = 0; i < 6; i++)
	{
		getline(brdat, str);
		stringstream ssin(str);
		for (int j = 0; j < 2; j++)
		{
			ssin >> arr[j];
		}
		br[i] = std::stof(arr[1]);

		getline(ingdat, str);
		stringstream ssina(str);

		for (int j = 0; j <10; j++)
		{
			ssina >> arr[j];
		}

		for (int j = 0; j <9; j++)
		{
			ingq[i][j] = std::stof(arr[j+1]);
		}
	}

	getline(ingdat, str);
	getline(ingdat, str);
	getline(ingdat, str);
	getline(ingdat, str);

	getline(ingdat, str);
	stringstream ssinb(str);
	for (int j =0; j < 9; j++)
	{
		ssinb >> arr[j];
	}
	for (int j =0; j < 9; j++)
	{
		htoctime[j] = std::stof(arr[j]);
	}
	getline(ingdat, str);
	getline(ingdat, str);
	getline(ingdat, str);
	getline(ingdat, str);

	getline(ingdat, str);
	stringstream ssinc(str);
	for (int j =0; j < 9; j++)
	{
		ssinc >> arr[j];
	}
	for (int j =0; j < 9; j++)
	{
		gperiod[j] = std::stof(arr[j]);
	}
	getline(ingdat, str);
	getline(ingdat, str);
	getline(ingdat, str);
	getline(ingdat, str);

	getline(ingdat, str);
	stringstream ssind(str);
	for (int j =0; j < 4; j++)
	{
		ssind >> arr[j];
	}
	for (int j =0; j < 4; j++)
	{
		frate[j] = std::stof(arr[j]);
	}
	getline(ingdat, str);
	getline(ingdat, str);
	getline(ingdat, str);
	getline(ingdat, str);

	getline(ingdat, str);
	stringstream ssine(str);
	for (int j =0; j < 9; j++)
	{
		ssine >> arr[j];
	}
	for (int j =0; j < 9; j++)
	{
		prod[j] = std::stof(arr[j]);
	}
	getline(ingdat, str);
	getline(ingdat, str);
	getline(ingdat, str);
	getline(ingdat, str);
	getline(ingdat, str);
	getline(ingdat, str);
	getline(ingdat, str);
	getline(ingdat, str);
	getline(ingdat, str);	
	getline(ingdat, str);
	stringstream ssing(str);
	for (int j =0; j < 4; j++)
	{
		ssing >> arr[j];
	}		
	for (int j = 0; j < 4; j++)
	{
		sday[j] = std::stoi(arr[j]);
	}
	getline(ingdat, str);
	stringstream ssinh(str);
	for (int j =0; j < 4; j++)
	{
		ssinh >> arr[j];
	}	
	for (int j = 0; j < 4; j++)
	{
		fday[j] = std::stoi(arr[j]);
	}
		
	for (int i = 0; i < nspec; i++)
	{
		getline(rfdat, str);
		stringstream ssinrf(str);
		for (int j = 0; j < 4; j++)
		{
			ssinrf >> arr[j];
		}
		partup[i] = std::stof(arr[3]);

		
	
		getline(exclouddat, str);
		stringstream ssin(str);
		for (int j = 0; j < 5; j++)
		{
			ssin >> arr[j];
		}
		exCLD[i][0] = std::stof(arr[3]);
		exCLD[i][1] = std::stof(arr[4]);

		getline(exgrounddat, str);
		stringstream ssin1(str);
		for (int j = 0; j < 7; j++)
		{
			ssin1 >> arr[j];
		}
		exGRD[i][0] = std::stof(arr[3]);
		exGRD[i][1] = std::stof(arr[4]);
		dexGRD[i][0] = std::stof(arr[5]);
		dexGRD[i][1] = std::stof(arr[6]);

		getline(inhadat, str);
		stringstream ssin2(str);
		for (int j = 0; j < 6; j++)
		{
			ssin2 >> arr[j];
		}
		inINH_A[i][0] = std::stof(arr[4]);
		inINH_A[i][1] = std::stof(arr[5]);

		getline(inh15ydat, str);
		stringstream ssin3(str);
		for (int j = 0; j < 6; j++)
		{
			ssin3 >> arr[j];
		}
		inINH_15y[i][0] = std::stof(arr[4]);
		inINH_15y[i][1] = std::stof(arr[5]);

		getline(inh10ydat, str);
		stringstream ssin4(str);
		for (int j = 0; j < 6; j++)
		{
			ssin4 >> arr[j];
		}
		inINH_10y[i][0] = std::stof(arr[4]);
		inINH_10y[i][1] = std::stof(arr[5]);

		getline(inh5ydat, str);
		stringstream ssin5(str);
		for (int j = 0; j < 6; j++)
		{
			ssin5 >> arr[j];
		}
		inINH_5y[i][0] = std::stof(arr[4]);
		inINH_5y[i][1] = std::stof(arr[5]);

		getline(inh1ydat, str);
		stringstream ssin6(str);
		for (int j = 0; j < 6; j++)
		{
			ssin6 >> arr[j];
		}
		inINH_1y[i][0] = std::stof(arr[4]);
		inINH_1y[i][1] = std::stof(arr[5]);

		getline(inh3mdat, str);
		stringstream ssin7(str);
		for (int j = 0; j < 6; j++)
		{
			ssin7 >> arr[j];
		}
		inINH_3m[i][0] = std::stof(arr[4]);
		inINH_3m[i][1] = std::stof(arr[5]);

		getline(decayconstant, str);
		stringstream ssin8(str);
		for (int j = 0; j < 5; j++)
		{
			ssin8 >> arr[j];
		}
		dconstant[i] = std::stof(arr[2]);
		ddconstant[i] = std::stof(arr[3]);
		value[i] = std::stof(arr[4]);

		getline(ingadat, str);
		stringstream ssin9(str);
		for (int j = 0; j < 9; j++)
		{
			ssin9 >> arr[j];
		}
		inING_A[i][0] = std::stof(arr[4]);
		inING_A[i][1] = std::stof(arr[5]);
		inINGd_A[i][0] = std::stof(arr[7]);
		inINGd_A[i][1] = std::stof(arr[8]);

		getline(ing15ydat, str);
		stringstream ssin10(str);
		for (int j = 0; j < 9; j++)
		{
			ssin10 >> arr[j];
		}
		inING_15y[i][0] = std::stof(arr[4]);
		inING_15y[i][1] = std::stof(arr[5]);
		inINGd_15y[i][0] = std::stof(arr[7]);
		inINGd_15y[i][1] = std::stof(arr[8]);

		getline(ing10ydat, str);
		stringstream ssin11(str);
		for (int j = 0; j < 9; j++)
		{
			ssin11 >> arr[j];
		}
		inING_10y[i][0] = std::stof(arr[4]);
		inING_10y[i][1] = std::stof(arr[5]);
		inINGd_10y[i][0] = std::stof(arr[7]);
		inINGd_10y[i][1] = std::stof(arr[8]);

		getline(ing5ydat, str);
		stringstream ssin12(str);
		for (int j = 0; j < 9; j++)
		{
			ssin12 >> arr[j];
		}
		inING_5y[i][0] = std::stof(arr[4]);
		inING_5y[i][1] = std::stof(arr[5]);
		inINGd_5y[i][0] = std::stof(arr[7]);
		inINGd_5y[i][1] = std::stof(arr[8]);

		getline(ing1ydat, str);
		stringstream ssin13(str);
		for (int j = 0; j < 9; j++)
		{
			ssin13 >> arr[j];
		}
		inING_1y[i][0] = std::stof(arr[4]);
		inING_1y[i][1] = std::stof(arr[5]);
		inINGd_1y[i][0] = std::stof(arr[7]);
		inINGd_1y[i][1] = std::stof(arr[8]);

		getline(ing3mdat, str);
		stringstream ssin14(str);
		for (int j = 0; j < 9; j++)
		{
			ssin14 >> arr[j];
		}
		inING_3m[i][0] = std::stof(arr[4]);
		inING_3m[i][1] = std::stof(arr[5]);
		inINGd_3m[i][0] = std::stof(arr[7]);
		inINGd_3m[i][1] = std::stof(arr[8]);

		getline(tfadat, str);
		stringstream ssin15(str);

		for (int j = 0; j < 10; j++)
		{
			ssin15 >> arr[j];
		}

		tf_a[i][0] = std::stof(arr[1]);
		tf_a[i][1] = std::stof(arr[2]);
		tf_a[i][2] = std::stof(arr[3]);
		tf_a[i][3] = std::stof(arr[4]);
		tfd_a[i][0] = std::stof(arr[6]);
		tfd_a[i][1] = std::stof(arr[7]);
		tfd_a[i][2] = std::stof(arr[8]);
		tfd_a[i][3] = std::stof(arr[9]);

		getline(tfpdat, str);
		stringstream ssin16(str);

		for (int j = 0; j < 10; j++)
		{
			ssin16 >> arr[j];
		}

		tf_p[i][0] = std::stof(arr[1]);
		tf_p[i][1] = std::stof(arr[2]);
		tf_p[i][2] = std::stof(arr[3]);
		tf_p[i][3] = std::stof(arr[4]);
		tfd_p[i][0] = std::stof(arr[6]);
		tfd_p[i][1] = std::stof(arr[7]);
		tfd_p[i][2] = std::stof(arr[8]);
		tfd_p[i][3] = std::stof(arr[9]);
	}
}

double get_wall_time(){
    struct timeval time;
    if (gettimeofday(&time,NULL)){
        //  Handle error
        return 0;
    }
    return (double)time.tv_sec + (double)time.tv_usec * .000001;
}
double get_cpu_time(){
    return (double)clock() / CLOCKS_PER_SEC;
}
float get_max(float a, float b, float c, float d, float e){
	float max = 0;
	float input[] = { a, b, c, d, e };
	for (int i = 0; i < 5; i++)
	{
		if (input[i] > max)
			max = input[i];
	}
	return max;
}

float get_max1(float a, float b, float c, float d, float e, float f)
{
	float max2 = 0;
	float input2[] = { a, b, c, d, e, f };
	for (int i = 0; i < 6; i++)
	{
		if (input2[i] > max2)
			max2 = input2[i];
	}
	return max2;
}

bool DirectoryExists( const char* pzPath )
{
    if ( pzPath == NULL) return false;

    DIR *pDir;
    bool bExists = false;

    pDir = opendir (pzPath);

    if (pDir != NULL)
    {
        bExists = true;
        (void) closedir (pDir);
    }

    return bExists;
}

int julday(int year, int month, int date)
{
	int kdaya[12], kdayb[12];
	kdaya = {0,31,59,90,120,151,181,212,243,273,304,334};
	kdayb = {0,31,60,91,121,152,182,213,244,274,305,335};
	
	int ijulday;
	
	if (month < 1 || month > 12)
	{
		printf("ERROR: Error in calculating Julian day. Please check the date.\n");
		ofstream errorm(empath);
		errorm << "ERROR: Error in calculating Julian day. Please check the date." << endl;
		exit(1);		
	}
	if (month == 4 || month == 6 || month == 9 || month == 11)
	{
		if (date > 30)
		{
			printf("ERROR: Error in calculating Julian day. Please check the date.\n");
			ofstream errorm(empath);
			errorm << "ERROR: Error in calculating Julian day. Please check the date." << endl;
			exit(1);			
		}
	}
	else if (month == 2)
	{
		if (year % 4 == 0)
		{
			if (date > 29)
			{
				printf("ERROR: Error in calculating Julian day. Please check the date.\n");
				ofstream errorm(empath);
				errorm << "ERROR: Error in calculating Julian day. Please check the date." << endl;
				exit(1);
			}
		}
		else
		{
			if (date > 28)
			{
				printf("ERROR: Error in calculating Julian day. Please check the date.\n");
				ofstream errorm(empath);
				errorm << "ERROR: Error in calculating Julian day. Please check the date." << endl;
				exit(1);
			}
		}
	}
	else
	{
		if (date > 31)
		{
			printf("ERROR: Error in calculating Julian day. Please check the date.\n");
			ofstream errorm(empath);
			errorm << "ERROR: Error in calculating Julian day. Please check the date." << endl;
			exit(1);
		}
	}

	if (year % 4 == 0)
	{
		ijulday = kdayb[month-1] + date;
	}		

	else
	{
		ijulday = kdaya[month-1] + date;
	}
	
	if (ijulday == 366)
	{
		ijulday = 365;
	}
	
	
	return ijulday;
	
}

